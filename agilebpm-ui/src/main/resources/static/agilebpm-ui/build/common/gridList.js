/*! AGILE-BPM 版权所有，翻版必究 */
!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=47)}({47:function(module,exports,__webpack_require__){eval("\n//require('../../css/plugins/bootstrap-table/bootstrap-table.min.css');\n__webpack_require__(48);\n__webpack_require__(49);\n\n\n__webpack_require__(50);\n//require('../../css/extends/list.css');\n__webpack_require__(51);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvZW50cnkvY29tbW9uL2dyaWRMaXN0LmpzPzc1OWMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBIiwiZmlsZSI6IjQ3LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG4vL3JlcXVpcmUoJy4uLy4uL2Nzcy9wbHVnaW5zL2Jvb3RzdHJhcC10YWJsZS9ib290c3RyYXAtdGFibGUubWluLmNzcycpO1xucmVxdWlyZSgnLi4vLi4vanMvcGx1Z2lucy9ib290c3RyYXAtdGFibGUvYm9vdHN0cmFwLXRhYmxlLmpzJyk7XG5yZXF1aXJlKCcuLi8uLi9qcy9wbHVnaW5zL2Jvb3RzdHJhcC10YWJsZS9sb2NhbGUvYm9vdHN0cmFwLXRhYmxlLXpoLUNOLm1pbi5qcycpO1xuXG5cbnJlcXVpcmUoJy4uLy4uL2pzL2NvbW1vbi9ncmlkLmpzJyk7XG4vL3JlcXVpcmUoJy4uLy4uL2Nzcy9leHRlbmRzL2xpc3QuY3NzJyk7XG5yZXF1aXJlKCcuLi8uLi9qcy9jb21tb24vdG9vbHMvc3lzVHJlZVV0aWwuanMnKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vYXNzZXRzL2VudHJ5L2NvbW1vbi9ncmlkTGlzdC5qc1xuLy8gbW9kdWxlIGlkID0gNDdcbi8vIG1vZHVsZSBjaHVua3MgPSA0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///47\n")},48:function(module,exports){eval("/**\n * @author zhixin wen <wenzhixin2010@gmail.com>\n * version: 1.11.0\n * https://github.com/wenzhixin/bootstrap-table/\n */\n\n(function ($) {\n    'use strict';\n\n    // TOOLS DEFINITION\n    // ======================\n\n    var cachedWidth = null;\n\n    // it only does '%s', and return '' when arguments are undefined\n    var sprintf = function (str) {\n        var args = arguments,\n            flag = true,\n            i = 1;\n\n        str = str.replace(/%s/g, function () {\n            var arg = args[i++];\n\n            if (typeof arg === 'undefined') {\n                flag = false;\n                return '';\n            }\n            return arg;\n        });\n        return flag ? str : '';\n    };\n\n    var getPropertyFromOther = function (list, from, to, value) {\n        var result = '';\n        $.each(list, function (i, item) {\n            if (item[from] === value) {\n                result = item[to];\n                return false;\n            }\n            return true;\n        });\n        return result;\n    };\n\n    var getFieldIndex = function (columns, field) {\n        var index = -1;\n\n        $.each(columns, function (i, column) {\n            if (column.field === field) {\n                index = i;\n                return false;\n            }\n            return true;\n        });\n        return index;\n    };\n\n    // http://jsfiddle.net/wenyi/47nz7ez9/3/\n    var setFieldIndex = function (columns) {\n        var i, j, k,\n            totalCol = 0,\n            flag = [];\n\n        for (i = 0; i < columns[0].length; i++) {\n            totalCol += columns[0][i].colspan || 1;\n        }\n\n        for (i = 0; i < columns.length; i++) {\n            flag[i] = [];\n            for (j = 0; j < totalCol; j++) {\n                flag[i][j] = false;\n            }\n        }\n\n        for (i = 0; i < columns.length; i++) {\n            for (j = 0; j < columns[i].length; j++) {\n                var r = columns[i][j],\n                    rowspan = r.rowspan || 1,\n                    colspan = r.colspan || 1,\n                    index = $.inArray(false, flag[i]);\n\n                if (colspan === 1) {\n                    r.fieldIndex = index;\n                    // when field is undefined, use index instead\n                    if (typeof r.field === 'undefined') {\n                        r.field = index;\n                    }\n                }\n\n                for (k = 0; k < rowspan; k++) {\n                    flag[i + k][index] = true;\n                }\n                for (k = 0; k < colspan; k++) {\n                    flag[i][index + k] = true;\n                }\n            }\n        }\n    };\n\n    var getScrollBarWidth = function () {\n        if (cachedWidth === null) {\n            var inner = $('<p/>').addClass('fixed-table-scroll-inner'),\n                outer = $('<div/>').addClass('fixed-table-scroll-outer'),\n                w1, w2;\n\n            outer.append(inner);\n            $('body').append(outer);\n\n            w1 = inner[0].offsetWidth;\n            outer.css('overflow', 'scroll');\n            w2 = inner[0].offsetWidth;\n\n            if (w1 === w2) {\n                w2 = outer[0].clientWidth;\n            }\n\n            outer.remove();\n            cachedWidth = w1 - w2;\n        }\n        return cachedWidth;\n    };\n\n    var calculateObjectValue = function (self, name, args, defaultValue) {\n        var func = name;\n\n        if (typeof name === 'string') {\n            // support obj.func1.func2\n            var names = name.split('.');\n\n            if (names.length > 1) {\n                func = window;\n                $.each(names, function (i, f) {\n                    func = func[f];\n                });\n            } else {\n                func = window[name];\n            }\n        }\n        if (typeof func === 'object') {\n            return func;\n        }\n        if (typeof func === 'function') {\n            return func.apply(self, args);\n        }\n        if (!func && typeof name === 'string' && sprintf.apply(this, [name].concat(args))) {\n            return sprintf.apply(this, [name].concat(args));\n        }\n        return defaultValue;\n    };\n\n    var compareObjects = function (objectA, objectB, compareLength) {\n        // Create arrays of property names\n        var objectAProperties = Object.getOwnPropertyNames(objectA),\n            objectBProperties = Object.getOwnPropertyNames(objectB),\n            propName = '';\n\n        if (compareLength) {\n            // If number of properties is different, objects are not equivalent\n            if (objectAProperties.length !== objectBProperties.length) {\n                return false;\n            }\n        }\n\n        for (var i = 0; i < objectAProperties.length; i++) {\n            propName = objectAProperties[i];\n\n            // If the property is not in the object B properties, continue with the next property\n            if ($.inArray(propName, objectBProperties) > -1) {\n                // If values of same property are not equal, objects are not equivalent\n                if (objectA[propName] !== objectB[propName]) {\n                    return false;\n                }\n            }\n        }\n\n        // If we made it this far, objects are considered equivalent\n        return true;\n    };\n\n    var escapeHTML = function (text) {\n        if (typeof text === 'string') {\n            return text\n                .replace(/&/g, '&amp;')\n                .replace(/</g, '&lt;')\n                .replace(/>/g, '&gt;')\n                .replace(/\"/g, '&quot;')\n                .replace(/'/g, '&#039;')\n                .replace(/`/g, '&#x60;');\n        }\n        return text;\n    };\n\n    var getRealHeight = function ($el) {\n        var height = 0;\n        $el.children().each(function () {\n            if (height < $(this).outerHeight(true)) {\n                height = $(this).outerHeight(true);\n            }\n        });\n        return height;\n    };\n\n    var getRealDataAttr = function (dataAttr) {\n        for (var attr in dataAttr) {\n            var auxAttr = attr.split(/(?=[A-Z])/).join('-').toLowerCase();\n            if (auxAttr !== attr) {\n                dataAttr[auxAttr] = dataAttr[attr];\n                delete dataAttr[attr];\n            }\n        }\n\n        return dataAttr;\n    };\n\n    var getItemField = function (item, field, escape) {\n        var value = item;\n\n        if (typeof field !== 'string' || item.hasOwnProperty(field)) {\n            return escape ? escapeHTML(item[field]) : item[field];\n        }\n        var props = field.split('.');\n        for (var p in props) {\n            value = value && value[props[p]];\n        }\n        return escape ? escapeHTML(value) : value;\n    };\n\n    var isIEBrowser = function () {\n        return !!(navigator.userAgent.indexOf(\"MSIE \") > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./));\n    };\n\n    var objectKeys = function () {\n        // From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys\n        if (!Object.keys) {\n            Object.keys = (function() {\n                var hasOwnProperty = Object.prototype.hasOwnProperty,\n                    hasDontEnumBug = !({ toString: null }).propertyIsEnumerable('toString'),\n                    dontEnums = [\n                        'toString',\n                        'toLocaleString',\n                        'valueOf',\n                        'hasOwnProperty',\n                        'isPrototypeOf',\n                        'propertyIsEnumerable',\n                        'constructor'\n                    ],\n                    dontEnumsLength = dontEnums.length;\n\n                return function(obj) {\n                    if (typeof obj !== 'object' && (typeof obj !== 'function' || obj === null)) {\n                        throw new TypeError('Object.keys called on non-object');\n                    }\n\n                    var result = [], prop, i;\n\n                    for (prop in obj) {\n                        if (hasOwnProperty.call(obj, prop)) {\n                            result.push(prop);\n                        }\n                    }\n\n                    if (hasDontEnumBug) {\n                        for (i = 0; i < dontEnumsLength; i++) {\n                            if (hasOwnProperty.call(obj, dontEnums[i])) {\n                                result.push(dontEnums[i]);\n                            }\n                        }\n                    }\n                    return result;\n                };\n            }());\n        }\n    };\n\n    // BOOTSTRAP TABLE CLASS DEFINITION\n    // ======================\n\n    var BootstrapTable = function (el, options) {\n        this.options = options;\n        this.$el = $(el);\n        this.$el_ = this.$el.clone();\n        this.timeoutId_ = 0;\n        this.timeoutFooter_ = 0;\n\n        this.init();\n    };\n\n    BootstrapTable.DEFAULTS = {\n        classes: 'table table-hover',\n        locale: undefined,\n        height: undefined,\n        undefinedText: '-',\n        sortName: undefined,\n        sortOrder: 'asc',\n        sortStable: false,\n        striped: false,\n        columns: [[]],\n        data: [],\n        dataField: 'rows',\n        method: 'get',\n        url: undefined,\n        ajax: undefined,\n        cache: true,\n        contentType: 'application/json',\n        dataType: 'json',\n        ajaxOptions: {},\n        queryParams: function (params) {\n            return params;\n        },\n        queryParamsType: 'limit', // undefined\n        responseHandler: function (res) {\n            return res;\n        },\n        pagination: false,\n        onlyInfoPagination: false,\n        sidePagination: 'client', // client or server\n        totalRows: 0, // server side need to set\n        pageNumber: 1,\n        pageSize: 10,\n        pageList: [10, 25, 50, 100],\n        paginationHAlign: 'right', //right, left\n        paginationVAlign: 'bottom', //bottom, top, both\n        paginationDetailHAlign: 'left', //right, left\n        paginationPreText: '&lsaquo;',\n        paginationNextText: '&rsaquo;',\n        search: false,\n        searchOnEnterKey: false,\n        strictSearch: false,\n        searchAlign: 'right',\n        selectItemName: 'btSelectItem',\n        showHeader: true,\n        showFooter: false,\n        showColumns: false,\n        showPaginationSwitch: false,\n        showRefresh: false,\n        showToggle: false,\n        buttonsAlign: 'right',\n        smartDisplay: true,\n        escape: false,\n        minimumCountColumns: 1,\n        idField: undefined,\n        uniqueId: undefined,\n        cardView: false,\n        detailView: false,\n        detailFormatter: function (index, row) {\n            return '';\n        },\n        trimOnSearch: true,\n        clickToSelect: false,\n        singleSelect: false,\n        toolbar: undefined,\n        toolbarAlign: 'left',\n        checkboxHeader: true,\n        sortable: true,\n        silentSort: true,\n        maintainSelected: false,\n        searchTimeOut: 500,\n        searchText: '',\n        iconSize: undefined,\n        buttonsClass: 'default',\n        iconsPrefix: 'glyphicon', // glyphicon of fa (font awesome)\n        icons: {\n            paginationSwitchDown: 'glyphicon-collapse-down icon-chevron-down',\n            paginationSwitchUp: 'glyphicon-collapse-up icon-chevron-up',\n            refresh: 'glyphicon-refresh icon-refresh',\n            toggle: 'glyphicon-list-alt icon-list-alt',\n            columns: 'glyphicon-th icon-th',\n            detailOpen: 'glyphicon-plus icon-plus',\n            detailClose: 'glyphicon-minus icon-minus'\n        },\n\n        customSearch: $.noop,\n\n        customSort: $.noop,\n\n        rowStyle: function (row, index) {\n            return {};\n        },\n\n        rowAttributes: function (row, index) {\n            return {};\n        },\n\n        footerStyle: function (row, index) {\n            return {};\n        },\n\n        onAll: function (name, args) {\n            return false;\n        },\n        onClickCell: function (field, value, row, $element) {\n            return false;\n        },\n        onDblClickCell: function (field, value, row, $element) {\n            return false;\n        },\n        onClickRow: function (item, $element) {\n            return false;\n        },\n        onDblClickRow: function (item, $element) {\n            return false;\n        },\n        onSort: function (name, order) {\n            return false;\n        },\n        onCheck: function (row) {\n            return false;\n        },\n        onUncheck: function (row) {\n            return false;\n        },\n        onCheckAll: function (rows) {\n            return false;\n        },\n        onUncheckAll: function (rows) {\n            return false;\n        },\n        onCheckSome: function (rows) {\n            return false;\n        },\n        onUncheckSome: function (rows) {\n            return false;\n        },\n        onLoadSuccess: function (data) {\n            return false;\n        },\n        onLoadError: function (status) {\n            return false;\n        },\n        onColumnSwitch: function (field, checked) {\n            return false;\n        },\n        onPageChange: function (number, size) {\n            return false;\n        },\n        onSearch: function (text) {\n            return false;\n        },\n        onToggle: function (cardView) {\n            return false;\n        },\n        onPreBody: function (data) {\n            return false;\n        },\n        onPostBody: function () {\n            return false;\n        },\n        onPostHeader: function () {\n            return false;\n        },\n        onExpandRow: function (index, row, $detail) {\n            return false;\n        },\n        onCollapseRow: function (index, row) {\n            return false;\n        },\n        onRefreshOptions: function (options) {\n            return false;\n        },\n        onRefresh: function (params) {\n          return false;\n        },\n        onResetView: function () {\n            return false;\n        }\n    };\n\n    BootstrapTable.LOCALES = {};\n\n    BootstrapTable.LOCALES['en-US'] = BootstrapTable.LOCALES.en = {\n        formatLoadingMessage: function () {\n            return 'Loading, please wait...';\n        },\n        formatRecordsPerPage: function (pageNumber) {\n            return sprintf('%s rows per page', pageNumber);\n        },\n        formatShowingRows: function (pageFrom, pageTo, totalRows) {\n            return sprintf('Showing %s to %s of %s rows', pageFrom, pageTo, totalRows);\n        },\n        formatDetailPagination: function (totalRows) {\n            return sprintf('Showing %s rows', totalRows);\n        },\n        formatSearch: function () {\n            return 'Search';\n        },\n        formatNoMatches: function () {\n            return 'No matching records found';\n        },\n        formatPaginationSwitch: function () {\n            return 'Hide/Show pagination';\n        },\n        formatRefresh: function () {\n            return 'Refresh';\n        },\n        formatToggle: function () {\n            return 'Toggle';\n        },\n        formatColumns: function () {\n            return 'Columns';\n        },\n        formatAllRows: function () {\n            return 'All';\n        }\n    };\n\n    $.extend(BootstrapTable.DEFAULTS, BootstrapTable.LOCALES['en-US']);\n\n    BootstrapTable.COLUMN_DEFAULTS = {\n        radio: false,\n        checkbox: false,\n        checkboxEnabled: true,\n        field: undefined,\n        title: undefined,\n        titleTooltip: undefined,\n        'class': undefined,\n        align: undefined, // left, right, center\n        halign: undefined, // left, right, center\n        falign: undefined, // left, right, center\n        valign: undefined, // top, middle, bottom\n        width: undefined,\n        sortable: false,\n        order: 'asc', // asc, desc\n        visible: true,\n        switchable: true,\n        clickToSelect: true,\n        formatter: undefined,\n        footerFormatter: undefined,\n        events: undefined,\n        sorter: undefined,\n        sortName: undefined,\n        cellStyle: undefined,\n        searchable: true,\n        searchFormatter: true,\n        cardVisible: true\n    };\n\n    BootstrapTable.EVENTS = {\n        'all.bs.table': 'onAll',\n        'click-cell.bs.table': 'onClickCell',\n        'dbl-click-cell.bs.table': 'onDblClickCell',\n        'click-row.bs.table': 'onClickRow',\n        'dbl-click-row.bs.table': 'onDblClickRow',\n        'sort.bs.table': 'onSort',\n        'check.bs.table': 'onCheck',\n        'uncheck.bs.table': 'onUncheck',\n        'check-all.bs.table': 'onCheckAll',\n        'uncheck-all.bs.table': 'onUncheckAll',\n        'check-some.bs.table': 'onCheckSome',\n        'uncheck-some.bs.table': 'onUncheckSome',\n        'load-success.bs.table': 'onLoadSuccess',\n        'load-error.bs.table': 'onLoadError',\n        'column-switch.bs.table': 'onColumnSwitch',\n        'page-change.bs.table': 'onPageChange',\n        'search.bs.table': 'onSearch',\n        'toggle.bs.table': 'onToggle',\n        'pre-body.bs.table': 'onPreBody',\n        'post-body.bs.table': 'onPostBody',\n        'post-header.bs.table': 'onPostHeader',\n        'expand-row.bs.table': 'onExpandRow',\n        'collapse-row.bs.table': 'onCollapseRow',\n        'refresh-options.bs.table': 'onRefreshOptions',\n        'reset-view.bs.table': 'onResetView',\n        'refresh.bs.table': 'onRefresh'\n    };\n\n    BootstrapTable.prototype.init = function () {\n        this.initLocale();\n        this.initContainer();\n        this.initTable();\n        this.initHeader();\n        this.initData();\n        this.initFooter();\n        this.initToolbar();\n        this.initPagination();\n        this.initBody();\n        this.initSearchText();\n        this.initServer();\n    };\n\n    BootstrapTable.prototype.initLocale = function () {\n        if (this.options.locale) {\n            var parts = this.options.locale.split(/-|_/);\n            parts[0].toLowerCase();\n            if (parts[1]) parts[1].toUpperCase();\n            if ($.fn.bootstrapTable.locales[this.options.locale]) {\n                // locale as requested\n                $.extend(this.options, $.fn.bootstrapTable.locales[this.options.locale]);\n            } else if ($.fn.bootstrapTable.locales[parts.join('-')]) {\n                // locale with sep set to - (in case original was specified with _)\n                $.extend(this.options, $.fn.bootstrapTable.locales[parts.join('-')]);\n            } else if ($.fn.bootstrapTable.locales[parts[0]]) {\n                // short locale language code (i.e. 'en')\n                $.extend(this.options, $.fn.bootstrapTable.locales[parts[0]]);\n            }\n        }\n    };\n\n    BootstrapTable.prototype.initContainer = function () {\n        this.$container = $([\n            '<div class=\"bootstrap-table\">',\n            '<div class=\"fixed-table-toolbar\"></div>',\n            this.options.paginationVAlign === 'top' || this.options.paginationVAlign === 'both' ?\n                '<div class=\"fixed-table-pagination\" style=\"clear: both;\"></div>' :\n                '',\n            '<div class=\"fixed-table-container\">',\n            '<div class=\"fixed-table-header\"><table></table></div>',\n            '<div class=\"fixed-table-body\">',\n            '<div class=\"fixed-table-loading\">',\n            this.options.formatLoadingMessage(),\n            '</div>',\n            '</div>',\n            '<div class=\"fixed-table-footer\"><table><tr></tr></table></div>',\n            this.options.paginationVAlign === 'bottom' || this.options.paginationVAlign === 'both' ?\n                '<div class=\"fixed-table-pagination\"></div>' :\n                '',\n            '</div>',\n            '</div>'\n        ].join(''));\n\n        this.$container.insertAfter(this.$el);\n        this.$tableContainer = this.$container.find('.fixed-table-container');\n        this.$tableHeader = this.$container.find('.fixed-table-header');\n        this.$tableBody = this.$container.find('.fixed-table-body');\n        this.$tableLoading = this.$container.find('.fixed-table-loading');\n        this.$tableFooter = this.$container.find('.fixed-table-footer');\n        this.$toolbar = this.$container.find('.fixed-table-toolbar');\n        this.$pagination = this.$container.find('.fixed-table-pagination');\n\n        this.$tableBody.append(this.$el);\n        this.$container.after('<div class=\"clearfix\"></div>');\n\n        this.$el.addClass(this.options.classes);\n        if (this.options.striped) {\n            this.$el.addClass('table-striped');\n        }\n        if ($.inArray('table-no-bordered', this.options.classes.split(' ')) !== -1) {\n            this.$tableContainer.addClass('table-no-bordered');\n        }\n    };\n\n    BootstrapTable.prototype.initTable = function () {\n        var that = this,\n            columns = [],\n            data = [];\n\n        this.$header = this.$el.find('>thead');\n        if (!this.$header.length) {\n            this.$header = $('<thead></thead>').appendTo(this.$el);\n        }\n        this.$header.find('tr').each(function () {\n            var column = [];\n\n            $(this).find('th').each(function () {\n                // Fix #2014 - getFieldIndex and elsewhere assume this is string, causes issues if not\n                if (typeof $(this).data('field') !== 'undefined') {\n                    $(this).data('field', $(this).data('field') + '');\n                }\n                column.push($.extend({}, {\n                    title: $(this).html(),\n                    html : $(this).html(),\n                    'class': $(this).attr('class'),\n                    titleTooltip: $(this).attr('title'),\n                    rowspan: $(this).attr('rowspan') ? +$(this).attr('rowspan') : undefined,\n                    colspan: $(this).attr('colspan') ? +$(this).attr('colspan') : undefined\n                }, $(this).data()));\n            });\n            columns.push(column);\n        });\n        if (!$.isArray(this.options.columns[0])) {\n            this.options.columns = [this.options.columns];\n        }\n        this.options.columns = $.extend(true, [], columns, this.options.columns);\n        this.columns = [];\n\n        setFieldIndex(this.options.columns);\n        $.each(this.options.columns, function (i, columns) {\n            $.each(columns, function (j, column) {\n                column = $.extend({}, BootstrapTable.COLUMN_DEFAULTS, column);\n\n                if (typeof column.fieldIndex !== 'undefined') {\n                    that.columns[column.fieldIndex] = column;\n                }\n\n                that.options.columns[i][j] = column;\n            });\n        });\n\n        // if options.data is setting, do not process tbody data\n        if (this.options.data.length) {\n            return;\n        }\n\n        var m = [];\n        this.$el.find('>tbody>tr').each(function (y) {\n            var row = {};\n\n            // save tr's id, class and data-* attributes\n            row._id = $(this).attr('id');\n            row._class = $(this).attr('class');\n            row._data = getRealDataAttr($(this).data());\n\n            $(this).find('>td').each(function (x) {\n                var $this = $(this),\n                    cspan = +$this.attr('colspan') || 1,\n                    rspan = +$this.attr('rowspan') || 1,\n                    tx, ty;\n\n                for (; m[y] && m[y][x]; x++); //skip already occupied cells in current row\n\n                for (tx = x; tx < x + cspan; tx++) { //mark matrix elements occupied by current cell with true\n                    for (ty = y; ty < y + rspan; ty++) {\n                        if (!m[ty]) { //fill missing rows\n                            m[ty] = [];\n                        }\n                        m[ty][tx] = true;\n                    }\n                }\n\n                var field = that.columns[x].field;\n\n                row[field] = $(this).html();\n                // save td's id, class and data-* attributes\n                row['_' + field + '_id'] = $(this).attr('id');\n                row['_' + field + '_class'] = $(this).attr('class');\n                row['_' + field + '_rowspan'] = $(this).attr('rowspan');\n                row['_' + field + '_colspan'] = $(this).attr('colspan');\n                row['_' + field + '_title'] = $(this).attr('title');\n                row['_' + field + '_data'] = getRealDataAttr($(this).data());\n            });\n            data.push(row);\n        });\n        this.options.data = data;\n        if (data.length) this.fromHtml = true;\n    };\n\n    BootstrapTable.prototype.initHeader = function () {\n        var that = this,\n            visibleColumns = {},\n            html = [];\n\n        this.header = {\n            fields: [],\n            styles: [],\n            classes: [],\n            formatters: [],\n            events: [],\n            sorters: [],\n            sortNames: [],\n            cellStyles: [],\n            searchables: []\n        };\n\n        $.each(this.options.columns, function (i, columns) {\n            html.push('<tr>');\n\n            if (i === 0 && !that.options.cardView && that.options.detailView) {\n                html.push(sprintf('<th class=\"detail\" rowspan=\"%s\"><div class=\"fht-cell\"></div></th>',\n                    that.options.columns.length));\n            }\n\n            $.each(columns, function (j, column) {\n                var text = '',\n                    halign = '', // header align style\n                    align = '', // body align style\n                    style = '',\n                    class_ = sprintf(' class=\"%s\"', column['class']),\n                    order = that.options.sortOrder || column.order,\n                    unitWidth = 'px',\n                    width = column.width;\n\n                if (column.width !== undefined && (!that.options.cardView)) {\n                    if (typeof column.width === 'string') {\n                        if (column.width.indexOf('%') !== -1) {\n                            unitWidth = '%';\n                        }\n                    }\n                }\n                if (column.width && typeof column.width === 'string') {\n                    width = column.width.replace('%', '').replace('px', '');\n                }\n\n                halign = sprintf('text-align: %s; ', column.halign ? column.halign : column.align);\n                align = sprintf('text-align: %s; ', column.align);\n                style = sprintf('vertical-align: %s; ', column.valign);\n                style += sprintf('width: %s; ', (column.checkbox || column.radio) && !width ?\n                    '36px' : (width ? width + unitWidth : undefined));\n\n                if (typeof column.fieldIndex !== 'undefined') {\n                    that.header.fields[column.fieldIndex] = column.field;\n                    that.header.styles[column.fieldIndex] = align + style;\n                    that.header.classes[column.fieldIndex] = class_;\n                    that.header.formatters[column.fieldIndex] = column.formatter;\n                    that.header.events[column.fieldIndex] = column.events;\n                    that.header.sorters[column.fieldIndex] = column.sorter;\n                    that.header.sortNames[column.fieldIndex] = column.sortName;\n                    that.header.cellStyles[column.fieldIndex] = column.cellStyle;\n                    that.header.searchables[column.fieldIndex] = column.searchable;\n\n                    if (!column.visible) {\n                        return;\n                    }\n\n                    if (that.options.cardView && (!column.cardVisible)) {\n                        return;\n                    }\n\n                    visibleColumns[column.field] = column;\n                }\n\n                html.push('<th' + sprintf(' title=\"%s\"', column.titleTooltip),\n                    column.checkbox || column.radio ?\n                        sprintf(' class=\"bs-checkbox %s\"', column['class'] || '') :\n                        class_,\n                    sprintf(' style=\"%s\"', halign + style),\n                    sprintf(' rowspan=\"%s\"', column.rowspan),\n                    sprintf(' colspan=\"%s\"', column.colspan),\n                    sprintf(' data-field=\"%s\"', column.field),\n                    \"tabindex='0'\",\n                    '>');\n\n                html.push(sprintf('<div class=\"th-inner %s\">', that.options.sortable && column.sortable ?\n                    'sortable both' : ''));\n\n                text = column.title;\n\n                if (column.checkbox) {\n                    if (!that.options.singleSelect && that.options.checkboxHeader) {\n                        text = '<input name=\"btSelectAll\" type=\"checkbox\" />';\n                    }\n                    that.header.stateField = column.field;\n                }\n                if (column.radio) {\n                    text = '';\n                    that.header.stateField = column.field;\n                    that.options.singleSelect = true;\n                }\n\n                html.push(text);\n                html.push('</div>');\n                html.push('<div class=\"fht-cell\"></div>');\n                html.push('</div>');\n                html.push('</th>');\n            });\n            html.push('</tr>');\n        });\n\n        this.$header.html(html.join(''));\n        this.$header.find('th[data-field]').each(function (i) {\n            $(this).data(visibleColumns[$(this).data('field')]);\n        });\n        this.$container.off('click', '.th-inner').on('click', '.th-inner', function (event) {\n            var target = $(this);\n\n            if (that.options.detailView) {\n                if (target.closest('.bootstrap-table')[0] !== that.$container[0])\n                    return false;\n            }\n\n            if (that.options.sortable && target.parent().data().sortable) {\n                that.onSort(event);\n            }\n        });\n\n        this.$header.children().children().off('keypress').on('keypress', function (event) {\n            if (that.options.sortable && $(this).data().sortable) {\n                var code = event.keyCode || event.which;\n                if (code == 13) { //Enter keycode\n                    that.onSort(event);\n                }\n            }\n        });\n\n        $(window).off('resize.bootstrap-table');\n        if (!this.options.showHeader || this.options.cardView) {\n            this.$header.hide();\n            this.$tableHeader.hide();\n            this.$tableLoading.css('top', 0);\n        } else {\n            this.$header.show();\n            this.$tableHeader.show();\n            this.$tableLoading.css('top', this.$header.outerHeight() + 1);\n            // Assign the correct sortable arrow\n            this.getCaret();\n            $(window).on('resize.bootstrap-table', $.proxy(this.resetWidth, this));\n        }\n\n        this.$selectAll = this.$header.find('[name=\"btSelectAll\"]');\n        this.$selectAll.off('click').on('click', function () {\n                var checked = $(this).prop('checked');\n                that[checked ? 'checkAll' : 'uncheckAll']();\n                that.updateSelected();\n            });\n    };\n\n    BootstrapTable.prototype.initFooter = function () {\n        if (!this.options.showFooter || this.options.cardView) {\n            this.$tableFooter.hide();\n        } else {\n            this.$tableFooter.show();\n        }\n    };\n\n    /**\n     * @param data\n     * @param type: append / prepend\n     */\n    BootstrapTable.prototype.initData = function (data, type) {\n        if (type === 'append') {\n            this.data = this.data.concat(data);\n        } else if (type === 'prepend') {\n            this.data = [].concat(data).concat(this.data);\n        } else {\n            this.data = data || this.options.data;\n        }\n\n        // Fix #839 Records deleted when adding new row on filtered table\n        if (type === 'append') {\n            this.options.data = this.options.data.concat(data);\n        } else if (type === 'prepend') {\n            this.options.data = [].concat(data).concat(this.options.data);\n        } else {\n            this.options.data = this.data;\n        }\n\n        if (this.options.sidePagination === 'server') {\n            return;\n        }\n        this.initSort();\n    };\n\n    BootstrapTable.prototype.initSort = function () {\n        var that = this,\n            name = this.options.sortName,\n            order = this.options.sortOrder === 'desc' ? -1 : 1,\n            index = $.inArray(this.options.sortName, this.header.fields);\n\n        if (this.options.customSort !== $.noop) {\n            this.options.customSort.apply(this, [this.options.sortName, this.options.sortOrder]);\n            return;\n        }\n\n        if (index !== -1) {\n            if (this.options.sortStable) {\n                $.each(this.data, function (i, row) {\n                    if (!row.hasOwnProperty('_position')) row._position = i;\n                });\n            }\n\n            this.data.sort(function (a, b) {\n                if (that.header.sortNames[index]) {\n                    name = that.header.sortNames[index];\n                }\n                var aa = getItemField(a, name, that.options.escape),\n                    bb = getItemField(b, name, that.options.escape),\n                    value = calculateObjectValue(that.header, that.header.sorters[index], [aa, bb]);\n\n                if (value !== undefined) {\n                    return order * value;\n                }\n\n                // Fix #161: undefined or null string sort bug.\n                if (aa === undefined || aa === null) {\n                    aa = '';\n                }\n                if (bb === undefined || bb === null) {\n                    bb = '';\n                }\n\n                if (that.options.sortStable && aa === bb) {\n                    aa = a._position;\n                    bb = b._position;\n                }\n\n                // IF both values are numeric, do a numeric comparison\n                if ($.isNumeric(aa) && $.isNumeric(bb)) {\n                    // Convert numerical values form string to float.\n                    aa = parseFloat(aa);\n                    bb = parseFloat(bb);\n                    if (aa < bb) {\n                        return order * -1;\n                    }\n                    return order;\n                }\n\n                if (aa === bb) {\n                    return 0;\n                }\n\n                // If value is not a string, convert to string\n                if (typeof aa !== 'string') {\n                    aa = aa.toString();\n                }\n\n                if (aa.localeCompare(bb) === -1) {\n                    return order * -1;\n                }\n\n                return order;\n            });\n        }\n    };\n\n    BootstrapTable.prototype.onSort = function (event) {\n        var $this = event.type === \"keypress\" ? $(event.currentTarget) : $(event.currentTarget).parent(),\n            $this_ = this.$header.find('th').eq($this.index());\n\n        this.$header.add(this.$header_).find('span.order').remove();\n\n        var sortName = $this.data('field');\n        if($this.data('sort-name'))sortName = $this.data('sort-name');\n        \n        if (this.options.sortName === sortName) {\n            this.options.sortOrder = this.options.sortOrder === 'asc' ? 'desc' : 'asc';\n        } else {\n            this.options.sortName = sortName;\n            this.options.sortOrder = $this.data('order') === 'asc' ? 'desc' : 'asc';\n        }\n        this.trigger('sort', this.options.sortName, this.options.sortOrder);\n\n        $this.add($this_).data('order', this.options.sortOrder);\n\n        // Assign the correct sortable arrow\n        this.getCaret();\n\n        if (this.options.sidePagination === 'server') {\n            this.initServer(this.options.silentSort);\n            return;\n        }\n\n        this.initSort();\n        this.initBody();\n    };\n\n    BootstrapTable.prototype.initToolbar = function () {\n        var that = this,\n            html = [],\n            timeoutId = 0,\n            $keepOpen,\n            $search,\n            switchableCount = 0;\n\n        if (this.$toolbar.find('.bs-bars').children().length) {\n            $('body').append($(this.options.toolbar));\n        }\n        this.$toolbar.html('');\n\n        if (typeof this.options.toolbar === 'string' || typeof this.options.toolbar === 'object') {\n            $(sprintf('<div class=\"bs-bars pull-%s\"></div>', this.options.toolbarAlign))\n                .appendTo(this.$toolbar)\n                .append($(this.options.toolbar));\n        }\n\n        // showColumns, showToggle, showRefresh\n        html = [sprintf('<div class=\"columns columns-%s btn-group pull-%s\">',\n            this.options.buttonsAlign, this.options.buttonsAlign)];\n\n        if (typeof this.options.icons === 'string') {\n            this.options.icons = calculateObjectValue(null, this.options.icons);\n        }\n\n        if (this.options.showPaginationSwitch) {\n            html.push(sprintf('<button class=\"btn' +\n                    sprintf(' btn-%s', this.options.buttonsClass) +\n                    sprintf(' btn-%s', this.options.iconSize) +\n                    '\" type=\"button\" name=\"paginationSwitch\" title=\"%s\">',\n                    this.options.formatPaginationSwitch()),\n                sprintf('<i class=\"%s %s\"></i>', this.options.iconsPrefix, this.options.icons.paginationSwitchDown),\n                '</button>');\n        }\n\n        if (this.options.showRefresh) {\n            html.push(sprintf('<button class=\"btn' +\n                    sprintf(' btn-%s', this.options.buttonsClass) +\n                    sprintf(' btn-%s', this.options.iconSize) +\n                    '\" type=\"button\" name=\"refresh\" title=\"%s\">',\n                    this.options.formatRefresh()),\n                sprintf('<i class=\"%s %s\"></i>', this.options.iconsPrefix, this.options.icons.refresh),\n                '</button>');\n        }\n\n        if (this.options.showToggle) {\n            html.push(sprintf('<button class=\"btn' +\n                    sprintf(' btn-%s', this.options.buttonsClass) +\n                    sprintf(' btn-%s', this.options.iconSize) +\n                    '\" type=\"button\" name=\"toggle\" title=\"%s\">',\n                    this.options.formatToggle()),\n                sprintf('<i class=\"%s %s\"></i>', this.options.iconsPrefix, this.options.icons.toggle),\n                '</button>');\n        }\n\n        if (this.options.showColumns) {\n            html.push(sprintf('<div class=\"keep-open btn-group\" title=\"%s\">',\n                    this.options.formatColumns()),\n                '<button type=\"button\" class=\"btn' +\n                sprintf(' btn-%s', this.options.buttonsClass) +\n                sprintf(' btn-%s', this.options.iconSize) +\n                ' dropdown-toggle\" data-toggle=\"dropdown\">',\n                sprintf('<i class=\"%s %s\"></i>', this.options.iconsPrefix, this.options.icons.columns),\n                ' <span class=\"caret\"></span>',\n                '</button>',\n                '<ul class=\"dropdown-menu\" role=\"menu\">');\n\n            $.each(this.columns, function (i, column) {\n                if (column.radio || column.checkbox) {\n                    return;\n                }\n\n                if (that.options.cardView && !column.cardVisible) {\n                    return;\n                }\n\n                var checked = column.visible ? ' checked=\"checked\"' : '';\n\n                if (column.switchable) {\n                    html.push(sprintf('<li>' +\n                        '<label><input type=\"checkbox\" data-field=\"%s\" value=\"%s\"%s> %s</label>' +\n                        '</li>', column.field, i, checked, column.title));\n                    switchableCount++;\n                }\n            });\n            html.push('</ul>',\n                '</div>');\n        }\n\n        html.push('</div>');\n\n        // Fix #188: this.showToolbar is for extensions\n        if (this.showToolbar || html.length > 2) {\n            this.$toolbar.append(html.join(''));\n        }\n\n        if (this.options.showPaginationSwitch) {\n            this.$toolbar.find('button[name=\"paginationSwitch\"]')\n                .off('click').on('click', $.proxy(this.togglePagination, this));\n        }\n\n        if (this.options.showRefresh) {\n            this.$toolbar.find('button[name=\"refresh\"]')\n                .off('click').on('click', $.proxy(this.refresh, this));\n        }\n\n        if (this.options.showToggle) {\n            this.$toolbar.find('button[name=\"toggle\"]')\n                .off('click').on('click', function () {\n                    that.toggleView();\n                });\n        }\n\n        if (this.options.showColumns) {\n            $keepOpen = this.$toolbar.find('.keep-open');\n\n            if (switchableCount <= this.options.minimumCountColumns) {\n                $keepOpen.find('input').prop('disabled', true);\n            }\n\n            $keepOpen.find('li').off('click').on('click', function (event) {\n                event.stopImmediatePropagation();\n            });\n            $keepOpen.find('input').off('click').on('click', function () {\n                var $this = $(this);\n\n                that.toggleColumn($(this).val(), $this.prop('checked'), false);\n                that.trigger('column-switch', $(this).data('field'), $this.prop('checked'));\n            });\n        }\n\n        if (this.options.search) {\n            html = [];\n            html.push(\n                '<div class=\"pull-' + this.options.searchAlign + ' search\">',\n                sprintf('<input class=\"form-control' +\n                    sprintf(' input-%s', this.options.iconSize) +\n                    '\" type=\"text\" placeholder=\"%s\">',\n                    this.options.formatSearch()),\n                '</div>');\n\n            this.$toolbar.append(html.join(''));\n            $search = this.$toolbar.find('.search input');\n            $search.off('keyup drop').on('keyup drop', function (event) {\n                if (that.options.searchOnEnterKey && event.keyCode !== 13) {\n                    return;\n                }\n\n                if ($.inArray(event.keyCode, [37, 38, 39, 40]) > -1) {\n                    return;\n                }\n\n                clearTimeout(timeoutId); // doesn't matter if it's 0\n                timeoutId = setTimeout(function () {\n                    that.onSearch(event);\n                }, that.options.searchTimeOut);\n            });\n\n            if (isIEBrowser()) {\n                $search.off('mouseup').on('mouseup', function (event) {\n                    clearTimeout(timeoutId); // doesn't matter if it's 0\n                    timeoutId = setTimeout(function () {\n                        that.onSearch(event);\n                    }, that.options.searchTimeOut);\n                });\n            }\n        }\n    };\n\n    BootstrapTable.prototype.onSearch = function (event) {\n        var text = $.trim($(event.currentTarget).val());\n\n        // trim search input\n        if (this.options.trimOnSearch && $(event.currentTarget).val() !== text) {\n            $(event.currentTarget).val(text);\n        }\n\n        if (text === this.searchText) {\n            return;\n        }\n        this.searchText = text;\n        this.options.searchText = text;\n\n        this.options.pageNumber = 1;\n        this.initSearch();\n        this.updatePagination();\n        this.trigger('search', text);\n    };\n\n    BootstrapTable.prototype.initSearch = function () {\n        var that = this;\n\n        if (this.options.sidePagination !== 'server') {\n            if (this.options.customSearch !== $.noop) {\n                this.options.customSearch.apply(this, [this.searchText]);\n                return;\n            }\n\n            var s = this.searchText && (this.options.escape ?\n                escapeHTML(this.searchText) : this.searchText).toLowerCase();\n            var f = $.isEmptyObject(this.filterColumns) ? null : this.filterColumns;\n\n            // Check filter\n            this.data = f ? $.grep(this.options.data, function (item, i) {\n                for (var key in f) {\n                    if ($.isArray(f[key]) && $.inArray(item[key], f[key]) === -1 ||\n                            item[key] !== f[key]) {\n                        return false;\n                    }\n                }\n                return true;\n            }) : this.options.data;\n\n            this.data = s ? $.grep(this.data, function (item, i) {\n                for (var j = 0; j < that.header.fields.length; j++) {\n\n                    if (!that.header.searchables[j]) {\n                        continue;\n                    }\n\n                    var key = $.isNumeric(that.header.fields[j]) ? parseInt(that.header.fields[j], 10) : that.header.fields[j];\n                    var column = that.columns[getFieldIndex(that.columns, key)];\n                    var value;\n\n                    if (typeof key === 'string') {\n                        value = item;\n                        var props = key.split('.');\n                        for (var prop_index = 0; prop_index < props.length; prop_index++) {\n                            value = value[props[prop_index]];\n                        }\n\n                        // Fix #142: respect searchForamtter boolean\n                        if (column && column.searchFormatter) {\n                            value = calculateObjectValue(column,\n                                that.header.formatters[j], [value, item, i], value);\n                        }\n                    } else {\n                        value = item[key];\n                    }\n\n                    if (typeof value === 'string' || typeof value === 'number') {\n                        if (that.options.strictSearch) {\n                            if ((value + '').toLowerCase() === s) {\n                                return true;\n                            }\n                        } else {\n                            if ((value + '').toLowerCase().indexOf(s) !== -1) {\n                                return true;\n                            }\n                        }\n                    }\n                }\n                return false;\n            }) : this.data;\n        }\n    };\n\n    BootstrapTable.prototype.initPagination = function () {\n        if (!this.options.pagination) {\n            this.$pagination.hide();\n            return;\n        } else {\n            this.$pagination.show();\n        }\n\n        var that = this,\n            html = [],\n            $allSelected = false,\n            i, from, to,\n            $pageList,\n            $first, $pre,\n            $next, $last,\n            $number,\n            data = this.getData(),\n            pageList = this.options.pageList;\n\n        if (this.options.sidePagination !== 'server') {\n            this.options.totalRows = data.length;\n        }\n\n        this.totalPages = 0;\n        if (this.options.totalRows) {\n            if (this.options.pageSize === this.options.formatAllRows()) {\n                this.options.pageSize = this.options.totalRows;\n                $allSelected = true;\n            } else if (this.options.pageSize === this.options.totalRows) {\n                // Fix #667 Table with pagination,\n                // multiple pages and a search that matches to one page throws exception\n                var pageLst = typeof this.options.pageList === 'string' ?\n                    this.options.pageList.replace('[', '').replace(']', '')\n                        .replace(/ /g, '').toLowerCase().split(',') : this.options.pageList;\n                if ($.inArray(this.options.formatAllRows().toLowerCase(), pageLst)  > -1) {\n                    $allSelected = true;\n                }\n            }\n\n            this.totalPages = ~~((this.options.totalRows - 1) / this.options.pageSize) + 1;\n\n            this.options.totalPages = this.totalPages;\n        }\n        if (this.totalPages > 0 && this.options.pageNumber > this.totalPages) {\n            this.options.pageNumber = this.totalPages;\n        }\n\n        this.pageFrom = (this.options.pageNumber - 1) * this.options.pageSize + 1;\n        this.pageTo = this.options.pageNumber * this.options.pageSize;\n        if (this.pageTo > this.options.totalRows) {\n            this.pageTo = this.options.totalRows;\n        }\n\n        html.push(\n            '<div class=\"pull-' + this.options.paginationDetailHAlign + ' pagination-detail\">',\n            '<span class=\"pagination-info\">',\n            this.options.onlyInfoPagination ? this.options.formatDetailPagination(this.options.totalRows) :\n            this.options.formatShowingRows(this.pageFrom, this.pageTo, this.options.totalRows),\n            '</span>');\n\n        if (!this.options.onlyInfoPagination) {\n            html.push('<span class=\"page-list\">');\n\n            var pageNumber = [\n                    sprintf('<span class=\"btn-group %s\">',\n                        this.options.paginationVAlign === 'top' || this.options.paginationVAlign === 'both' ?\n                            'dropdown' : 'dropup'),\n                    '<button type=\"button\" class=\"btn' +\n                    sprintf(' btn-%s', this.options.buttonsClass) +\n                    sprintf(' btn-%s', this.options.iconSize) +\n                    ' dropdown-toggle\" data-toggle=\"dropdown\">',\n                    '<span class=\"page-size\">',\n                    $allSelected ? this.options.formatAllRows() : this.options.pageSize,\n                    '</span>',\n                    ' <span class=\"caret\"></span>',\n                    '</button>',\n                    '<ul class=\"dropdown-menu\" role=\"menu\">'\n                ];\n\n            if (typeof this.options.pageList === 'string') {\n                var list = this.options.pageList.replace('[', '').replace(']', '')\n                    .replace(/ /g, '').split(',');\n\n                pageList = [];\n                $.each(list, function (i, value) {\n                    pageList.push(value.toUpperCase() === that.options.formatAllRows().toUpperCase() ?\n                        that.options.formatAllRows() : +value);\n                });\n            }\n\n            $.each(pageList, function (i, page) {\n                if (!that.options.smartDisplay || i === 0 || pageList[i - 1] <= that.options.totalRows) {\n                    var active;\n                    if ($allSelected) {\n                        active = page === that.options.formatAllRows() ? ' class=\"active\"' : '';\n                    } else {\n                        active = page === that.options.pageSize ? ' class=\"active\"' : '';\n                    }\n                    pageNumber.push(sprintf('<li%s><a href=\"javascript:void(0)\">%s</a></li>', active, page));\n                }\n            });\n            pageNumber.push('</ul></span>');\n\n            html.push(this.options.formatRecordsPerPage(pageNumber.join('')));\n            html.push('</span>');\n\n            html.push('</div>',\n                '<div class=\"pull-' + this.options.paginationHAlign + ' pagination\">',\n                '<ul class=\"pagination' + sprintf(' pagination-%s', this.options.iconSize) + '\">',\n                '<li class=\"page-pre\"><a href=\"javascript:void(0)\">' + this.options.paginationPreText + '</a></li>');\n\n            if (this.totalPages < 5) {\n                from = 1;\n                to = this.totalPages;\n            } else {\n                from = this.options.pageNumber - 2;\n                to = from + 4;\n                if (from < 1) {\n                    from = 1;\n                    to = 5;\n                }\n                if (to > this.totalPages) {\n                    to = this.totalPages;\n                    from = to - 4;\n                }\n            }\n\n            if (this.totalPages >= 6) {\n                if (this.options.pageNumber >= 3) {\n                    html.push('<li class=\"page-first' + (1 === this.options.pageNumber ? ' active' : '') + '\">',\n                        '<a href=\"javascript:void(0)\">', 1, '</a>',\n                        '</li>');\n\n                    from++;\n                }\n\n                if (this.options.pageNumber >= 4) {\n                    if (this.options.pageNumber == 4 || this.totalPages == 6 || this.totalPages == 7) {\n                        from--;\n                    } else {\n                        html.push('<li class=\"page-first-separator disabled\">',\n                            '<a href=\"javascript:void(0)\">...</a>',\n                            '</li>');\n                    }\n\n                    to--;\n                }\n            }\n\n            if (this.totalPages >= 7) {\n                if (this.options.pageNumber >= (this.totalPages - 2)) {\n                    from--;\n                }\n            }\n\n            if (this.totalPages == 6) {\n                if (this.options.pageNumber >= (this.totalPages - 2)) {\n                    to++;\n                }\n            } else if (this.totalPages >= 7) {\n                if (this.totalPages == 7 || this.options.pageNumber >= (this.totalPages - 3)) {\n                    to++;\n                }\n            }\n\n            for (i = from; i <= to; i++) {\n                html.push('<li class=\"page-number' + (i === this.options.pageNumber ? ' active' : '') + '\">',\n                    '<a href=\"javascript:void(0)\">', i, '</a>',\n                    '</li>');\n            }\n\n            if (this.totalPages >= 8) {\n                if (this.options.pageNumber <= (this.totalPages - 4)) {\n                    html.push('<li class=\"page-last-separator disabled\">',\n                        '<a href=\"javascript:void(0)\">...</a>',\n                        '</li>');\n                }\n            }\n\n            if (this.totalPages >= 6) {\n                if (this.options.pageNumber <= (this.totalPages - 3)) {\n                    html.push('<li class=\"page-last' + (this.totalPages === this.options.pageNumber ? ' active' : '') + '\">',\n                        '<a href=\"javascript:void(0)\">', this.totalPages, '</a>',\n                        '</li>');\n                }\n            }\n\n            html.push(\n                '<li class=\"page-next\"><a href=\"javascript:void(0)\">' + this.options.paginationNextText + '</a></li>',\n                '</ul>',\n                '</div>');\n        }\n        this.$pagination.html(html.join(''));\n\n        if (!this.options.onlyInfoPagination) {\n            $pageList = this.$pagination.find('.page-list a');\n            $first = this.$pagination.find('.page-first');\n            $pre = this.$pagination.find('.page-pre');\n            $next = this.$pagination.find('.page-next');\n            $last = this.$pagination.find('.page-last');\n            $number = this.$pagination.find('.page-number');\n\n            if (this.options.smartDisplay) {\n                if (this.totalPages <= 1) {\n                    this.$pagination.find('div.pagination').hide();\n                }\n                if (pageList.length < 2 || this.options.totalRows <= pageList[0]) {\n                    this.$pagination.find('span.page-list').hide();\n                }\n\n                // when data is empty, hide the pagination\n                this.$pagination[this.getData().length ? 'show' : 'hide']();\n            }\n            if ($allSelected) {\n                this.options.pageSize = this.options.formatAllRows();\n            }\n            $pageList.off('click').on('click', $.proxy(this.onPageListChange, this));\n            $first.off('click').on('click', $.proxy(this.onPageFirst, this));\n            $pre.off('click').on('click', $.proxy(this.onPagePre, this));\n            $next.off('click').on('click', $.proxy(this.onPageNext, this));\n            $last.off('click').on('click', $.proxy(this.onPageLast, this));\n            $number.off('click').on('click', $.proxy(this.onPageNumber, this));\n        }\n    };\n\n    BootstrapTable.prototype.updatePagination = function (event) {\n        // Fix #171: IE disabled button can be clicked bug.\n        if (event && $(event.currentTarget).hasClass('disabled')) {\n            return;\n        }\n\n        if (!this.options.maintainSelected) {\n            this.resetRows();\n        }\n\n        this.initPagination();\n        if (this.options.sidePagination === 'server') {\n            this.initServer();\n        } else {\n            this.initBody();\n        }\n\n        this.trigger('page-change', this.options.pageNumber, this.options.pageSize);\n    };\n\n    BootstrapTable.prototype.onPageListChange = function (event) {\n        var $this = $(event.currentTarget);\n\n        $this.parent().addClass('active').siblings().removeClass('active');\n        this.options.pageSize = $this.text().toUpperCase() === this.options.formatAllRows().toUpperCase() ?\n            this.options.formatAllRows() : +$this.text();\n        this.$toolbar.find('.page-size').text(this.options.pageSize);\n\n        this.updatePagination(event);\n    };\n\n    BootstrapTable.prototype.onPageFirst = function (event) {\n        this.options.pageNumber = 1;\n        this.updatePagination(event);\n    };\n\n    BootstrapTable.prototype.onPagePre = function (event) {\n        if ((this.options.pageNumber - 1) === 0) {\n            this.options.pageNumber = this.options.totalPages;\n        } else {\n            this.options.pageNumber--;\n        }\n        this.updatePagination(event);\n    };\n\n    BootstrapTable.prototype.onPageNext = function (event) {\n        if ((this.options.pageNumber + 1) > this.options.totalPages) {\n            this.options.pageNumber = 1;\n        } else {\n            this.options.pageNumber++;\n        }\n        this.updatePagination(event);\n    };\n\n    BootstrapTable.prototype.onPageLast = function (event) {\n        this.options.pageNumber = this.totalPages;\n        this.updatePagination(event);\n    };\n\n    BootstrapTable.prototype.onPageNumber = function (event) {\n        if (this.options.pageNumber === +$(event.currentTarget).text()) {\n            return;\n        }\n        this.options.pageNumber = +$(event.currentTarget).text();\n        this.updatePagination(event);\n    };\n\n    BootstrapTable.prototype.initBody = function (fixedScroll) {\n        var that = this,\n            html = [],\n            data = this.getData();\n\n        this.trigger('pre-body', data);\n\n        this.$body = this.$el.find('>tbody');\n        if (!this.$body.length) {\n            this.$body = $('<tbody></tbody>').appendTo(this.$el);\n        }\n\n        //Fix #389 Bootstrap-table-flatJSON is not working\n\n        if (!this.options.pagination || this.options.sidePagination === 'server') {\n            this.pageFrom = 1;\n            this.pageTo = data.length;\n        }\n\n        for (var i = this.pageFrom - 1; i < this.pageTo; i++) {\n            var key,\n                item = data[i],\n                style = {},\n                csses = [],\n                data_ = '',\n                attributes = {},\n                htmlAttributes = [];\n\n            style = calculateObjectValue(this.options, this.options.rowStyle, [item, i], style);\n\n            if (style && style.css) {\n                for (key in style.css) {\n                    csses.push(key + ': ' + style.css[key]);\n                }\n            }\n\n            attributes = calculateObjectValue(this.options,\n                this.options.rowAttributes, [item, i], attributes);\n\n            if (attributes) {\n                for (key in attributes) {\n                    htmlAttributes.push(sprintf('%s=\"%s\"', key, escapeHTML(attributes[key])));\n                }\n            }\n\n            if (item._data && !$.isEmptyObject(item._data)) {\n                $.each(item._data, function (k, v) {\n                    // ignore data-index\n                    if (k === 'index') {\n                        return;\n                    }\n                    data_ += sprintf(' data-%s=\"%s\"', k, v);\n                });\n            }\n\n            html.push('<tr',\n                sprintf(' %s', htmlAttributes.join(' ')),\n                sprintf(' id=\"%s\"', $.isArray(item) ? undefined : item._id),\n                sprintf(' class=\"%s\"', style.classes || ($.isArray(item) ? undefined : item._class)),\n                sprintf(' data-index=\"%s\"', i),\n                sprintf(' data-uniqueid=\"%s\"', item[this.options.uniqueId]),\n                sprintf('%s', data_),\n                '>'\n            );\n\n            if (this.options.cardView) {\n                html.push(sprintf('<td colspan=\"%s\"><div class=\"card-views\">', this.header.fields.length));\n            }\n\n            if (!this.options.cardView && this.options.detailView) {\n                html.push('<td>',\n                    '<a class=\"detail-icon\" href=\"javascript:\">',\n                    sprintf('<i class=\"%s %s\"></i>', this.options.iconsPrefix, this.options.icons.detailOpen),\n                    '</a>',\n                    '</td>');\n            }\n\n            $.each(this.header.fields, function (j, field) {\n                var text = '',\n                    value = getItemField(item, field, that.options.escape),\n                    type = '',\n                    cellStyle = {},\n                    id_ = '',\n                    class_ = that.header.classes[j],\n                    data_ = '',\n                    rowspan_ = '',\n                    colspan_ = '',\n                    title_ = '',\n                    column = that.columns[j];\n\n                if (that.fromHtml && typeof value === 'undefined') {\n                    return;\n                }\n\n                if (!column.visible) {\n                    return;\n                }\n\n                if (that.options.cardView && !column.cardVisible) {\n                    return;\n                }\n\n                style = sprintf('style=\"%s\"', csses.concat(that.header.styles[j]).join('; '));\n\n                // handle td's id and class\n                if (item['_' + field + '_id']) {\n                    id_ = sprintf(' id=\"%s\"', item['_' + field + '_id']);\n                }\n                if (item['_' + field + '_class']) {\n                    class_ = sprintf(' class=\"%s\"', item['_' + field + '_class']);\n                }\n                if (item['_' + field + '_rowspan']) {\n                    rowspan_ = sprintf(' rowspan=\"%s\"', item['_' + field + '_rowspan']);\n                }\n                if (item['_' + field + '_colspan']) {\n                    colspan_ = sprintf(' colspan=\"%s\"', item['_' + field + '_colspan']);\n                }\n                if (item['_' + field + '_title']) {\n                    title_ = sprintf(' title=\"%s\"', item['_' + field + '_title']);\n                }\n                cellStyle = calculateObjectValue(that.header,\n                    that.header.cellStyles[j], [value, item, i, field], cellStyle);\n                if (cellStyle.classes) {\n                    class_ = sprintf(' class=\"%s\"', cellStyle.classes);\n                }\n                if (cellStyle.css) {\n                    var csses_ = [];\n                    for (var key in cellStyle.css) {\n                        csses_.push(key + ': ' + cellStyle.css[key]);\n                    }\n                    style = sprintf('style=\"%s\"', csses_.concat(that.header.styles[j]).join('; '));\n                }\n\n                value = calculateObjectValue(column,\n                    that.header.formatters[j], [value, item, i], value);\n\n                if (item['_' + field + '_data'] && !$.isEmptyObject(item['_' + field + '_data'])) {\n                    $.each(item['_' + field + '_data'], function (k, v) {\n                        // ignore data-index\n                        if (k === 'index') {\n                            return;\n                        }\n                        data_ += sprintf(' data-%s=\"%s\"', k, v);\n                    });\n                }\n\n                if (column.checkbox || column.radio) {\n                    type = column.checkbox ? 'checkbox' : type;\n                    type = column.radio ? 'radio' : type;\n\n                    text = [sprintf(that.options.cardView ?\n                        '<div class=\"card-view %s\">' : '<td class=\"bs-checkbox %s\">', column['class'] || ''),\n                        '<input' +\n                        sprintf(' data-index=\"%s\"', i) +\n                        sprintf(' name=\"%s\"', that.options.selectItemName) +\n                        sprintf(' type=\"%s\"', type) +\n                        sprintf(' value=\"%s\"', item[that.options.idField]) +\n                        sprintf(' checked=\"%s\"', value === true ||\n                        (value && value.checked) ? 'checked' : undefined) +\n                        sprintf(' disabled=\"%s\"', !column.checkboxEnabled ||\n                        (value && value.disabled) ? 'disabled' : undefined) +\n                        ' />',\n                        that.header.formatters[j] && typeof value === 'string' ? value : '',\n                        that.options.cardView ? '</div>' : '</td>'\n                    ].join('');\n\n                    item[that.header.stateField] = value === true || (value && value.checked);\n                } else {\n                    value = typeof value === 'undefined' || value === null ?\n                        that.options.undefinedText : value;\n\n                    text = that.options.cardView ? ['<div class=\"card-view\">',\n                        that.options.showHeader ? sprintf('<span class=\"title\" %s>%s</span>', style,\n                            getPropertyFromOther(that.columns, 'field', 'title', field)) : '',\n                        sprintf('<span class=\"value\">%s</span>', value),\n                        '</div>'\n                    ].join('') : [sprintf('<td%s %s %s %s %s %s %s>',\n                        id_, class_, style, data_, rowspan_, colspan_, title_),\n                        value,\n                        '</td>'\n                    ].join('');\n\n                    // Hide empty data on Card view when smartDisplay is set to true.\n                    if (that.options.cardView && that.options.smartDisplay && value === '') {\n                        // Should set a placeholder for event binding correct fieldIndex\n                        text = '<div class=\"card-view\"></div>';\n                    }\n                }\n\n                html.push(text);\n            });\n\n            if (this.options.cardView) {\n                html.push('</div></td>');\n            }\n\n            html.push('</tr>');\n        }\n\n        // show no records\n        if (!html.length) {\n            html.push('<tr class=\"no-records-found\">',\n                sprintf('<td colspan=\"%s\">%s</td>',\n                    this.$header.find('th').length, this.options.formatNoMatches()),\n                '</tr>');\n        }\n\n        this.$body.html(html.join(''));\n\n        if (!fixedScroll) {\n            this.scrollTo(0);\n        }\n\n        // click to select by column\n        this.$body.find('> tr[data-index] > td').off('click dblclick').on('click dblclick', function (e) {\n            var $td = $(this),\n                $tr = $td.parent(),\n                item = that.data[$tr.data('index')],\n                index = $td[0].cellIndex,\n                fields = that.getVisibleFields(),\n                field = fields[that.options.detailView && !that.options.cardView ? index - 1 : index],\n                column = that.columns[getFieldIndex(that.columns, field)],\n                value = getItemField(item, field, that.options.escape);\n\n            if ($td.find('.detail-icon').length) {\n                return;\n            }\n\n            that.trigger(e.type === 'click' ? 'click-cell' : 'dbl-click-cell', field, value, item, $td);\n            that.trigger(e.type === 'click' ? 'click-row' : 'dbl-click-row', item, $tr, field);\n\n            // if click to select - then trigger the checkbox/radio click\n            if (e.type === 'click' && that.options.clickToSelect && column.clickToSelect) {\n                var $selectItem = $tr.find(sprintf('[name=\"%s\"]', that.options.selectItemName));\n                if ($selectItem.length) {\n                    $selectItem[0].click(); // #144: .trigger('click') bug\n                }\n            }\n        });\n\n        this.$body.find('> tr[data-index] > td > .detail-icon').off('click').on('click', function () {\n            var $this = $(this),\n                $tr = $this.parent().parent(),\n                index = $tr.data('index'),\n                row = data[index]; // Fix #980 Detail view, when searching, returns wrong row\n\n            // remove and update\n            if ($tr.next().is('tr.detail-view')) {\n                $this.find('i').attr('class', sprintf('%s %s', that.options.iconsPrefix, that.options.icons.detailOpen));\n                $tr.next().remove();\n                that.trigger('collapse-row', index, row);\n            } else {\n                $this.find('i').attr('class', sprintf('%s %s', that.options.iconsPrefix, that.options.icons.detailClose));\n                $tr.after(sprintf('<tr class=\"detail-view\"><td colspan=\"%s\"></td></tr>', $tr.find('td').length));\n                var $element = $tr.next().find('td');\n                var content = calculateObjectValue(that.options, that.options.detailFormatter, [index, row, $element], '');\n                if($element.length === 1) {\n                    $element.append(content);\n                }\n                that.trigger('expand-row', index, row, $element);\n            }\n            that.resetView();\n        });\n\n        this.$selectItem = this.$body.find(sprintf('[name=\"%s\"]', this.options.selectItemName));\n        this.$selectItem.off('click').on('click', function (event) {\n            event.stopImmediatePropagation();\n\n            var $this = $(this),\n                checked = $this.prop('checked'),\n                row = that.data[$this.data('index')];\n\n            if (that.options.maintainSelected && $(this).is(':radio')) {\n                $.each(that.options.data, function (i, row) {\n                    row[that.header.stateField] = false;\n                });\n            }\n\n            row[that.header.stateField] = checked;\n\n            if (that.options.singleSelect) {\n                that.$selectItem.not(this).each(function () {\n                    that.data[$(this).data('index')][that.header.stateField] = false;\n                });\n                that.$selectItem.filter(':checked').not(this).prop('checked', false);\n            }\n\n            that.updateSelected();\n            that.trigger(checked ? 'check' : 'uncheck', row, $this);\n        });\n\n        $.each(this.header.events, function (i, events) {\n            if (!events) {\n                return;\n            }\n            // fix bug, if events is defined with namespace\n            if (typeof events === 'string') {\n                events = calculateObjectValue(null, events);\n            }\n\n            var field = that.header.fields[i],\n                fieldIndex = $.inArray(field, that.getVisibleFields());\n\n            if (that.options.detailView && !that.options.cardView) {\n                fieldIndex += 1;\n            }\n\n            for (var key in events) {\n                that.$body.find('>tr:not(.no-records-found)').each(function () {\n                    var $tr = $(this),\n                        $td = $tr.find(that.options.cardView ? '.card-view' : 'td').eq(fieldIndex),\n                        index = key.indexOf(' '),\n                        name = key.substring(0, index),\n                        el = key.substring(index + 1),\n                        func = events[key];\n\n                    $td.find(el).off(name).on(name, function (e) {\n                        var index = $tr.data('index'),\n                            row = that.data[index],\n                            value = row[field];\n\n                        func.apply(this, [e, value, row, index]);\n                    });\n                });\n            }\n        });\n\n        this.updateSelected();\n        this.resetView();\n\n        this.trigger('post-body', data);\n    };\n\n    BootstrapTable.prototype.initServer = function (silent, query, url) {\n        var that = this,\n            data = {},\n            params = {\n                searchText: this.searchText,\n                sortName: this.options.sortName,\n                sortOrder: this.options.sortOrder\n            },\n            request;\n\n        if (this.options.pagination) {\n            params.pageSize = this.options.pageSize === this.options.formatAllRows() ?\n                this.options.totalRows : this.options.pageSize;\n            params.pageNumber = this.options.pageNumber;\n        }\n\n        if (!(url || this.options.url) && !this.options.ajax) {\n            return;\n        }\n\n        if (this.options.queryParamsType === 'limit') {\n            params = {\n                search: params.searchText,\n                sort: params.sortName,\n                order: params.sortOrder\n            };\n\n            if (this.options.pagination) {\n                params.offset = this.options.pageSize === this.options.formatAllRows() ?\n                    0 : this.options.pageSize * (this.options.pageNumber - 1);\n                params.limit = this.options.pageSize === this.options.formatAllRows() ?\n                    this.options.totalRows : this.options.pageSize;\n            }\n        }\n\n        if (!($.isEmptyObject(this.filterColumnsPartial))) {\n            params.filter = JSON.stringify(this.filterColumnsPartial, null);\n        }\n\n        data = calculateObjectValue(this.options, this.options.queryParams, [params], data);\n\n        $.extend(data, query || {});\n\n        // false to stop request\n        if (data === false) {\n            return;\n        }\n\n        if (!silent) {\n            this.$tableLoading.show();\n        }\n        request = $.extend({}, calculateObjectValue(null, this.options.ajaxOptions), {\n            type: this.options.method,\n            url:  url || this.options.url,\n            data: this.options.contentType === 'application/json' && this.options.method === 'post' ?\n                JSON.stringify(data) : data,\n            cache: this.options.cache,\n            contentType: this.options.contentType,\n            dataType: this.options.dataType,\n            success: function (res) {\n                res = calculateObjectValue(that.options, that.options.responseHandler, [res], res);\n\n                that.load(res);\n                that.trigger('load-success', res);\n                if (!silent) that.$tableLoading.hide();\n            },\n            error: function (res) {\n                that.trigger('load-error', res.status, res);\n                if (!silent) that.$tableLoading.hide();\n            }\n        });\n\n        if (this.options.ajax) {\n            calculateObjectValue(this, this.options.ajax, [request], null);\n        } else {\n            if (this._xhr && this._xhr.readyState !== 4) {\n                this._xhr.abort();\n            }\n            this._xhr = $.ajax(request);\n        }\n    };\n\n    BootstrapTable.prototype.initSearchText = function () {\n        if (this.options.search) {\n            if (this.options.searchText !== '') {\n                var $search = this.$toolbar.find('.search input');\n                $search.val(this.options.searchText);\n                this.onSearch({currentTarget: $search});\n            }\n        }\n    };\n\n    BootstrapTable.prototype.getCaret = function () {\n        var that = this;\n\n        $.each(this.$header.find('th'), function (i, th) {\n            $(th).find('.sortable').removeClass('desc asc').addClass($(th).data('field') === that.options.sortName ? that.options.sortOrder : 'both');\n        });\n    };\n\n    BootstrapTable.prototype.updateSelected = function () {\n        var checkAll = this.$selectItem.filter(':enabled').length &&\n            this.$selectItem.filter(':enabled').length ===\n            this.$selectItem.filter(':enabled').filter(':checked').length;\n\n        this.$selectAll.add(this.$selectAll_).prop('checked', checkAll);\n\n        this.$selectItem.each(function () {\n            $(this).closest('tr')[$(this).prop('checked') ? 'addClass' : 'removeClass']('selected');\n        });\n    };\n\n    BootstrapTable.prototype.updateRows = function () {\n        var that = this;\n\n        this.$selectItem.each(function () {\n            that.data[$(this).data('index')][that.header.stateField] = $(this).prop('checked');\n        });\n    };\n\n    BootstrapTable.prototype.resetRows = function () {\n        var that = this;\n\n        $.each(this.data, function (i, row) {\n            that.$selectAll.prop('checked', false);\n            that.$selectItem.prop('checked', false);\n            if (that.header.stateField) {\n                row[that.header.stateField] = false;\n            }\n        });\n    };\n\n    BootstrapTable.prototype.trigger = function (name) {\n        var args = Array.prototype.slice.call(arguments, 1);\n\n        name += '.bs.table';\n        this.options[BootstrapTable.EVENTS[name]].apply(this.options, args);\n        this.$el.trigger($.Event(name), args);\n\n        this.options.onAll(name, args);\n        this.$el.trigger($.Event('all.bs.table'), [name, args]);\n    };\n\n    BootstrapTable.prototype.resetHeader = function () {\n        // fix #61: the hidden table reset header bug.\n        // fix bug: get $el.css('width') error sometime (height = 500)\n        clearTimeout(this.timeoutId_);\n        this.timeoutId_ = setTimeout($.proxy(this.fitHeader, this), this.$el.is(':hidden') ? 100 : 0);\n    };\n\n    BootstrapTable.prototype.fitHeader = function () {\n        var that = this,\n            fixedBody,\n            scrollWidth,\n            focused,\n            focusedTemp;\n\n        if (that.$el.is(':hidden')) {\n            that.timeoutId_ = setTimeout($.proxy(that.fitHeader, that), 100);\n            return;\n        }\n        fixedBody = this.$tableBody.get(0);\n\n        scrollWidth = fixedBody.scrollWidth > fixedBody.clientWidth &&\n        fixedBody.scrollHeight > fixedBody.clientHeight + this.$header.outerHeight() ?\n            getScrollBarWidth() : 0;\n\n        this.$el.css('margin-top', -this.$header.outerHeight());\n\n        focused = $(':focus');\n        if (focused.length > 0) {\n            var $th = focused.parents('th');\n            if ($th.length > 0) {\n                var dataField = $th.attr('data-field');\n                if (dataField !== undefined) {\n                    var $headerTh = this.$header.find(\"[data-field='\" + dataField + \"']\");\n                    if ($headerTh.length > 0) {\n                        $headerTh.find(\":input\").addClass(\"focus-temp\");\n                    }\n                }\n            }\n        }\n\n        this.$header_ = this.$header.clone(true, true);\n        this.$selectAll_ = this.$header_.find('[name=\"btSelectAll\"]');\n        this.$tableHeader.css({\n            'margin-right': scrollWidth\n        }).find('table').css('width', this.$el.outerWidth())\n            .html('').attr('class', this.$el.attr('class'))\n            .append(this.$header_);\n\n\n        focusedTemp = $('.focus-temp:visible:eq(0)');\n        if (focusedTemp.length > 0) {\n            focusedTemp.focus();\n            this.$header.find('.focus-temp').removeClass('focus-temp');\n        }\n\n        // fix bug: $.data() is not working as expected after $.append()\n        this.$header.find('th[data-field]').each(function (i) {\n            that.$header_.find(sprintf('th[data-field=\"%s\"]', $(this).data('field'))).data($(this).data());\n        });\n\n        var visibleFields = this.getVisibleFields(),\n            $ths = this.$header_.find('th');\n\n        this.$body.find('>tr:first-child:not(.no-records-found) > *').each(function (i) {\n            var $this = $(this),\n                index = i;\n\n            if (that.options.detailView && !that.options.cardView) {\n                if (i === 0) {\n                    that.$header_.find('th.detail').find('.fht-cell').width($this.innerWidth());\n                }\n                index = i - 1;\n            }\n\n            var $th = that.$header_.find(sprintf('th[data-field=\"%s\"]', visibleFields[index]));\n            if ($th.length > 1) {\n                $th = $($ths[$this[0].cellIndex]);\n            }\n\n            $th.find('.fht-cell').width($this.innerWidth());\n        });\n        // horizontal scroll event\n        // TODO: it's probably better improving the layout than binding to scroll event\n        this.$tableBody.off('scroll').on('scroll', function () {\n            that.$tableHeader.scrollLeft($(this).scrollLeft());\n\n            if (that.options.showFooter && !that.options.cardView) {\n                that.$tableFooter.scrollLeft($(this).scrollLeft());\n            }\n        });\n        that.trigger('post-header');\n    };\n\n    BootstrapTable.prototype.resetFooter = function () {\n        var that = this,\n            data = that.getData(),\n            html = [];\n\n        if (!this.options.showFooter || this.options.cardView) { //do nothing\n            return;\n        }\n\n        if (!this.options.cardView && this.options.detailView) {\n            html.push('<td><div class=\"th-inner\">&nbsp;</div><div class=\"fht-cell\"></div></td>');\n        }\n\n        $.each(this.columns, function (i, column) {\n            var key,\n                falign = '', // footer align style\n                valign = '',\n                csses = [],\n                style = {},\n                class_ = sprintf(' class=\"%s\"', column['class']);\n\n            if (!column.visible) {\n                return;\n            }\n\n            if (that.options.cardView && (!column.cardVisible)) {\n                return;\n            }\n\n            falign = sprintf('text-align: %s; ', column.falign ? column.falign : column.align);\n            valign = sprintf('vertical-align: %s; ', column.valign);\n\n            style = calculateObjectValue(null, that.options.footerStyle);\n\n            if (style && style.css) {\n                for (key in style.css) {\n                    csses.push(key + ': ' + style.css[key]);\n                }\n            }\n\n            html.push('<td', class_, sprintf(' style=\"%s\"', falign + valign + csses.concat().join('; ')), '>');\n            html.push('<div class=\"th-inner\">');\n\n            html.push(calculateObjectValue(column, column.footerFormatter, [data], '&nbsp;') || '&nbsp;');\n\n            html.push('</div>');\n            html.push('<div class=\"fht-cell\"></div>');\n            html.push('</div>');\n            html.push('</td>');\n        });\n\n        this.$tableFooter.find('tr').html(html.join(''));\n        this.$tableFooter.show();\n        clearTimeout(this.timeoutFooter_);\n        this.timeoutFooter_ = setTimeout($.proxy(this.fitFooter, this),\n            this.$el.is(':hidden') ? 100 : 0);\n    };\n\n    BootstrapTable.prototype.fitFooter = function () {\n        var that = this,\n            $footerTd,\n            elWidth,\n            scrollWidth;\n\n        clearTimeout(this.timeoutFooter_);\n        if (this.$el.is(':hidden')) {\n            this.timeoutFooter_ = setTimeout($.proxy(this.fitFooter, this), 100);\n            return;\n        }\n\n        elWidth = this.$el.css('width');\n        scrollWidth = elWidth > this.$tableBody.width() ? getScrollBarWidth() : 0;\n\n        this.$tableFooter.css({\n            'margin-right': scrollWidth\n        }).find('table').css('width', elWidth)\n            .attr('class', this.$el.attr('class'));\n\n        $footerTd = this.$tableFooter.find('td');\n\n        this.$body.find('>tr:first-child:not(.no-records-found) > *').each(function (i) {\n            var $this = $(this);\n\n            $footerTd.eq(i).find('.fht-cell').width($this.innerWidth());\n        });\n    };\n\n    BootstrapTable.prototype.toggleColumn = function (index, checked, needUpdate) {\n        if (index === -1) {\n            return;\n        }\n        this.columns[index].visible = checked;\n        this.initHeader();\n        this.initSearch();\n        this.initPagination();\n        this.initBody();\n\n        if (this.options.showColumns) {\n            var $items = this.$toolbar.find('.keep-open input').prop('disabled', false);\n\n            if (needUpdate) {\n                $items.filter(sprintf('[value=\"%s\"]', index)).prop('checked', checked);\n            }\n\n            if ($items.filter(':checked').length <= this.options.minimumCountColumns) {\n                $items.filter(':checked').prop('disabled', true);\n            }\n        }\n    };\n\n    BootstrapTable.prototype.toggleRow = function (index, uniqueId, visible) {\n        if (index === -1) {\n            return;\n        }\n\n        this.$body.find(typeof index !== 'undefined' ?\n            sprintf('tr[data-index=\"%s\"]', index) :\n            sprintf('tr[data-uniqueid=\"%s\"]', uniqueId))\n            [visible ? 'show' : 'hide']();\n    };\n\n    BootstrapTable.prototype.getVisibleFields = function () {\n        var that = this,\n            visibleFields = [];\n\n        $.each(this.header.fields, function (j, field) {\n            var column = that.columns[getFieldIndex(that.columns, field)];\n\n            if (!column.visible) {\n                return;\n            }\n            visibleFields.push(field);\n        });\n        return visibleFields;\n    };\n\n    // PUBLIC FUNCTION DEFINITION\n    // =======================\n\n    BootstrapTable.prototype.resetView = function (params) {\n        var padding = 0;\n\n        if (params && params.height) {\n            this.options.height = params.height;\n        }\n\n        this.$selectAll.prop('checked', this.$selectItem.length > 0 &&\n            this.$selectItem.length === this.$selectItem.filter(':checked').length);\n\n        if (this.options.height) {\n            var toolbarHeight = getRealHeight(this.$toolbar),\n                paginationHeight = getRealHeight(this.$pagination),\n                height = this.options.height - toolbarHeight - paginationHeight;\n\n            this.$tableContainer.css('height', height + 'px');\n        }\n\n        if (this.options.cardView) {\n            // remove the element css\n            this.$el.css('margin-top', '0');\n            this.$tableContainer.css('padding-bottom', '0');\n            this.$tableFooter.hide();\n            return;\n        }\n\n        if (this.options.showHeader && this.options.height) {\n            this.$tableHeader.show();\n            this.resetHeader();\n            padding += this.$header.outerHeight();\n        } else {\n            this.$tableHeader.hide();\n            this.trigger('post-header');\n        }\n\n        if (this.options.showFooter) {\n            this.resetFooter();\n            if (this.options.height) {\n                padding += this.$tableFooter.outerHeight() + 1;\n            }\n        }\n\n        // Assign the correct sortable arrow\n        this.getCaret();\n        this.$tableContainer.css('padding-bottom', padding + 'px');\n        this.trigger('reset-view');\n    };\n\n    BootstrapTable.prototype.getData = function (useCurrentPage) {\n        return (this.searchText || !$.isEmptyObject(this.filterColumns) || !$.isEmptyObject(this.filterColumnsPartial)) ?\n            (useCurrentPage ? this.data.slice(this.pageFrom - 1, this.pageTo) : this.data) :\n            (useCurrentPage ? this.options.data.slice(this.pageFrom - 1, this.pageTo) : this.options.data);\n    };\n\n    BootstrapTable.prototype.load = function (data) {\n        var fixedScroll = false;\n\n        // #431: support pagination\n        if (this.options.sidePagination === 'server') {\n            this.options.totalRows = data.total;\n            fixedScroll = data.fixedScroll;\n            data = data[this.options.dataField];\n        } else if (!$.isArray(data)) { // support fixedScroll\n            fixedScroll = data.fixedScroll;\n            data = data.data;\n        }\n\n        this.initData(data);\n        this.initSearch();\n        this.initPagination();\n        this.initBody(fixedScroll);\n    };\n\n    BootstrapTable.prototype.append = function (data) {\n        this.initData(data, 'append');\n        this.initSearch();\n        this.initPagination();\n        this.initSort();\n        this.initBody(true);\n    };\n\n    BootstrapTable.prototype.prepend = function (data) {\n        this.initData(data, 'prepend');\n        this.initSearch();\n        this.initPagination();\n        this.initSort();\n        this.initBody(true);\n    };\n\n    BootstrapTable.prototype.remove = function (params) {\n        var len = this.options.data.length,\n            i, row;\n\n        if (!params.hasOwnProperty('field') || !params.hasOwnProperty('values')) {\n            return;\n        }\n\n        for (i = len - 1; i >= 0; i--) {\n            row = this.options.data[i];\n\n            if (!row.hasOwnProperty(params.field)) {\n                continue;\n            }\n            if ($.inArray(row[params.field], params.values) !== -1) {\n                this.options.data.splice(i, 1);\n            }\n        }\n\n        if (len === this.options.data.length) {\n            return;\n        }\n\n        this.initSearch();\n        this.initPagination();\n        this.initSort();\n        this.initBody(true);\n    };\n\n    BootstrapTable.prototype.removeAll = function () {\n        if (this.options.data.length > 0) {\n            this.options.data.splice(0, this.options.data.length);\n            this.initSearch();\n            this.initPagination();\n            this.initBody(true);\n        }\n    };\n\n    BootstrapTable.prototype.getRowByUniqueId = function (id) {\n        var uniqueId = this.options.uniqueId,\n            len = this.options.data.length,\n            dataRow = null,\n            i, row, rowUniqueId;\n\n        for (i = len - 1; i >= 0; i--) {\n            row = this.options.data[i];\n\n            if (row.hasOwnProperty(uniqueId)) { // uniqueId is a column\n                rowUniqueId = row[uniqueId];\n            } else if(row._data.hasOwnProperty(uniqueId)) { // uniqueId is a row data property\n                rowUniqueId = row._data[uniqueId];\n            } else {\n                continue;\n            }\n\n            if (typeof rowUniqueId === 'string') {\n                id = id.toString();\n            } else if (typeof rowUniqueId === 'number') {\n                if ((Number(rowUniqueId) === rowUniqueId) && (rowUniqueId % 1 === 0)) {\n                    id = parseInt(id);\n                } else if ((rowUniqueId === Number(rowUniqueId)) && (rowUniqueId !== 0)) {\n                    id = parseFloat(id);\n                }\n            }\n\n            if (rowUniqueId === id) {\n                dataRow = row;\n                break;\n            }\n        }\n\n        return dataRow;\n    };\n\n    BootstrapTable.prototype.removeByUniqueId = function (id) {\n        var len = this.options.data.length,\n            row = this.getRowByUniqueId(id);\n\n        if (row) {\n            this.options.data.splice(this.options.data.indexOf(row), 1);\n        }\n\n        if (len === this.options.data.length) {\n            return;\n        }\n\n        this.initSearch();\n        this.initPagination();\n        this.initBody(true);\n    };\n\n    BootstrapTable.prototype.updateByUniqueId = function (params) {\n        var that = this;\n        var allParams = $.isArray(params) ? params : [ params ];\n\n        $.each(allParams, function(i, params) {\n            var rowId;\n\n            if (!params.hasOwnProperty('id') || !params.hasOwnProperty('row')) {\n                return;\n            }\n\n            rowId = $.inArray(that.getRowByUniqueId(params.id), that.options.data);\n\n            if (rowId === -1) {\n                return;\n            }\n            $.extend(that.options.data[rowId], params.row);\n        });\n\n        this.initSearch();\n        this.initSort();\n        this.initBody(true);\n    };\n\n    BootstrapTable.prototype.insertRow = function (params) {\n        if (!params.hasOwnProperty('index') || !params.hasOwnProperty('row')) {\n            return;\n        }\n        this.data.splice(params.index, 0, params.row);\n        this.initSearch();\n        this.initPagination();\n        this.initSort();\n        this.initBody(true);\n    };\n\n    BootstrapTable.prototype.updateRow = function (params) {\n        var that = this;\n        var allParams = $.isArray(params) ? params : [ params ];\n\n        $.each(allParams, function(i, params) {\n            if (!params.hasOwnProperty('index') || !params.hasOwnProperty('row')) {\n                return;\n            }\n            $.extend(that.options.data[params.index], params.row);\n        });\n\n        this.initSearch();\n        this.initSort();\n        this.initBody(true);\n    };\n\n    BootstrapTable.prototype.showRow = function (params) {\n        if (!params.hasOwnProperty('index') && !params.hasOwnProperty('uniqueId')) {\n            return;\n        }\n        this.toggleRow(params.index, params.uniqueId, true);\n    };\n\n    BootstrapTable.prototype.hideRow = function (params) {\n        if (!params.hasOwnProperty('index') && !params.hasOwnProperty('uniqueId')) {\n            return;\n        }\n        this.toggleRow(params.index, params.uniqueId, false);\n    };\n\n    BootstrapTable.prototype.getRowsHidden = function (show) {\n        var rows = $(this.$body[0]).children().filter(':hidden'),\n            i = 0;\n        if (show) {\n            for (; i < rows.length; i++) {\n                $(rows[i]).show();\n            }\n        }\n        return rows;\n    };\n\n    BootstrapTable.prototype.mergeCells = function (options) {\n        var row = options.index,\n            col = $.inArray(options.field, this.getVisibleFields()),\n            rowspan = options.rowspan || 1,\n            colspan = options.colspan || 1,\n            i, j,\n            $tr = this.$body.find('>tr'),\n            $td;\n\n        if (this.options.detailView && !this.options.cardView) {\n            col += 1;\n        }\n\n        $td = $tr.eq(row).find('>td').eq(col);\n\n        if (row < 0 || col < 0 || row >= this.data.length) {\n            return;\n        }\n\n        for (i = row; i < row + rowspan; i++) {\n            for (j = col; j < col + colspan; j++) {\n                $tr.eq(i).find('>td').eq(j).hide();\n            }\n        }\n\n        $td.attr('rowspan', rowspan).attr('colspan', colspan).show();\n    };\n\n    BootstrapTable.prototype.updateCell = function (params) {\n        if (!params.hasOwnProperty('index') ||\n            !params.hasOwnProperty('field') ||\n            !params.hasOwnProperty('value')) {\n            return;\n        }\n        this.data[params.index][params.field] = params.value;\n\n        if (params.reinit === false) {\n            return;\n        }\n        this.initSort();\n        this.initBody(true);\n    };\n\n    BootstrapTable.prototype.getOptions = function () {\n        return this.options;\n    };\n\n    BootstrapTable.prototype.getSelections = function () {\n        var that = this;\n\n        return $.grep(this.options.data, function (row) {\n            return row[that.header.stateField];\n        });\n    };\n\n    BootstrapTable.prototype.getAllSelections = function () {\n        var that = this;\n\n        return $.grep(this.options.data, function (row) {\n            return row[that.header.stateField];\n        });\n    };\n\n    BootstrapTable.prototype.checkAll = function () {\n        this.checkAll_(true);\n    };\n\n    BootstrapTable.prototype.uncheckAll = function () {\n        this.checkAll_(false);\n    };\n\n    BootstrapTable.prototype.checkInvert = function () {\n        var that = this;\n        var rows = that.$selectItem.filter(':enabled');\n        var checked = rows.filter(':checked');\n        rows.each(function() {\n            $(this).prop('checked', !$(this).prop('checked'));\n        });\n        that.updateRows();\n        that.updateSelected();\n        that.trigger('uncheck-some', checked);\n        checked = that.getSelections();\n        that.trigger('check-some', checked);\n    };\n\n    BootstrapTable.prototype.checkAll_ = function (checked) {\n        var rows;\n        if (!checked) {\n            rows = this.getSelections();\n        }\n        this.$selectAll.add(this.$selectAll_).prop('checked', checked);\n        this.$selectItem.filter(':enabled').prop('checked', checked);\n        this.updateRows();\n        if (checked) {\n            rows = this.getSelections();\n        }\n        this.trigger(checked ? 'check-all' : 'uncheck-all', rows);\n    };\n\n    BootstrapTable.prototype.check = function (index) {\n        this.check_(true, index);\n    };\n\n    BootstrapTable.prototype.uncheck = function (index) {\n        this.check_(false, index);\n    };\n\n    BootstrapTable.prototype.check_ = function (checked, index) {\n        var $el = this.$selectItem.filter(sprintf('[data-index=\"%s\"]', index)).prop('checked', checked);\n        this.data[index][this.header.stateField] = checked;\n        this.updateSelected();\n        this.trigger(checked ? 'check' : 'uncheck', this.data[index], $el);\n    };\n\n    BootstrapTable.prototype.checkBy = function (obj) {\n        this.checkBy_(true, obj);\n    };\n\n    BootstrapTable.prototype.uncheckBy = function (obj) {\n        this.checkBy_(false, obj);\n    };\n\n    BootstrapTable.prototype.checkBy_ = function (checked, obj) {\n        if (!obj.hasOwnProperty('field') || !obj.hasOwnProperty('values')) {\n            return;\n        }\n\n        var that = this,\n            rows = [];\n        $.each(this.options.data, function (index, row) {\n            if (!row.hasOwnProperty(obj.field)) {\n                return false;\n            }\n            if ($.inArray(row[obj.field], obj.values) !== -1) {\n                var $el = that.$selectItem.filter(':enabled')\n                    .filter(sprintf('[data-index=\"%s\"]', index)).prop('checked', checked);\n                row[that.header.stateField] = checked;\n                rows.push(row);\n                that.trigger(checked ? 'check' : 'uncheck', row, $el);\n            }\n        });\n        this.updateSelected();\n        this.trigger(checked ? 'check-some' : 'uncheck-some', rows);\n    };\n\n    BootstrapTable.prototype.destroy = function () {\n        this.$el.insertBefore(this.$container);\n        $(this.options.toolbar).insertBefore(this.$el);\n        this.$container.next().remove();\n        this.$container.remove();\n        this.$el.html(this.$el_.html())\n            .css('margin-top', '0')\n            .attr('class', this.$el_.attr('class') || ''); // reset the class\n    };\n\n    BootstrapTable.prototype.showLoading = function () {\n        this.$tableLoading.show();\n    };\n\n    BootstrapTable.prototype.hideLoading = function () {\n        this.$tableLoading.hide();\n    };\n\n    BootstrapTable.prototype.togglePagination = function () {\n        this.options.pagination = !this.options.pagination;\n        var button = this.$toolbar.find('button[name=\"paginationSwitch\"] i');\n        if (this.options.pagination) {\n            button.attr(\"class\", this.options.iconsPrefix + \" \" + this.options.icons.paginationSwitchDown);\n        } else {\n            button.attr(\"class\", this.options.iconsPrefix + \" \" + this.options.icons.paginationSwitchUp);\n        }\n        this.updatePagination();\n    };\n\n    BootstrapTable.prototype.refresh = function (params) {\n        if (params && params.url) {\n            this.options.pageNumber = 1;\n        }\n        this.initServer(params && params.silent,\n            params && params.query, params && params.url);\n        this.trigger('refresh', params);\n    };\n\n    BootstrapTable.prototype.resetWidth = function () {\n        if (this.options.showHeader && this.options.height) {\n            this.fitHeader();\n        }\n        if (this.options.showFooter) {\n            this.fitFooter();\n        }\n    };\n\n    BootstrapTable.prototype.showColumn = function (field) {\n        this.toggleColumn(getFieldIndex(this.columns, field), true, true);\n    };\n\n    BootstrapTable.prototype.hideColumn = function (field) {\n        this.toggleColumn(getFieldIndex(this.columns, field), false, true);\n    };\n\n    BootstrapTable.prototype.getHiddenColumns = function () {\n        return $.grep(this.columns, function (column) {\n            return !column.visible;\n        });\n    };\n\n    BootstrapTable.prototype.getVisibleColumns = function () {\n        return $.grep(this.columns, function (column) {\n            return column.visible;\n        });\n    };\n\n    BootstrapTable.prototype.toggleAllColumns = function (visible) {\n        $.each(this.columns, function (i, column) {\n            this.columns[i].visible = visible;\n        });\n\n        this.initHeader();\n        this.initSearch();\n        this.initPagination();\n        this.initBody();\n        if (this.options.showColumns) {\n            var $items = this.$toolbar.find('.keep-open input').prop('disabled', false);\n\n            if ($items.filter(':checked').length <= this.options.minimumCountColumns) {\n                $items.filter(':checked').prop('disabled', true);\n            }\n        }\n    };\n\n    BootstrapTable.prototype.showAllColumns = function () {\n        this.toggleAllColumns(true);\n    };\n\n    BootstrapTable.prototype.hideAllColumns = function () {\n        this.toggleAllColumns(false);\n    };\n\n    BootstrapTable.prototype.filterBy = function (columns) {\n        this.filterColumns = $.isEmptyObject(columns) ? {} : columns;\n        this.options.pageNumber = 1;\n        this.initSearch();\n        this.updatePagination();\n    };\n\n    BootstrapTable.prototype.scrollTo = function (value) {\n        if (typeof value === 'string') {\n            value = value === 'bottom' ? this.$tableBody[0].scrollHeight : 0;\n        }\n        if (typeof value === 'number') {\n            this.$tableBody.scrollTop(value);\n        }\n        if (typeof value === 'undefined') {\n            return this.$tableBody.scrollTop();\n        }\n    };\n\n    BootstrapTable.prototype.getScrollPosition = function () {\n        return this.scrollTo();\n    };\n\n    BootstrapTable.prototype.selectPage = function (page) {\n        if (page > 0 && page <= this.options.totalPages) {\n            this.options.pageNumber = page;\n            this.updatePagination();\n        }\n    };\n\n    BootstrapTable.prototype.prevPage = function () {\n        if (this.options.pageNumber > 1) {\n            this.options.pageNumber--;\n            this.updatePagination();\n        }\n    };\n\n    BootstrapTable.prototype.nextPage = function () {\n        if (this.options.pageNumber < this.options.totalPages) {\n            this.options.pageNumber++;\n            this.updatePagination();\n        }\n    };\n\n    BootstrapTable.prototype.toggleView = function () {\n        this.options.cardView = !this.options.cardView;\n        this.initHeader();\n        // Fixed remove toolbar when click cardView button.\n        //that.initToolbar();\n        this.initBody();\n        this.trigger('toggle', this.options.cardView);\n    };\n\n    BootstrapTable.prototype.refreshOptions = function (options) {\n        //If the objects are equivalent then avoid the call of destroy / init methods\n        if (compareObjects(this.options, options, true)) {\n            return;\n        }\n        this.options = $.extend(this.options, options);\n        this.trigger('refresh-options', this.options);\n        this.destroy();\n        this.init();\n    };\n\n    BootstrapTable.prototype.resetSearch = function (text) {\n        var $search = this.$toolbar.find('.search input');\n        $search.val(text || '');\n        this.onSearch({currentTarget: $search});\n    };\n\n    BootstrapTable.prototype.expandRow_ = function (expand, index) {\n        var $tr = this.$body.find(sprintf('> tr[data-index=\"%s\"]', index));\n        if ($tr.next().is('tr.detail-view') === (expand ? false : true)) {\n            $tr.find('> td > .detail-icon').click();\n        }\n    };\n\n    BootstrapTable.prototype.expandRow = function (index) {\n        this.expandRow_(true, index);\n    };\n\n    BootstrapTable.prototype.collapseRow = function (index) {\n        this.expandRow_(false, index);\n    };\n\n    BootstrapTable.prototype.expandAllRows = function (isSubTable) {\n        if (isSubTable) {\n            var $tr = this.$body.find(sprintf('> tr[data-index=\"%s\"]', 0)),\n                that = this,\n                detailIcon = null,\n                executeInterval = false,\n                idInterval = -1;\n\n            if (!$tr.next().is('tr.detail-view')) {\n                $tr.find('> td > .detail-icon').click();\n                executeInterval = true;\n            } else if (!$tr.next().next().is('tr.detail-view')) {\n                $tr.next().find(\".detail-icon\").click();\n                executeInterval = true;\n            }\n\n            if (executeInterval) {\n                try {\n                    idInterval = setInterval(function () {\n                        detailIcon = that.$body.find(\"tr.detail-view\").last().find(\".detail-icon\");\n                        if (detailIcon.length > 0) {\n                            detailIcon.click();\n                        } else {\n                            clearInterval(idInterval);\n                        }\n                    }, 1);\n                } catch (ex) {\n                    clearInterval(idInterval);\n                }\n            }\n        } else {\n            var trs = this.$body.children();\n            for (var i = 0; i < trs.length; i++) {\n                this.expandRow_(true, $(trs[i]).data(\"index\"));\n            }\n        }\n    };\n\n    BootstrapTable.prototype.collapseAllRows = function (isSubTable) {\n        if (isSubTable) {\n            this.expandRow_(false, 0);\n        } else {\n            var trs = this.$body.children();\n            for (var i = 0; i < trs.length; i++) {\n                this.expandRow_(false, $(trs[i]).data(\"index\"));\n            }\n        }\n    };\n\n    BootstrapTable.prototype.updateFormatText = function (name, text) {\n        if (this.options[sprintf('format%s', name)]) {\n            if (typeof text === 'string') {\n                this.options[sprintf('format%s', name)] = function () {\n                    return text;\n                };\n            } else if (typeof text === 'function') {\n                this.options[sprintf('format%s', name)] = text;\n            }\n        }\n        this.initToolbar();\n        this.initPagination();\n        this.initBody();\n    };\n\n    // BOOTSTRAP TABLE PLUGIN DEFINITION\n    // =======================\n\n    var allowedMethods = [\n        'getOptions',\n        'getSelections', 'getAllSelections', 'getData',\n        'load', 'append', 'prepend', 'remove', 'removeAll',\n        'insertRow', 'updateRow', 'updateCell', 'updateByUniqueId', 'removeByUniqueId',\n        'getRowByUniqueId', 'showRow', 'hideRow', 'getRowsHidden',\n        'mergeCells',\n        'checkAll', 'uncheckAll', 'checkInvert',\n        'check', 'uncheck',\n        'checkBy', 'uncheckBy',\n        'refresh',\n        'resetView',\n        'resetWidth',\n        'destroy',\n        'showLoading', 'hideLoading',\n        'showColumn', 'hideColumn', 'getHiddenColumns', 'getVisibleColumns',\n        'showAllColumns', 'hideAllColumns',\n        'filterBy',\n        'scrollTo',\n        'getScrollPosition',\n        'selectPage', 'prevPage', 'nextPage',\n        'togglePagination',\n        'toggleView',\n        'refreshOptions',\n        'resetSearch',\n        'expandRow', 'collapseRow', 'expandAllRows', 'collapseAllRows',\n        'updateFormatText'\n    ];\n\n    $.fn.bootstrapTable = function (option) {\n        var value,\n            args = Array.prototype.slice.call(arguments, 1);\n\n        this.each(function () {\n            var $this = $(this),\n                data = $this.data('bootstrap.table'),\n                options = $.extend({}, BootstrapTable.DEFAULTS, $this.data(),\n                    typeof option === 'object' && option);\n\n            if (typeof option === 'string') {\n                if ($.inArray(option, allowedMethods) < 0) {\n                    throw new Error(\"Unknown method: \" + option);\n                }\n\n                if (!data) {\n                    return;\n                }\n\n                value = data[option].apply(data, args);\n\n                if (option === 'destroy') {\n                    $this.removeData('bootstrap.table');\n                }\n            }\n\n            if (!data) {\n                $this.data('bootstrap.table', (data = new BootstrapTable(this, options)));\n            }\n        });\n\n        return typeof value === 'undefined' ? this : value;\n    };\n\n    $.fn.bootstrapTable.Constructor = BootstrapTable;\n    $.fn.bootstrapTable.defaults = BootstrapTable.DEFAULTS;\n    $.fn.bootstrapTable.columnDefaults = BootstrapTable.COLUMN_DEFAULTS;\n    $.fn.bootstrapTable.locales = BootstrapTable.LOCALES;\n    $.fn.bootstrapTable.methods = allowedMethods;\n    $.fn.bootstrapTable.utils = {\n        sprintf: sprintf,\n        getFieldIndex: getFieldIndex,\n        compareObjects: compareObjects,\n        calculateObjectValue: calculateObjectValue,\n        getItemField: getItemField,\n        objectKeys: objectKeys,\n        isIEBrowser: isIEBrowser\n    };\n\n    // BOOTSTRAP TABLE INIT\n    // =======================\n\n    $(function () {\n        $('[data-toggle=\"table\"]').bootstrapTable();\n    });\n})(jQuery);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanMvcGx1Z2lucy9ib290c3RyYXAtdGFibGUvYm9vdHN0cmFwLXRhYmxlLmpzP2FkNDIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLG1CQUFtQix1QkFBdUI7QUFDMUM7QUFDQTs7QUFFQSxtQkFBbUIsb0JBQW9CO0FBQ3ZDO0FBQ0EsdUJBQXVCLGNBQWM7QUFDckM7QUFDQTtBQUNBOztBQUVBLG1CQUFtQixvQkFBb0I7QUFDdkMsdUJBQXVCLHVCQUF1QjtBQUM5QztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwyQkFBMkIsYUFBYTtBQUN4QztBQUNBO0FBQ0EsMkJBQTJCLGFBQWE7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHVCQUF1Qiw4QkFBOEI7QUFDckQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDLG9DQUFvQztBQUNwQyxvQ0FBb0M7QUFDcEMsc0NBQXNDO0FBQ3RDLHNDQUFzQztBQUN0QyxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxpQkFBaUI7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1DQUFtQyxxQkFBcUI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQztBQUNwQyxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DOztBQUVwQztBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhO0FBQ2IsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxzQkFBc0IsaUJBQWlCLE1BQU07O0FBRTdDLDRCQUE0QixnQkFBZ0IsUUFBUTtBQUNwRCxnQ0FBZ0MsZ0JBQWdCO0FBQ2hELHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpREFBaUQ7QUFDakQsZ0RBQWdEO0FBQ2hELG9EQUFvRDtBQUNwRCw0Q0FBNEM7QUFDNUM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSx3Q0FBd0M7QUFDeEM7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhOztBQUViO0FBQ0E7QUFDQSw0Q0FBNEM7QUFDNUM7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLCtCQUErQiwrQkFBK0I7O0FBRTlEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELDJCQUEyQjtBQUMzRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMEJBQTBCLFNBQVM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSx1Q0FBdUMsaUJBQWlCO0FBQ3hEO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLHlGQUF5Rjs7QUFFekY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhGQUE4RjtBQUM5Rjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQztBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQzs7QUFFbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQjtBQUNBLFNBQVM7O0FBRVQ7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxrQ0FBa0M7O0FBRWxDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHVCQUF1QjtBQUN0RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZ0VBQWdFO0FBQ2hFO0FBQ0E7O0FBRUE7QUFDQSx1REFBdUQ7QUFDdkQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLDZDQUE2QztBQUM3QyxpREFBaUQ7O0FBRWpEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsb0dBQW9HO0FBQ3BHOztBQUVBLDBGQUEwRixhQUFhOztBQUV2RztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyw2QkFBNkI7QUFDdEM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSx5QkFBeUIsUUFBUTtBQUNqQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEseUJBQXlCLFFBQVE7QUFDakM7O0FBRUEsK0NBQStDO0FBQy9DO0FBQ0EsYUFBYSw4Q0FBOEM7QUFDM0Q7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGlCQUFpQjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUIsbUJBQW1CO0FBQ3hDLHlCQUF5QixtQkFBbUI7QUFDNUM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRDtBQUMxRDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwwREFBMEQ7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsdUJBQXVCO0FBQzlDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLDJCQUEyQixnQkFBZ0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsMkJBQTJCLGdCQUFnQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQyIsImZpbGUiOiI0OC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGF1dGhvciB6aGl4aW4gd2VuIDx3ZW56aGl4aW4yMDEwQGdtYWlsLmNvbT5cbiAqIHZlcnNpb246IDEuMTEuMFxuICogaHR0cHM6Ly9naXRodWIuY29tL3dlbnpoaXhpbi9ib290c3RyYXAtdGFibGUvXG4gKi9cblxuKGZ1bmN0aW9uICgkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy8gVE9PTFMgREVGSU5JVElPTlxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT1cblxuICAgIHZhciBjYWNoZWRXaWR0aCA9IG51bGw7XG5cbiAgICAvLyBpdCBvbmx5IGRvZXMgJyVzJywgYW5kIHJldHVybiAnJyB3aGVuIGFyZ3VtZW50cyBhcmUgdW5kZWZpbmVkXG4gICAgdmFyIHNwcmludGYgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICAgICAgZmxhZyA9IHRydWUsXG4gICAgICAgICAgICBpID0gMTtcblxuICAgICAgICBzdHIgPSBzdHIucmVwbGFjZSgvJXMvZywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFyZyA9IGFyZ3NbaSsrXTtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmcgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgZmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhcmc7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZmxhZyA/IHN0ciA6ICcnO1xuICAgIH07XG5cbiAgICB2YXIgZ2V0UHJvcGVydHlGcm9tT3RoZXIgPSBmdW5jdGlvbiAobGlzdCwgZnJvbSwgdG8sIHZhbHVlKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSAnJztcbiAgICAgICAgJC5lYWNoKGxpc3QsIGZ1bmN0aW9uIChpLCBpdGVtKSB7XG4gICAgICAgICAgICBpZiAoaXRlbVtmcm9tXSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBpdGVtW3RvXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIHZhciBnZXRGaWVsZEluZGV4ID0gZnVuY3Rpb24gKGNvbHVtbnMsIGZpZWxkKSB7XG4gICAgICAgIHZhciBpbmRleCA9IC0xO1xuXG4gICAgICAgICQuZWFjaChjb2x1bW5zLCBmdW5jdGlvbiAoaSwgY29sdW1uKSB7XG4gICAgICAgICAgICBpZiAoY29sdW1uLmZpZWxkID09PSBmaWVsZCkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICB9O1xuXG4gICAgLy8gaHR0cDovL2pzZmlkZGxlLm5ldC93ZW55aS80N256N2V6OS8zL1xuICAgIHZhciBzZXRGaWVsZEluZGV4ID0gZnVuY3Rpb24gKGNvbHVtbnMpIHtcbiAgICAgICAgdmFyIGksIGosIGssXG4gICAgICAgICAgICB0b3RhbENvbCA9IDAsXG4gICAgICAgICAgICBmbGFnID0gW107XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvbHVtbnNbMF0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRvdGFsQ29sICs9IGNvbHVtbnNbMF1baV0uY29sc3BhbiB8fCAxO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGZsYWdbaV0gPSBbXTtcbiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB0b3RhbENvbDsgaisrKSB7XG4gICAgICAgICAgICAgICAgZmxhZ1tpXVtqXSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBjb2x1bW5zW2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHIgPSBjb2x1bW5zW2ldW2pdLFxuICAgICAgICAgICAgICAgICAgICByb3dzcGFuID0gci5yb3dzcGFuIHx8IDEsXG4gICAgICAgICAgICAgICAgICAgIGNvbHNwYW4gPSByLmNvbHNwYW4gfHwgMSxcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSAkLmluQXJyYXkoZmFsc2UsIGZsYWdbaV0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvbHNwYW4gPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgci5maWVsZEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIC8vIHdoZW4gZmllbGQgaXMgdW5kZWZpbmVkLCB1c2UgaW5kZXggaW5zdGVhZFxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHIuZmllbGQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByLmZpZWxkID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgcm93c3BhbjsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZsYWdbaSArIGtdW2luZGV4XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBjb2xzcGFuOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZmxhZ1tpXVtpbmRleCArIGtdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGdldFNjcm9sbEJhcldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoY2FjaGVkV2lkdGggPT09IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBpbm5lciA9ICQoJzxwLz4nKS5hZGRDbGFzcygnZml4ZWQtdGFibGUtc2Nyb2xsLWlubmVyJyksXG4gICAgICAgICAgICAgICAgb3V0ZXIgPSAkKCc8ZGl2Lz4nKS5hZGRDbGFzcygnZml4ZWQtdGFibGUtc2Nyb2xsLW91dGVyJyksXG4gICAgICAgICAgICAgICAgdzEsIHcyO1xuXG4gICAgICAgICAgICBvdXRlci5hcHBlbmQoaW5uZXIpO1xuICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZChvdXRlcik7XG5cbiAgICAgICAgICAgIHcxID0gaW5uZXJbMF0ub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICBvdXRlci5jc3MoJ292ZXJmbG93JywgJ3Njcm9sbCcpO1xuICAgICAgICAgICAgdzIgPSBpbm5lclswXS5vZmZzZXRXaWR0aDtcblxuICAgICAgICAgICAgaWYgKHcxID09PSB3Mikge1xuICAgICAgICAgICAgICAgIHcyID0gb3V0ZXJbMF0uY2xpZW50V2lkdGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG91dGVyLnJlbW92ZSgpO1xuICAgICAgICAgICAgY2FjaGVkV2lkdGggPSB3MSAtIHcyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYWNoZWRXaWR0aDtcbiAgICB9O1xuXG4gICAgdmFyIGNhbGN1bGF0ZU9iamVjdFZhbHVlID0gZnVuY3Rpb24gKHNlbGYsIG5hbWUsIGFyZ3MsIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICB2YXIgZnVuYyA9IG5hbWU7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgLy8gc3VwcG9ydCBvYmouZnVuYzEuZnVuYzJcbiAgICAgICAgICAgIHZhciBuYW1lcyA9IG5hbWUuc3BsaXQoJy4nKTtcblxuICAgICAgICAgICAgaWYgKG5hbWVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBmdW5jID0gd2luZG93O1xuICAgICAgICAgICAgICAgICQuZWFjaChuYW1lcywgZnVuY3Rpb24gKGksIGYpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVuYyA9IGZ1bmNbZl07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZ1bmMgPSB3aW5kb3dbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuYy5hcHBseShzZWxmLCBhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWZ1bmMgJiYgdHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnICYmIHNwcmludGYuYXBwbHkodGhpcywgW25hbWVdLmNvbmNhdChhcmdzKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBzcHJpbnRmLmFwcGx5KHRoaXMsIFtuYW1lXS5jb25jYXQoYXJncykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgfTtcblxuICAgIHZhciBjb21wYXJlT2JqZWN0cyA9IGZ1bmN0aW9uIChvYmplY3RBLCBvYmplY3RCLCBjb21wYXJlTGVuZ3RoKSB7XG4gICAgICAgIC8vIENyZWF0ZSBhcnJheXMgb2YgcHJvcGVydHkgbmFtZXNcbiAgICAgICAgdmFyIG9iamVjdEFQcm9wZXJ0aWVzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMob2JqZWN0QSksXG4gICAgICAgICAgICBvYmplY3RCUHJvcGVydGllcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iamVjdEIpLFxuICAgICAgICAgICAgcHJvcE5hbWUgPSAnJztcblxuICAgICAgICBpZiAoY29tcGFyZUxlbmd0aCkge1xuICAgICAgICAgICAgLy8gSWYgbnVtYmVyIG9mIHByb3BlcnRpZXMgaXMgZGlmZmVyZW50LCBvYmplY3RzIGFyZSBub3QgZXF1aXZhbGVudFxuICAgICAgICAgICAgaWYgKG9iamVjdEFQcm9wZXJ0aWVzLmxlbmd0aCAhPT0gb2JqZWN0QlByb3BlcnRpZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYmplY3RBUHJvcGVydGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcHJvcE5hbWUgPSBvYmplY3RBUHJvcGVydGllc1tpXTtcblxuICAgICAgICAgICAgLy8gSWYgdGhlIHByb3BlcnR5IGlzIG5vdCBpbiB0aGUgb2JqZWN0IEIgcHJvcGVydGllcywgY29udGludWUgd2l0aCB0aGUgbmV4dCBwcm9wZXJ0eVxuICAgICAgICAgICAgaWYgKCQuaW5BcnJheShwcm9wTmFtZSwgb2JqZWN0QlByb3BlcnRpZXMpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB2YWx1ZXMgb2Ygc2FtZSBwcm9wZXJ0eSBhcmUgbm90IGVxdWFsLCBvYmplY3RzIGFyZSBub3QgZXF1aXZhbGVudFxuICAgICAgICAgICAgICAgIGlmIChvYmplY3RBW3Byb3BOYW1lXSAhPT0gb2JqZWN0Qltwcm9wTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHdlIG1hZGUgaXQgdGhpcyBmYXIsIG9iamVjdHMgYXJlIGNvbnNpZGVyZWQgZXF1aXZhbGVudFxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuXG4gICAgdmFyIGVzY2FwZUhUTUwgPSBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICBpZiAodHlwZW9mIHRleHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICByZXR1cm4gdGV4dFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8mL2csICcmYW1wOycpXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoLzwvZywgJyZsdDsnKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8+L2csICcmZ3Q7JylcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXCIvZywgJyZxdW90OycpXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoLycvZywgJyYjMDM5OycpXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL2AvZywgJyYjeDYwOycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0ZXh0O1xuICAgIH07XG5cbiAgICB2YXIgZ2V0UmVhbEhlaWdodCA9IGZ1bmN0aW9uICgkZWwpIHtcbiAgICAgICAgdmFyIGhlaWdodCA9IDA7XG4gICAgICAgICRlbC5jaGlsZHJlbigpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGhlaWdodCA8ICQodGhpcykub3V0ZXJIZWlnaHQodHJ1ZSkpIHtcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSAkKHRoaXMpLm91dGVySGVpZ2h0KHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGhlaWdodDtcbiAgICB9O1xuXG4gICAgdmFyIGdldFJlYWxEYXRhQXR0ciA9IGZ1bmN0aW9uIChkYXRhQXR0cikge1xuICAgICAgICBmb3IgKHZhciBhdHRyIGluIGRhdGFBdHRyKSB7XG4gICAgICAgICAgICB2YXIgYXV4QXR0ciA9IGF0dHIuc3BsaXQoLyg/PVtBLVpdKS8pLmpvaW4oJy0nKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgaWYgKGF1eEF0dHIgIT09IGF0dHIpIHtcbiAgICAgICAgICAgICAgICBkYXRhQXR0clthdXhBdHRyXSA9IGRhdGFBdHRyW2F0dHJdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhQXR0clthdHRyXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkYXRhQXR0cjtcbiAgICB9O1xuXG4gICAgdmFyIGdldEl0ZW1GaWVsZCA9IGZ1bmN0aW9uIChpdGVtLCBmaWVsZCwgZXNjYXBlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGl0ZW07XG5cbiAgICAgICAgaWYgKHR5cGVvZiBmaWVsZCAhPT0gJ3N0cmluZycgfHwgaXRlbS5oYXNPd25Qcm9wZXJ0eShmaWVsZCkpIHtcbiAgICAgICAgICAgIHJldHVybiBlc2NhcGUgPyBlc2NhcGVIVE1MKGl0ZW1bZmllbGRdKSA6IGl0ZW1bZmllbGRdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcm9wcyA9IGZpZWxkLnNwbGl0KCcuJyk7XG4gICAgICAgIGZvciAodmFyIHAgaW4gcHJvcHMpIHtcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgJiYgdmFsdWVbcHJvcHNbcF1dO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlc2NhcGUgPyBlc2NhcGVIVE1MKHZhbHVlKSA6IHZhbHVlO1xuICAgIH07XG5cbiAgICB2YXIgaXNJRUJyb3dzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAhIShuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJNU0lFIFwiKSA+IDAgfHwgISFuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9UcmlkZW50LipydlxcOjExXFwuLykpO1xuICAgIH07XG5cbiAgICB2YXIgb2JqZWN0S2V5cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gRnJvbSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3Qva2V5c1xuICAgICAgICBpZiAoIU9iamVjdC5rZXlzKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LFxuICAgICAgICAgICAgICAgICAgICBoYXNEb250RW51bUJ1ZyA9ICEoeyB0b1N0cmluZzogbnVsbCB9KS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgndG9TdHJpbmcnKSxcbiAgICAgICAgICAgICAgICAgICAgZG9udEVudW1zID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgJ3RvU3RyaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICd0b0xvY2FsZVN0cmluZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAndmFsdWVPZicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaGFzT3duUHJvcGVydHknLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2lzUHJvdG90eXBlT2YnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdjb25zdHJ1Y3RvcidcbiAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgZG9udEVudW1zTGVuZ3RoID0gZG9udEVudW1zLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnICYmICh0eXBlb2Ygb2JqICE9PSAnZnVuY3Rpb24nIHx8IG9iaiA9PT0gbnVsbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdC5rZXlzIGNhbGxlZCBvbiBub24tb2JqZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gW10sIHByb3AsIGk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChwcm9wIGluIG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHByb3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0RvbnRFbnVtQnVnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZG9udEVudW1zTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGRvbnRFbnVtc1tpXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goZG9udEVudW1zW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSgpKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBCT09UU1RSQVAgVEFCTEUgQ0xBU1MgREVGSU5JVElPTlxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT1cblxuICAgIHZhciBCb290c3RyYXBUYWJsZSA9IGZ1bmN0aW9uIChlbCwgb3B0aW9ucykge1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLiRlbCA9ICQoZWwpO1xuICAgICAgICB0aGlzLiRlbF8gPSB0aGlzLiRlbC5jbG9uZSgpO1xuICAgICAgICB0aGlzLnRpbWVvdXRJZF8gPSAwO1xuICAgICAgICB0aGlzLnRpbWVvdXRGb290ZXJfID0gMDtcblxuICAgICAgICB0aGlzLmluaXQoKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUuREVGQVVMVFMgPSB7XG4gICAgICAgIGNsYXNzZXM6ICd0YWJsZSB0YWJsZS1ob3ZlcicsXG4gICAgICAgIGxvY2FsZTogdW5kZWZpbmVkLFxuICAgICAgICBoZWlnaHQ6IHVuZGVmaW5lZCxcbiAgICAgICAgdW5kZWZpbmVkVGV4dDogJy0nLFxuICAgICAgICBzb3J0TmFtZTogdW5kZWZpbmVkLFxuICAgICAgICBzb3J0T3JkZXI6ICdhc2MnLFxuICAgICAgICBzb3J0U3RhYmxlOiBmYWxzZSxcbiAgICAgICAgc3RyaXBlZDogZmFsc2UsXG4gICAgICAgIGNvbHVtbnM6IFtbXV0sXG4gICAgICAgIGRhdGE6IFtdLFxuICAgICAgICBkYXRhRmllbGQ6ICdyb3dzJyxcbiAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgdXJsOiB1bmRlZmluZWQsXG4gICAgICAgIGFqYXg6IHVuZGVmaW5lZCxcbiAgICAgICAgY2FjaGU6IHRydWUsXG4gICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgIGFqYXhPcHRpb25zOiB7fSxcbiAgICAgICAgcXVlcnlQYXJhbXM6IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgICAgIH0sXG4gICAgICAgIHF1ZXJ5UGFyYW1zVHlwZTogJ2xpbWl0JywgLy8gdW5kZWZpbmVkXG4gICAgICAgIHJlc3BvbnNlSGFuZGxlcjogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSxcbiAgICAgICAgcGFnaW5hdGlvbjogZmFsc2UsXG4gICAgICAgIG9ubHlJbmZvUGFnaW5hdGlvbjogZmFsc2UsXG4gICAgICAgIHNpZGVQYWdpbmF0aW9uOiAnY2xpZW50JywgLy8gY2xpZW50IG9yIHNlcnZlclxuICAgICAgICB0b3RhbFJvd3M6IDAsIC8vIHNlcnZlciBzaWRlIG5lZWQgdG8gc2V0XG4gICAgICAgIHBhZ2VOdW1iZXI6IDEsXG4gICAgICAgIHBhZ2VTaXplOiAxMCxcbiAgICAgICAgcGFnZUxpc3Q6IFsxMCwgMjUsIDUwLCAxMDBdLFxuICAgICAgICBwYWdpbmF0aW9uSEFsaWduOiAncmlnaHQnLCAvL3JpZ2h0LCBsZWZ0XG4gICAgICAgIHBhZ2luYXRpb25WQWxpZ246ICdib3R0b20nLCAvL2JvdHRvbSwgdG9wLCBib3RoXG4gICAgICAgIHBhZ2luYXRpb25EZXRhaWxIQWxpZ246ICdsZWZ0JywgLy9yaWdodCwgbGVmdFxuICAgICAgICBwYWdpbmF0aW9uUHJlVGV4dDogJyZsc2FxdW87JyxcbiAgICAgICAgcGFnaW5hdGlvbk5leHRUZXh0OiAnJnJzYXF1bzsnLFxuICAgICAgICBzZWFyY2g6IGZhbHNlLFxuICAgICAgICBzZWFyY2hPbkVudGVyS2V5OiBmYWxzZSxcbiAgICAgICAgc3RyaWN0U2VhcmNoOiBmYWxzZSxcbiAgICAgICAgc2VhcmNoQWxpZ246ICdyaWdodCcsXG4gICAgICAgIHNlbGVjdEl0ZW1OYW1lOiAnYnRTZWxlY3RJdGVtJyxcbiAgICAgICAgc2hvd0hlYWRlcjogdHJ1ZSxcbiAgICAgICAgc2hvd0Zvb3RlcjogZmFsc2UsXG4gICAgICAgIHNob3dDb2x1bW5zOiBmYWxzZSxcbiAgICAgICAgc2hvd1BhZ2luYXRpb25Td2l0Y2g6IGZhbHNlLFxuICAgICAgICBzaG93UmVmcmVzaDogZmFsc2UsXG4gICAgICAgIHNob3dUb2dnbGU6IGZhbHNlLFxuICAgICAgICBidXR0b25zQWxpZ246ICdyaWdodCcsXG4gICAgICAgIHNtYXJ0RGlzcGxheTogdHJ1ZSxcbiAgICAgICAgZXNjYXBlOiBmYWxzZSxcbiAgICAgICAgbWluaW11bUNvdW50Q29sdW1uczogMSxcbiAgICAgICAgaWRGaWVsZDogdW5kZWZpbmVkLFxuICAgICAgICB1bmlxdWVJZDogdW5kZWZpbmVkLFxuICAgICAgICBjYXJkVmlldzogZmFsc2UsXG4gICAgICAgIGRldGFpbFZpZXc6IGZhbHNlLFxuICAgICAgICBkZXRhaWxGb3JtYXR0ZXI6IGZ1bmN0aW9uIChpbmRleCwgcm93KSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH0sXG4gICAgICAgIHRyaW1PblNlYXJjaDogdHJ1ZSxcbiAgICAgICAgY2xpY2tUb1NlbGVjdDogZmFsc2UsXG4gICAgICAgIHNpbmdsZVNlbGVjdDogZmFsc2UsXG4gICAgICAgIHRvb2xiYXI6IHVuZGVmaW5lZCxcbiAgICAgICAgdG9vbGJhckFsaWduOiAnbGVmdCcsXG4gICAgICAgIGNoZWNrYm94SGVhZGVyOiB0cnVlLFxuICAgICAgICBzb3J0YWJsZTogdHJ1ZSxcbiAgICAgICAgc2lsZW50U29ydDogdHJ1ZSxcbiAgICAgICAgbWFpbnRhaW5TZWxlY3RlZDogZmFsc2UsXG4gICAgICAgIHNlYXJjaFRpbWVPdXQ6IDUwMCxcbiAgICAgICAgc2VhcmNoVGV4dDogJycsXG4gICAgICAgIGljb25TaXplOiB1bmRlZmluZWQsXG4gICAgICAgIGJ1dHRvbnNDbGFzczogJ2RlZmF1bHQnLFxuICAgICAgICBpY29uc1ByZWZpeDogJ2dseXBoaWNvbicsIC8vIGdseXBoaWNvbiBvZiBmYSAoZm9udCBhd2Vzb21lKVxuICAgICAgICBpY29uczoge1xuICAgICAgICAgICAgcGFnaW5hdGlvblN3aXRjaERvd246ICdnbHlwaGljb24tY29sbGFwc2UtZG93biBpY29uLWNoZXZyb24tZG93bicsXG4gICAgICAgICAgICBwYWdpbmF0aW9uU3dpdGNoVXA6ICdnbHlwaGljb24tY29sbGFwc2UtdXAgaWNvbi1jaGV2cm9uLXVwJyxcbiAgICAgICAgICAgIHJlZnJlc2g6ICdnbHlwaGljb24tcmVmcmVzaCBpY29uLXJlZnJlc2gnLFxuICAgICAgICAgICAgdG9nZ2xlOiAnZ2x5cGhpY29uLWxpc3QtYWx0IGljb24tbGlzdC1hbHQnLFxuICAgICAgICAgICAgY29sdW1uczogJ2dseXBoaWNvbi10aCBpY29uLXRoJyxcbiAgICAgICAgICAgIGRldGFpbE9wZW46ICdnbHlwaGljb24tcGx1cyBpY29uLXBsdXMnLFxuICAgICAgICAgICAgZGV0YWlsQ2xvc2U6ICdnbHlwaGljb24tbWludXMgaWNvbi1taW51cydcbiAgICAgICAgfSxcblxuICAgICAgICBjdXN0b21TZWFyY2g6ICQubm9vcCxcblxuICAgICAgICBjdXN0b21Tb3J0OiAkLm5vb3AsXG5cbiAgICAgICAgcm93U3R5bGU6IGZ1bmN0aW9uIChyb3csIGluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH0sXG5cbiAgICAgICAgcm93QXR0cmlidXRlczogZnVuY3Rpb24gKHJvdywgaW5kZXgpIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfSxcblxuICAgICAgICBmb290ZXJTdHlsZTogZnVuY3Rpb24gKHJvdywgaW5kZXgpIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfSxcblxuICAgICAgICBvbkFsbDogZnVuY3Rpb24gKG5hbWUsIGFyZ3MpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgb25DbGlja0NlbGw6IGZ1bmN0aW9uIChmaWVsZCwgdmFsdWUsIHJvdywgJGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgb25EYmxDbGlja0NlbGw6IGZ1bmN0aW9uIChmaWVsZCwgdmFsdWUsIHJvdywgJGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgb25DbGlja1JvdzogZnVuY3Rpb24gKGl0ZW0sICRlbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRGJsQ2xpY2tSb3c6IGZ1bmN0aW9uIChpdGVtLCAkZWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvblNvcnQ6IGZ1bmN0aW9uIChuYW1lLCBvcmRlcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvbkNoZWNrOiBmdW5jdGlvbiAocm93KSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIG9uVW5jaGVjazogZnVuY3Rpb24gKHJvdykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvbkNoZWNrQWxsOiBmdW5jdGlvbiAocm93cykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvblVuY2hlY2tBbGw6IGZ1bmN0aW9uIChyb3dzKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQ2hlY2tTb21lOiBmdW5jdGlvbiAocm93cykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvblVuY2hlY2tTb21lOiBmdW5jdGlvbiAocm93cykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvbkxvYWRTdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvbkxvYWRFcnJvcjogZnVuY3Rpb24gKHN0YXR1cykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvbkNvbHVtblN3aXRjaDogZnVuY3Rpb24gKGZpZWxkLCBjaGVja2VkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUGFnZUNoYW5nZTogZnVuY3Rpb24gKG51bWJlciwgc2l6ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvblNlYXJjaDogZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgb25Ub2dnbGU6IGZ1bmN0aW9uIChjYXJkVmlldykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvblByZUJvZHk6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUG9zdEJvZHk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgb25Qb3N0SGVhZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRXhwYW5kUm93OiBmdW5jdGlvbiAoaW5kZXgsIHJvdywgJGRldGFpbCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvbkNvbGxhcHNlUm93OiBmdW5jdGlvbiAoaW5kZXgsIHJvdykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvblJlZnJlc2hPcHRpb25zOiBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBvblJlZnJlc2g6IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUmVzZXRWaWV3OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUuTE9DQUxFUyA9IHt9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUuTE9DQUxFU1snZW4tVVMnXSA9IEJvb3RzdHJhcFRhYmxlLkxPQ0FMRVMuZW4gPSB7XG4gICAgICAgIGZvcm1hdExvYWRpbmdNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0xvYWRpbmcsIHBsZWFzZSB3YWl0Li4uJztcbiAgICAgICAgfSxcbiAgICAgICAgZm9ybWF0UmVjb3Jkc1BlclBhZ2U6IGZ1bmN0aW9uIChwYWdlTnVtYmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gc3ByaW50ZignJXMgcm93cyBwZXIgcGFnZScsIHBhZ2VOdW1iZXIpO1xuICAgICAgICB9LFxuICAgICAgICBmb3JtYXRTaG93aW5nUm93czogZnVuY3Rpb24gKHBhZ2VGcm9tLCBwYWdlVG8sIHRvdGFsUm93cykge1xuICAgICAgICAgICAgcmV0dXJuIHNwcmludGYoJ1Nob3dpbmcgJXMgdG8gJXMgb2YgJXMgcm93cycsIHBhZ2VGcm9tLCBwYWdlVG8sIHRvdGFsUm93cyk7XG4gICAgICAgIH0sXG4gICAgICAgIGZvcm1hdERldGFpbFBhZ2luYXRpb246IGZ1bmN0aW9uICh0b3RhbFJvd3MpIHtcbiAgICAgICAgICAgIHJldHVybiBzcHJpbnRmKCdTaG93aW5nICVzIHJvd3MnLCB0b3RhbFJvd3MpO1xuICAgICAgICB9LFxuICAgICAgICBmb3JtYXRTZWFyY2g6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnU2VhcmNoJztcbiAgICAgICAgfSxcbiAgICAgICAgZm9ybWF0Tm9NYXRjaGVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ05vIG1hdGNoaW5nIHJlY29yZHMgZm91bmQnO1xuICAgICAgICB9LFxuICAgICAgICBmb3JtYXRQYWdpbmF0aW9uU3dpdGNoOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0hpZGUvU2hvdyBwYWdpbmF0aW9uJztcbiAgICAgICAgfSxcbiAgICAgICAgZm9ybWF0UmVmcmVzaDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdSZWZyZXNoJztcbiAgICAgICAgfSxcbiAgICAgICAgZm9ybWF0VG9nZ2xlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1RvZ2dsZSc7XG4gICAgICAgIH0sXG4gICAgICAgIGZvcm1hdENvbHVtbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnQ29sdW1ucyc7XG4gICAgICAgIH0sXG4gICAgICAgIGZvcm1hdEFsbFJvd3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnQWxsJztcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkLmV4dGVuZChCb290c3RyYXBUYWJsZS5ERUZBVUxUUywgQm9vdHN0cmFwVGFibGUuTE9DQUxFU1snZW4tVVMnXSk7XG5cbiAgICBCb290c3RyYXBUYWJsZS5DT0xVTU5fREVGQVVMVFMgPSB7XG4gICAgICAgIHJhZGlvOiBmYWxzZSxcbiAgICAgICAgY2hlY2tib3g6IGZhbHNlLFxuICAgICAgICBjaGVja2JveEVuYWJsZWQ6IHRydWUsXG4gICAgICAgIGZpZWxkOiB1bmRlZmluZWQsXG4gICAgICAgIHRpdGxlOiB1bmRlZmluZWQsXG4gICAgICAgIHRpdGxlVG9vbHRpcDogdW5kZWZpbmVkLFxuICAgICAgICAnY2xhc3MnOiB1bmRlZmluZWQsXG4gICAgICAgIGFsaWduOiB1bmRlZmluZWQsIC8vIGxlZnQsIHJpZ2h0LCBjZW50ZXJcbiAgICAgICAgaGFsaWduOiB1bmRlZmluZWQsIC8vIGxlZnQsIHJpZ2h0LCBjZW50ZXJcbiAgICAgICAgZmFsaWduOiB1bmRlZmluZWQsIC8vIGxlZnQsIHJpZ2h0LCBjZW50ZXJcbiAgICAgICAgdmFsaWduOiB1bmRlZmluZWQsIC8vIHRvcCwgbWlkZGxlLCBib3R0b21cbiAgICAgICAgd2lkdGg6IHVuZGVmaW5lZCxcbiAgICAgICAgc29ydGFibGU6IGZhbHNlLFxuICAgICAgICBvcmRlcjogJ2FzYycsIC8vIGFzYywgZGVzY1xuICAgICAgICB2aXNpYmxlOiB0cnVlLFxuICAgICAgICBzd2l0Y2hhYmxlOiB0cnVlLFxuICAgICAgICBjbGlja1RvU2VsZWN0OiB0cnVlLFxuICAgICAgICBmb3JtYXR0ZXI6IHVuZGVmaW5lZCxcbiAgICAgICAgZm9vdGVyRm9ybWF0dGVyOiB1bmRlZmluZWQsXG4gICAgICAgIGV2ZW50czogdW5kZWZpbmVkLFxuICAgICAgICBzb3J0ZXI6IHVuZGVmaW5lZCxcbiAgICAgICAgc29ydE5hbWU6IHVuZGVmaW5lZCxcbiAgICAgICAgY2VsbFN0eWxlOiB1bmRlZmluZWQsXG4gICAgICAgIHNlYXJjaGFibGU6IHRydWUsXG4gICAgICAgIHNlYXJjaEZvcm1hdHRlcjogdHJ1ZSxcbiAgICAgICAgY2FyZFZpc2libGU6IHRydWVcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUuRVZFTlRTID0ge1xuICAgICAgICAnYWxsLmJzLnRhYmxlJzogJ29uQWxsJyxcbiAgICAgICAgJ2NsaWNrLWNlbGwuYnMudGFibGUnOiAnb25DbGlja0NlbGwnLFxuICAgICAgICAnZGJsLWNsaWNrLWNlbGwuYnMudGFibGUnOiAnb25EYmxDbGlja0NlbGwnLFxuICAgICAgICAnY2xpY2stcm93LmJzLnRhYmxlJzogJ29uQ2xpY2tSb3cnLFxuICAgICAgICAnZGJsLWNsaWNrLXJvdy5icy50YWJsZSc6ICdvbkRibENsaWNrUm93JyxcbiAgICAgICAgJ3NvcnQuYnMudGFibGUnOiAnb25Tb3J0JyxcbiAgICAgICAgJ2NoZWNrLmJzLnRhYmxlJzogJ29uQ2hlY2snLFxuICAgICAgICAndW5jaGVjay5icy50YWJsZSc6ICdvblVuY2hlY2snLFxuICAgICAgICAnY2hlY2stYWxsLmJzLnRhYmxlJzogJ29uQ2hlY2tBbGwnLFxuICAgICAgICAndW5jaGVjay1hbGwuYnMudGFibGUnOiAnb25VbmNoZWNrQWxsJyxcbiAgICAgICAgJ2NoZWNrLXNvbWUuYnMudGFibGUnOiAnb25DaGVja1NvbWUnLFxuICAgICAgICAndW5jaGVjay1zb21lLmJzLnRhYmxlJzogJ29uVW5jaGVja1NvbWUnLFxuICAgICAgICAnbG9hZC1zdWNjZXNzLmJzLnRhYmxlJzogJ29uTG9hZFN1Y2Nlc3MnLFxuICAgICAgICAnbG9hZC1lcnJvci5icy50YWJsZSc6ICdvbkxvYWRFcnJvcicsXG4gICAgICAgICdjb2x1bW4tc3dpdGNoLmJzLnRhYmxlJzogJ29uQ29sdW1uU3dpdGNoJyxcbiAgICAgICAgJ3BhZ2UtY2hhbmdlLmJzLnRhYmxlJzogJ29uUGFnZUNoYW5nZScsXG4gICAgICAgICdzZWFyY2guYnMudGFibGUnOiAnb25TZWFyY2gnLFxuICAgICAgICAndG9nZ2xlLmJzLnRhYmxlJzogJ29uVG9nZ2xlJyxcbiAgICAgICAgJ3ByZS1ib2R5LmJzLnRhYmxlJzogJ29uUHJlQm9keScsXG4gICAgICAgICdwb3N0LWJvZHkuYnMudGFibGUnOiAnb25Qb3N0Qm9keScsXG4gICAgICAgICdwb3N0LWhlYWRlci5icy50YWJsZSc6ICdvblBvc3RIZWFkZXInLFxuICAgICAgICAnZXhwYW5kLXJvdy5icy50YWJsZSc6ICdvbkV4cGFuZFJvdycsXG4gICAgICAgICdjb2xsYXBzZS1yb3cuYnMudGFibGUnOiAnb25Db2xsYXBzZVJvdycsXG4gICAgICAgICdyZWZyZXNoLW9wdGlvbnMuYnMudGFibGUnOiAnb25SZWZyZXNoT3B0aW9ucycsXG4gICAgICAgICdyZXNldC12aWV3LmJzLnRhYmxlJzogJ29uUmVzZXRWaWV3JyxcbiAgICAgICAgJ3JlZnJlc2guYnMudGFibGUnOiAnb25SZWZyZXNoJ1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pbml0TG9jYWxlKCk7XG4gICAgICAgIHRoaXMuaW5pdENvbnRhaW5lcigpO1xuICAgICAgICB0aGlzLmluaXRUYWJsZSgpO1xuICAgICAgICB0aGlzLmluaXRIZWFkZXIoKTtcbiAgICAgICAgdGhpcy5pbml0RGF0YSgpO1xuICAgICAgICB0aGlzLmluaXRGb290ZXIoKTtcbiAgICAgICAgdGhpcy5pbml0VG9vbGJhcigpO1xuICAgICAgICB0aGlzLmluaXRQYWdpbmF0aW9uKCk7XG4gICAgICAgIHRoaXMuaW5pdEJvZHkoKTtcbiAgICAgICAgdGhpcy5pbml0U2VhcmNoVGV4dCgpO1xuICAgICAgICB0aGlzLmluaXRTZXJ2ZXIoKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmluaXRMb2NhbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMubG9jYWxlKSB7XG4gICAgICAgICAgICB2YXIgcGFydHMgPSB0aGlzLm9wdGlvbnMubG9jYWxlLnNwbGl0KC8tfF8vKTtcbiAgICAgICAgICAgIHBhcnRzWzBdLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBpZiAocGFydHNbMV0pIHBhcnRzWzFdLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICBpZiAoJC5mbi5ib290c3RyYXBUYWJsZS5sb2NhbGVzW3RoaXMub3B0aW9ucy5sb2NhbGVdKSB7XG4gICAgICAgICAgICAgICAgLy8gbG9jYWxlIGFzIHJlcXVlc3RlZFxuICAgICAgICAgICAgICAgICQuZXh0ZW5kKHRoaXMub3B0aW9ucywgJC5mbi5ib290c3RyYXBUYWJsZS5sb2NhbGVzW3RoaXMub3B0aW9ucy5sb2NhbGVdKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoJC5mbi5ib290c3RyYXBUYWJsZS5sb2NhbGVzW3BhcnRzLmpvaW4oJy0nKV0pIHtcbiAgICAgICAgICAgICAgICAvLyBsb2NhbGUgd2l0aCBzZXAgc2V0IHRvIC0gKGluIGNhc2Ugb3JpZ2luYWwgd2FzIHNwZWNpZmllZCB3aXRoIF8pXG4gICAgICAgICAgICAgICAgJC5leHRlbmQodGhpcy5vcHRpb25zLCAkLmZuLmJvb3RzdHJhcFRhYmxlLmxvY2FsZXNbcGFydHMuam9pbignLScpXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCQuZm4uYm9vdHN0cmFwVGFibGUubG9jYWxlc1twYXJ0c1swXV0pIHtcbiAgICAgICAgICAgICAgICAvLyBzaG9ydCBsb2NhbGUgbGFuZ3VhZ2UgY29kZSAoaS5lLiAnZW4nKVxuICAgICAgICAgICAgICAgICQuZXh0ZW5kKHRoaXMub3B0aW9ucywgJC5mbi5ib290c3RyYXBUYWJsZS5sb2NhbGVzW3BhcnRzWzBdXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmluaXRDb250YWluZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuJGNvbnRhaW5lciA9ICQoW1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJib290c3RyYXAtdGFibGVcIj4nLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmaXhlZC10YWJsZS10b29sYmFyXCI+PC9kaXY+JyxcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wYWdpbmF0aW9uVkFsaWduID09PSAndG9wJyB8fCB0aGlzLm9wdGlvbnMucGFnaW5hdGlvblZBbGlnbiA9PT0gJ2JvdGgnID9cbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZpeGVkLXRhYmxlLXBhZ2luYXRpb25cIiBzdHlsZT1cImNsZWFyOiBib3RoO1wiPjwvZGl2PicgOlxuICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmaXhlZC10YWJsZS1jb250YWluZXJcIj4nLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmaXhlZC10YWJsZS1oZWFkZXJcIj48dGFibGU+PC90YWJsZT48L2Rpdj4nLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmaXhlZC10YWJsZS1ib2R5XCI+JyxcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZml4ZWQtdGFibGUtbG9hZGluZ1wiPicsXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuZm9ybWF0TG9hZGluZ01lc3NhZ2UoKSxcbiAgICAgICAgICAgICc8L2Rpdj4nLFxuICAgICAgICAgICAgJzwvZGl2PicsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZpeGVkLXRhYmxlLWZvb3RlclwiPjx0YWJsZT48dHI+PC90cj48L3RhYmxlPjwvZGl2PicsXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMucGFnaW5hdGlvblZBbGlnbiA9PT0gJ2JvdHRvbScgfHwgdGhpcy5vcHRpb25zLnBhZ2luYXRpb25WQWxpZ24gPT09ICdib3RoJyA/XG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmaXhlZC10YWJsZS1wYWdpbmF0aW9uXCI+PC9kaXY+JyA6XG4gICAgICAgICAgICAgICAgJycsXG4gICAgICAgICAgICAnPC9kaXY+JyxcbiAgICAgICAgICAgICc8L2Rpdj4nXG4gICAgICAgIF0uam9pbignJykpO1xuXG4gICAgICAgIHRoaXMuJGNvbnRhaW5lci5pbnNlcnRBZnRlcih0aGlzLiRlbCk7XG4gICAgICAgIHRoaXMuJHRhYmxlQ29udGFpbmVyID0gdGhpcy4kY29udGFpbmVyLmZpbmQoJy5maXhlZC10YWJsZS1jb250YWluZXInKTtcbiAgICAgICAgdGhpcy4kdGFibGVIZWFkZXIgPSB0aGlzLiRjb250YWluZXIuZmluZCgnLmZpeGVkLXRhYmxlLWhlYWRlcicpO1xuICAgICAgICB0aGlzLiR0YWJsZUJvZHkgPSB0aGlzLiRjb250YWluZXIuZmluZCgnLmZpeGVkLXRhYmxlLWJvZHknKTtcbiAgICAgICAgdGhpcy4kdGFibGVMb2FkaW5nID0gdGhpcy4kY29udGFpbmVyLmZpbmQoJy5maXhlZC10YWJsZS1sb2FkaW5nJyk7XG4gICAgICAgIHRoaXMuJHRhYmxlRm9vdGVyID0gdGhpcy4kY29udGFpbmVyLmZpbmQoJy5maXhlZC10YWJsZS1mb290ZXInKTtcbiAgICAgICAgdGhpcy4kdG9vbGJhciA9IHRoaXMuJGNvbnRhaW5lci5maW5kKCcuZml4ZWQtdGFibGUtdG9vbGJhcicpO1xuICAgICAgICB0aGlzLiRwYWdpbmF0aW9uID0gdGhpcy4kY29udGFpbmVyLmZpbmQoJy5maXhlZC10YWJsZS1wYWdpbmF0aW9uJyk7XG5cbiAgICAgICAgdGhpcy4kdGFibGVCb2R5LmFwcGVuZCh0aGlzLiRlbCk7XG4gICAgICAgIHRoaXMuJGNvbnRhaW5lci5hZnRlcignPGRpdiBjbGFzcz1cImNsZWFyZml4XCI+PC9kaXY+Jyk7XG5cbiAgICAgICAgdGhpcy4kZWwuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmNsYXNzZXMpO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnN0cmlwZWQpIHtcbiAgICAgICAgICAgIHRoaXMuJGVsLmFkZENsYXNzKCd0YWJsZS1zdHJpcGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCQuaW5BcnJheSgndGFibGUtbm8tYm9yZGVyZWQnLCB0aGlzLm9wdGlvbnMuY2xhc3Nlcy5zcGxpdCgnICcpKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuJHRhYmxlQ29udGFpbmVyLmFkZENsYXNzKCd0YWJsZS1uby1ib3JkZXJlZCcpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5pbml0VGFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgICAgICAgIGNvbHVtbnMgPSBbXSxcbiAgICAgICAgICAgIGRhdGEgPSBbXTtcblxuICAgICAgICB0aGlzLiRoZWFkZXIgPSB0aGlzLiRlbC5maW5kKCc+dGhlYWQnKTtcbiAgICAgICAgaWYgKCF0aGlzLiRoZWFkZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLiRoZWFkZXIgPSAkKCc8dGhlYWQ+PC90aGVhZD4nKS5hcHBlbmRUbyh0aGlzLiRlbCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy4kaGVhZGVyLmZpbmQoJ3RyJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY29sdW1uID0gW107XG5cbiAgICAgICAgICAgICQodGhpcykuZmluZCgndGgnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyBGaXggIzIwMTQgLSBnZXRGaWVsZEluZGV4IGFuZCBlbHNld2hlcmUgYXNzdW1lIHRoaXMgaXMgc3RyaW5nLCBjYXVzZXMgaXNzdWVzIGlmIG5vdFxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgJCh0aGlzKS5kYXRhKCdmaWVsZCcpICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ2ZpZWxkJywgJCh0aGlzKS5kYXRhKCdmaWVsZCcpICsgJycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb2x1bW4ucHVzaCgkLmV4dGVuZCh7fSwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJCh0aGlzKS5odG1sKCksXG4gICAgICAgICAgICAgICAgICAgIGh0bWwgOiAkKHRoaXMpLmh0bWwoKSxcbiAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzogJCh0aGlzKS5hdHRyKCdjbGFzcycpLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZVRvb2x0aXA6ICQodGhpcykuYXR0cigndGl0bGUnKSxcbiAgICAgICAgICAgICAgICAgICAgcm93c3BhbjogJCh0aGlzKS5hdHRyKCdyb3dzcGFuJykgPyArJCh0aGlzKS5hdHRyKCdyb3dzcGFuJykgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGNvbHNwYW46ICQodGhpcykuYXR0cignY29sc3BhbicpID8gKyQodGhpcykuYXR0cignY29sc3BhbicpIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfSwgJCh0aGlzKS5kYXRhKCkpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29sdW1ucy5wdXNoKGNvbHVtbik7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoISQuaXNBcnJheSh0aGlzLm9wdGlvbnMuY29sdW1uc1swXSkpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5jb2x1bW5zID0gW3RoaXMub3B0aW9ucy5jb2x1bW5zXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9wdGlvbnMuY29sdW1ucyA9ICQuZXh0ZW5kKHRydWUsIFtdLCBjb2x1bW5zLCB0aGlzLm9wdGlvbnMuY29sdW1ucyk7XG4gICAgICAgIHRoaXMuY29sdW1ucyA9IFtdO1xuXG4gICAgICAgIHNldEZpZWxkSW5kZXgodGhpcy5vcHRpb25zLmNvbHVtbnMpO1xuICAgICAgICAkLmVhY2godGhpcy5vcHRpb25zLmNvbHVtbnMsIGZ1bmN0aW9uIChpLCBjb2x1bW5zKSB7XG4gICAgICAgICAgICAkLmVhY2goY29sdW1ucywgZnVuY3Rpb24gKGosIGNvbHVtbikge1xuICAgICAgICAgICAgICAgIGNvbHVtbiA9ICQuZXh0ZW5kKHt9LCBCb290c3RyYXBUYWJsZS5DT0xVTU5fREVGQVVMVFMsIGNvbHVtbik7XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbHVtbi5maWVsZEluZGV4ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmNvbHVtbnNbY29sdW1uLmZpZWxkSW5kZXhdID0gY29sdW1uO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoYXQub3B0aW9ucy5jb2x1bW5zW2ldW2pdID0gY29sdW1uO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGlmIG9wdGlvbnMuZGF0YSBpcyBzZXR0aW5nLCBkbyBub3QgcHJvY2VzcyB0Ym9keSBkYXRhXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBtID0gW107XG4gICAgICAgIHRoaXMuJGVsLmZpbmQoJz50Ym9keT50cicpLmVhY2goZnVuY3Rpb24gKHkpIHtcbiAgICAgICAgICAgIHZhciByb3cgPSB7fTtcblxuICAgICAgICAgICAgLy8gc2F2ZSB0cidzIGlkLCBjbGFzcyBhbmQgZGF0YS0qIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgIHJvdy5faWQgPSAkKHRoaXMpLmF0dHIoJ2lkJyk7XG4gICAgICAgICAgICByb3cuX2NsYXNzID0gJCh0aGlzKS5hdHRyKCdjbGFzcycpO1xuICAgICAgICAgICAgcm93Ll9kYXRhID0gZ2V0UmVhbERhdGFBdHRyKCQodGhpcykuZGF0YSgpKTtcblxuICAgICAgICAgICAgJCh0aGlzKS5maW5kKCc+dGQnKS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgY3NwYW4gPSArJHRoaXMuYXR0cignY29sc3BhbicpIHx8IDEsXG4gICAgICAgICAgICAgICAgICAgIHJzcGFuID0gKyR0aGlzLmF0dHIoJ3Jvd3NwYW4nKSB8fCAxLFxuICAgICAgICAgICAgICAgICAgICB0eCwgdHk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKDsgbVt5XSAmJiBtW3ldW3hdOyB4KyspOyAvL3NraXAgYWxyZWFkeSBvY2N1cGllZCBjZWxscyBpbiBjdXJyZW50IHJvd1xuXG4gICAgICAgICAgICAgICAgZm9yICh0eCA9IHg7IHR4IDwgeCArIGNzcGFuOyB0eCsrKSB7IC8vbWFyayBtYXRyaXggZWxlbWVudHMgb2NjdXBpZWQgYnkgY3VycmVudCBjZWxsIHdpdGggdHJ1ZVxuICAgICAgICAgICAgICAgICAgICBmb3IgKHR5ID0geTsgdHkgPCB5ICsgcnNwYW47IHR5KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbVt0eV0pIHsgLy9maWxsIG1pc3Npbmcgcm93c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1bdHldID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtW3R5XVt0eF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gdGhhdC5jb2x1bW5zW3hdLmZpZWxkO1xuXG4gICAgICAgICAgICAgICAgcm93W2ZpZWxkXSA9ICQodGhpcykuaHRtbCgpO1xuICAgICAgICAgICAgICAgIC8vIHNhdmUgdGQncyBpZCwgY2xhc3MgYW5kIGRhdGEtKiBhdHRyaWJ1dGVzXG4gICAgICAgICAgICAgICAgcm93WydfJyArIGZpZWxkICsgJ19pZCddID0gJCh0aGlzKS5hdHRyKCdpZCcpO1xuICAgICAgICAgICAgICAgIHJvd1snXycgKyBmaWVsZCArICdfY2xhc3MnXSA9ICQodGhpcykuYXR0cignY2xhc3MnKTtcbiAgICAgICAgICAgICAgICByb3dbJ18nICsgZmllbGQgKyAnX3Jvd3NwYW4nXSA9ICQodGhpcykuYXR0cigncm93c3BhbicpO1xuICAgICAgICAgICAgICAgIHJvd1snXycgKyBmaWVsZCArICdfY29sc3BhbiddID0gJCh0aGlzKS5hdHRyKCdjb2xzcGFuJyk7XG4gICAgICAgICAgICAgICAgcm93WydfJyArIGZpZWxkICsgJ190aXRsZSddID0gJCh0aGlzKS5hdHRyKCd0aXRsZScpO1xuICAgICAgICAgICAgICAgIHJvd1snXycgKyBmaWVsZCArICdfZGF0YSddID0gZ2V0UmVhbERhdGFBdHRyKCQodGhpcykuZGF0YSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZGF0YS5wdXNoKHJvdyk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm9wdGlvbnMuZGF0YSA9IGRhdGE7XG4gICAgICAgIGlmIChkYXRhLmxlbmd0aCkgdGhpcy5mcm9tSHRtbCA9IHRydWU7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5pbml0SGVhZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICB2aXNpYmxlQ29sdW1ucyA9IHt9LFxuICAgICAgICAgICAgaHRtbCA9IFtdO1xuXG4gICAgICAgIHRoaXMuaGVhZGVyID0ge1xuICAgICAgICAgICAgZmllbGRzOiBbXSxcbiAgICAgICAgICAgIHN0eWxlczogW10sXG4gICAgICAgICAgICBjbGFzc2VzOiBbXSxcbiAgICAgICAgICAgIGZvcm1hdHRlcnM6IFtdLFxuICAgICAgICAgICAgZXZlbnRzOiBbXSxcbiAgICAgICAgICAgIHNvcnRlcnM6IFtdLFxuICAgICAgICAgICAgc29ydE5hbWVzOiBbXSxcbiAgICAgICAgICAgIGNlbGxTdHlsZXM6IFtdLFxuICAgICAgICAgICAgc2VhcmNoYWJsZXM6IFtdXG4gICAgICAgIH07XG5cbiAgICAgICAgJC5lYWNoKHRoaXMub3B0aW9ucy5jb2x1bW5zLCBmdW5jdGlvbiAoaSwgY29sdW1ucykge1xuICAgICAgICAgICAgaHRtbC5wdXNoKCc8dHI+Jyk7XG5cbiAgICAgICAgICAgIGlmIChpID09PSAwICYmICF0aGF0Lm9wdGlvbnMuY2FyZFZpZXcgJiYgdGhhdC5vcHRpb25zLmRldGFpbFZpZXcpIHtcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goc3ByaW50ZignPHRoIGNsYXNzPVwiZGV0YWlsXCIgcm93c3Bhbj1cIiVzXCI+PGRpdiBjbGFzcz1cImZodC1jZWxsXCI+PC9kaXY+PC90aD4nLFxuICAgICAgICAgICAgICAgICAgICB0aGF0Lm9wdGlvbnMuY29sdW1ucy5sZW5ndGgpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJC5lYWNoKGNvbHVtbnMsIGZ1bmN0aW9uIChqLCBjb2x1bW4pIHtcbiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICcnLFxuICAgICAgICAgICAgICAgICAgICBoYWxpZ24gPSAnJywgLy8gaGVhZGVyIGFsaWduIHN0eWxlXG4gICAgICAgICAgICAgICAgICAgIGFsaWduID0gJycsIC8vIGJvZHkgYWxpZ24gc3R5bGVcbiAgICAgICAgICAgICAgICAgICAgc3R5bGUgPSAnJyxcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NfID0gc3ByaW50ZignIGNsYXNzPVwiJXNcIicsIGNvbHVtblsnY2xhc3MnXSksXG4gICAgICAgICAgICAgICAgICAgIG9yZGVyID0gdGhhdC5vcHRpb25zLnNvcnRPcmRlciB8fCBjb2x1bW4ub3JkZXIsXG4gICAgICAgICAgICAgICAgICAgIHVuaXRXaWR0aCA9ICdweCcsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoID0gY29sdW1uLndpZHRoO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi53aWR0aCAhPT0gdW5kZWZpbmVkICYmICghdGhhdC5vcHRpb25zLmNhcmRWaWV3KSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbHVtbi53aWR0aCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2x1bW4ud2lkdGguaW5kZXhPZignJScpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXRXaWR0aCA9ICclJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uLndpZHRoICYmIHR5cGVvZiBjb2x1bW4ud2lkdGggPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoID0gY29sdW1uLndpZHRoLnJlcGxhY2UoJyUnLCAnJykucmVwbGFjZSgncHgnLCAnJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaGFsaWduID0gc3ByaW50ZigndGV4dC1hbGlnbjogJXM7ICcsIGNvbHVtbi5oYWxpZ24gPyBjb2x1bW4uaGFsaWduIDogY29sdW1uLmFsaWduKTtcbiAgICAgICAgICAgICAgICBhbGlnbiA9IHNwcmludGYoJ3RleHQtYWxpZ246ICVzOyAnLCBjb2x1bW4uYWxpZ24pO1xuICAgICAgICAgICAgICAgIHN0eWxlID0gc3ByaW50ZigndmVydGljYWwtYWxpZ246ICVzOyAnLCBjb2x1bW4udmFsaWduKTtcbiAgICAgICAgICAgICAgICBzdHlsZSArPSBzcHJpbnRmKCd3aWR0aDogJXM7ICcsIChjb2x1bW4uY2hlY2tib3ggfHwgY29sdW1uLnJhZGlvKSAmJiAhd2lkdGggP1xuICAgICAgICAgICAgICAgICAgICAnMzZweCcgOiAod2lkdGggPyB3aWR0aCArIHVuaXRXaWR0aCA6IHVuZGVmaW5lZCkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb2x1bW4uZmllbGRJbmRleCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5oZWFkZXIuZmllbGRzW2NvbHVtbi5maWVsZEluZGV4XSA9IGNvbHVtbi5maWVsZDtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5oZWFkZXIuc3R5bGVzW2NvbHVtbi5maWVsZEluZGV4XSA9IGFsaWduICsgc3R5bGU7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaGVhZGVyLmNsYXNzZXNbY29sdW1uLmZpZWxkSW5kZXhdID0gY2xhc3NfO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmhlYWRlci5mb3JtYXR0ZXJzW2NvbHVtbi5maWVsZEluZGV4XSA9IGNvbHVtbi5mb3JtYXR0ZXI7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaGVhZGVyLmV2ZW50c1tjb2x1bW4uZmllbGRJbmRleF0gPSBjb2x1bW4uZXZlbnRzO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmhlYWRlci5zb3J0ZXJzW2NvbHVtbi5maWVsZEluZGV4XSA9IGNvbHVtbi5zb3J0ZXI7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaGVhZGVyLnNvcnROYW1lc1tjb2x1bW4uZmllbGRJbmRleF0gPSBjb2x1bW4uc29ydE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaGVhZGVyLmNlbGxTdHlsZXNbY29sdW1uLmZpZWxkSW5kZXhdID0gY29sdW1uLmNlbGxTdHlsZTtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5oZWFkZXIuc2VhcmNoYWJsZXNbY29sdW1uLmZpZWxkSW5kZXhdID0gY29sdW1uLnNlYXJjaGFibGU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb2x1bW4udmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5jYXJkVmlldyAmJiAoIWNvbHVtbi5jYXJkVmlzaWJsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZpc2libGVDb2x1bW5zW2NvbHVtbi5maWVsZF0gPSBjb2x1bW47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8dGgnICsgc3ByaW50ZignIHRpdGxlPVwiJXNcIicsIGNvbHVtbi50aXRsZVRvb2x0aXApLFxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4uY2hlY2tib3ggfHwgY29sdW1uLnJhZGlvID9cbiAgICAgICAgICAgICAgICAgICAgICAgIHNwcmludGYoJyBjbGFzcz1cImJzLWNoZWNrYm94ICVzXCInLCBjb2x1bW5bJ2NsYXNzJ10gfHwgJycpIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzXyxcbiAgICAgICAgICAgICAgICAgICAgc3ByaW50ZignIHN0eWxlPVwiJXNcIicsIGhhbGlnbiArIHN0eWxlKSxcbiAgICAgICAgICAgICAgICAgICAgc3ByaW50ZignIHJvd3NwYW49XCIlc1wiJywgY29sdW1uLnJvd3NwYW4pLFxuICAgICAgICAgICAgICAgICAgICBzcHJpbnRmKCcgY29sc3Bhbj1cIiVzXCInLCBjb2x1bW4uY29sc3BhbiksXG4gICAgICAgICAgICAgICAgICAgIHNwcmludGYoJyBkYXRhLWZpZWxkPVwiJXNcIicsIGNvbHVtbi5maWVsZCksXG4gICAgICAgICAgICAgICAgICAgIFwidGFiaW5kZXg9JzAnXCIsXG4gICAgICAgICAgICAgICAgICAgICc+Jyk7XG5cbiAgICAgICAgICAgICAgICBodG1sLnB1c2goc3ByaW50ZignPGRpdiBjbGFzcz1cInRoLWlubmVyICVzXCI+JywgdGhhdC5vcHRpb25zLnNvcnRhYmxlICYmIGNvbHVtbi5zb3J0YWJsZSA/XG4gICAgICAgICAgICAgICAgICAgICdzb3J0YWJsZSBib3RoJyA6ICcnKSk7XG5cbiAgICAgICAgICAgICAgICB0ZXh0ID0gY29sdW1uLnRpdGxlO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5jaGVja2JveCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoYXQub3B0aW9ucy5zaW5nbGVTZWxlY3QgJiYgdGhhdC5vcHRpb25zLmNoZWNrYm94SGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gJzxpbnB1dCBuYW1lPVwiYnRTZWxlY3RBbGxcIiB0eXBlPVwiY2hlY2tib3hcIiAvPic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhhdC5oZWFkZXIuc3RhdGVGaWVsZCA9IGNvbHVtbi5maWVsZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5yYWRpbykge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaGVhZGVyLnN0YXRlRmllbGQgPSBjb2x1bW4uZmllbGQ7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQub3B0aW9ucy5zaW5nbGVTZWxlY3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGh0bWwucHVzaCh0ZXh0KTtcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goJzwvZGl2PicpO1xuICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPGRpdiBjbGFzcz1cImZodC1jZWxsXCI+PC9kaXY+Jyk7XG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8L2Rpdj4nKTtcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goJzwvdGg+Jyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGh0bWwucHVzaCgnPC90cj4nKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy4kaGVhZGVyLmh0bWwoaHRtbC5qb2luKCcnKSk7XG4gICAgICAgIHRoaXMuJGhlYWRlci5maW5kKCd0aFtkYXRhLWZpZWxkXScpLmVhY2goZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgICQodGhpcykuZGF0YSh2aXNpYmxlQ29sdW1uc1skKHRoaXMpLmRhdGEoJ2ZpZWxkJyldKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuJGNvbnRhaW5lci5vZmYoJ2NsaWNrJywgJy50aC1pbm5lcicpLm9uKCdjbGljaycsICcudGgtaW5uZXInLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmRldGFpbFZpZXcpIHtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5ib290c3RyYXAtdGFibGUnKVswXSAhPT0gdGhhdC4kY29udGFpbmVyWzBdKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuc29ydGFibGUgJiYgdGFyZ2V0LnBhcmVudCgpLmRhdGEoKS5zb3J0YWJsZSkge1xuICAgICAgICAgICAgICAgIHRoYXQub25Tb3J0KGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy4kaGVhZGVyLmNoaWxkcmVuKCkuY2hpbGRyZW4oKS5vZmYoJ2tleXByZXNzJykub24oJ2tleXByZXNzJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLnNvcnRhYmxlICYmICQodGhpcykuZGF0YSgpLnNvcnRhYmxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBldmVudC5rZXlDb2RlIHx8IGV2ZW50LndoaWNoO1xuICAgICAgICAgICAgICAgIGlmIChjb2RlID09IDEzKSB7IC8vRW50ZXIga2V5Y29kZVxuICAgICAgICAgICAgICAgICAgICB0aGF0Lm9uU29ydChldmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkKHdpbmRvdykub2ZmKCdyZXNpemUuYm9vdHN0cmFwLXRhYmxlJyk7XG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLnNob3dIZWFkZXIgfHwgdGhpcy5vcHRpb25zLmNhcmRWaWV3KSB7XG4gICAgICAgICAgICB0aGlzLiRoZWFkZXIuaGlkZSgpO1xuICAgICAgICAgICAgdGhpcy4kdGFibGVIZWFkZXIuaGlkZSgpO1xuICAgICAgICAgICAgdGhpcy4kdGFibGVMb2FkaW5nLmNzcygndG9wJywgMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLiRoZWFkZXIuc2hvdygpO1xuICAgICAgICAgICAgdGhpcy4kdGFibGVIZWFkZXIuc2hvdygpO1xuICAgICAgICAgICAgdGhpcy4kdGFibGVMb2FkaW5nLmNzcygndG9wJywgdGhpcy4kaGVhZGVyLm91dGVySGVpZ2h0KCkgKyAxKTtcbiAgICAgICAgICAgIC8vIEFzc2lnbiB0aGUgY29ycmVjdCBzb3J0YWJsZSBhcnJvd1xuICAgICAgICAgICAgdGhpcy5nZXRDYXJldCgpO1xuICAgICAgICAgICAgJCh3aW5kb3cpLm9uKCdyZXNpemUuYm9vdHN0cmFwLXRhYmxlJywgJC5wcm94eSh0aGlzLnJlc2V0V2lkdGgsIHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuJHNlbGVjdEFsbCA9IHRoaXMuJGhlYWRlci5maW5kKCdbbmFtZT1cImJ0U2VsZWN0QWxsXCJdJyk7XG4gICAgICAgIHRoaXMuJHNlbGVjdEFsbC5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBjaGVja2VkID0gJCh0aGlzKS5wcm9wKCdjaGVja2VkJyk7XG4gICAgICAgICAgICAgICAgdGhhdFtjaGVja2VkID8gJ2NoZWNrQWxsJyA6ICd1bmNoZWNrQWxsJ10oKTtcbiAgICAgICAgICAgICAgICB0aGF0LnVwZGF0ZVNlbGVjdGVkKCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmluaXRGb290ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLnNob3dGb290ZXIgfHwgdGhpcy5vcHRpb25zLmNhcmRWaWV3KSB7XG4gICAgICAgICAgICB0aGlzLiR0YWJsZUZvb3Rlci5oaWRlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLiR0YWJsZUZvb3Rlci5zaG93KCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIGRhdGFcbiAgICAgKiBAcGFyYW0gdHlwZTogYXBwZW5kIC8gcHJlcGVuZFxuICAgICAqL1xuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5pbml0RGF0YSA9IGZ1bmN0aW9uIChkYXRhLCB0eXBlKSB7XG4gICAgICAgIGlmICh0eXBlID09PSAnYXBwZW5kJykge1xuICAgICAgICAgICAgdGhpcy5kYXRhID0gdGhpcy5kYXRhLmNvbmNhdChkYXRhKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAncHJlcGVuZCcpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IFtdLmNvbmNhdChkYXRhKS5jb25jYXQodGhpcy5kYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGEgfHwgdGhpcy5vcHRpb25zLmRhdGE7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaXggIzgzOSBSZWNvcmRzIGRlbGV0ZWQgd2hlbiBhZGRpbmcgbmV3IHJvdyBvbiBmaWx0ZXJlZCB0YWJsZVxuICAgICAgICBpZiAodHlwZSA9PT0gJ2FwcGVuZCcpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5kYXRhID0gdGhpcy5vcHRpb25zLmRhdGEuY29uY2F0KGRhdGEpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdwcmVwZW5kJykge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLmRhdGEgPSBbXS5jb25jYXQoZGF0YSkuY29uY2F0KHRoaXMub3B0aW9ucy5kYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5kYXRhID0gdGhpcy5kYXRhO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zaWRlUGFnaW5hdGlvbiA9PT0gJ3NlcnZlcicpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRTb3J0KCk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5pbml0U29ydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgbmFtZSA9IHRoaXMub3B0aW9ucy5zb3J0TmFtZSxcbiAgICAgICAgICAgIG9yZGVyID0gdGhpcy5vcHRpb25zLnNvcnRPcmRlciA9PT0gJ2Rlc2MnID8gLTEgOiAxLFxuICAgICAgICAgICAgaW5kZXggPSAkLmluQXJyYXkodGhpcy5vcHRpb25zLnNvcnROYW1lLCB0aGlzLmhlYWRlci5maWVsZHMpO1xuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY3VzdG9tU29ydCAhPT0gJC5ub29wKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuY3VzdG9tU29ydC5hcHBseSh0aGlzLCBbdGhpcy5vcHRpb25zLnNvcnROYW1lLCB0aGlzLm9wdGlvbnMuc29ydE9yZGVyXSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNvcnRTdGFibGUpIHtcbiAgICAgICAgICAgICAgICAkLmVhY2godGhpcy5kYXRhLCBmdW5jdGlvbiAoaSwgcm93KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcm93Lmhhc093blByb3BlcnR5KCdfcG9zaXRpb24nKSkgcm93Ll9wb3NpdGlvbiA9IGk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZGF0YS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoYXQuaGVhZGVyLnNvcnROYW1lc1tpbmRleF0pIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IHRoYXQuaGVhZGVyLnNvcnROYW1lc1tpbmRleF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBhYSA9IGdldEl0ZW1GaWVsZChhLCBuYW1lLCB0aGF0Lm9wdGlvbnMuZXNjYXBlKSxcbiAgICAgICAgICAgICAgICAgICAgYmIgPSBnZXRJdGVtRmllbGQoYiwgbmFtZSwgdGhhdC5vcHRpb25zLmVzY2FwZSksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gY2FsY3VsYXRlT2JqZWN0VmFsdWUodGhhdC5oZWFkZXIsIHRoYXQuaGVhZGVyLnNvcnRlcnNbaW5kZXhdLCBbYWEsIGJiXSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXIgKiB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBGaXggIzE2MTogdW5kZWZpbmVkIG9yIG51bGwgc3RyaW5nIHNvcnQgYnVnLlxuICAgICAgICAgICAgICAgIGlmIChhYSA9PT0gdW5kZWZpbmVkIHx8IGFhID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGFhID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChiYiA9PT0gdW5kZWZpbmVkIHx8IGJiID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGJiID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5zb3J0U3RhYmxlICYmIGFhID09PSBiYikge1xuICAgICAgICAgICAgICAgICAgICBhYSA9IGEuX3Bvc2l0aW9uO1xuICAgICAgICAgICAgICAgICAgICBiYiA9IGIuX3Bvc2l0aW9uO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIElGIGJvdGggdmFsdWVzIGFyZSBudW1lcmljLCBkbyBhIG51bWVyaWMgY29tcGFyaXNvblxuICAgICAgICAgICAgICAgIGlmICgkLmlzTnVtZXJpYyhhYSkgJiYgJC5pc051bWVyaWMoYmIpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENvbnZlcnQgbnVtZXJpY2FsIHZhbHVlcyBmb3JtIHN0cmluZyB0byBmbG9hdC5cbiAgICAgICAgICAgICAgICAgICAgYWEgPSBwYXJzZUZsb2F0KGFhKTtcbiAgICAgICAgICAgICAgICAgICAgYmIgPSBwYXJzZUZsb2F0KGJiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFhIDwgYmIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmRlciAqIC0xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmRlcjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoYWEgPT09IGJiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIElmIHZhbHVlIGlzIG5vdCBhIHN0cmluZywgY29udmVydCB0byBzdHJpbmdcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGFhICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBhYSA9IGFhLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGFhLmxvY2FsZUNvbXBhcmUoYmIpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXIgKiAtMTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUub25Tb3J0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciAkdGhpcyA9IGV2ZW50LnR5cGUgPT09IFwia2V5cHJlc3NcIiA/ICQoZXZlbnQuY3VycmVudFRhcmdldCkgOiAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLnBhcmVudCgpLFxuICAgICAgICAgICAgJHRoaXNfID0gdGhpcy4kaGVhZGVyLmZpbmQoJ3RoJykuZXEoJHRoaXMuaW5kZXgoKSk7XG5cbiAgICAgICAgdGhpcy4kaGVhZGVyLmFkZCh0aGlzLiRoZWFkZXJfKS5maW5kKCdzcGFuLm9yZGVyJykucmVtb3ZlKCk7XG5cbiAgICAgICAgdmFyIHNvcnROYW1lID0gJHRoaXMuZGF0YSgnZmllbGQnKTtcbiAgICAgICAgaWYoJHRoaXMuZGF0YSgnc29ydC1uYW1lJykpc29ydE5hbWUgPSAkdGhpcy5kYXRhKCdzb3J0LW5hbWUnKTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc29ydE5hbWUgPT09IHNvcnROYW1lKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuc29ydE9yZGVyID0gdGhpcy5vcHRpb25zLnNvcnRPcmRlciA9PT0gJ2FzYycgPyAnZGVzYycgOiAnYXNjJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5zb3J0TmFtZSA9IHNvcnROYW1lO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLnNvcnRPcmRlciA9ICR0aGlzLmRhdGEoJ29yZGVyJykgPT09ICdhc2MnID8gJ2Rlc2MnIDogJ2FzYyc7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50cmlnZ2VyKCdzb3J0JywgdGhpcy5vcHRpb25zLnNvcnROYW1lLCB0aGlzLm9wdGlvbnMuc29ydE9yZGVyKTtcblxuICAgICAgICAkdGhpcy5hZGQoJHRoaXNfKS5kYXRhKCdvcmRlcicsIHRoaXMub3B0aW9ucy5zb3J0T3JkZXIpO1xuXG4gICAgICAgIC8vIEFzc2lnbiB0aGUgY29ycmVjdCBzb3J0YWJsZSBhcnJvd1xuICAgICAgICB0aGlzLmdldENhcmV0KCk7XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zaWRlUGFnaW5hdGlvbiA9PT0gJ3NlcnZlcicpIHtcbiAgICAgICAgICAgIHRoaXMuaW5pdFNlcnZlcih0aGlzLm9wdGlvbnMuc2lsZW50U29ydCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmluaXRTb3J0KCk7XG4gICAgICAgIHRoaXMuaW5pdEJvZHkoKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmluaXRUb29sYmFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICBodG1sID0gW10sXG4gICAgICAgICAgICB0aW1lb3V0SWQgPSAwLFxuICAgICAgICAgICAgJGtlZXBPcGVuLFxuICAgICAgICAgICAgJHNlYXJjaCxcbiAgICAgICAgICAgIHN3aXRjaGFibGVDb3VudCA9IDA7XG5cbiAgICAgICAgaWYgKHRoaXMuJHRvb2xiYXIuZmluZCgnLmJzLWJhcnMnKS5jaGlsZHJlbigpLmxlbmd0aCkge1xuICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgkKHRoaXMub3B0aW9ucy50b29sYmFyKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy4kdG9vbGJhci5odG1sKCcnKTtcblxuICAgICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy50b29sYmFyID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdGhpcy5vcHRpb25zLnRvb2xiYXIgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAkKHNwcmludGYoJzxkaXYgY2xhc3M9XCJicy1iYXJzIHB1bGwtJXNcIj48L2Rpdj4nLCB0aGlzLm9wdGlvbnMudG9vbGJhckFsaWduKSlcbiAgICAgICAgICAgICAgICAuYXBwZW5kVG8odGhpcy4kdG9vbGJhcilcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCQodGhpcy5vcHRpb25zLnRvb2xiYXIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHNob3dDb2x1bW5zLCBzaG93VG9nZ2xlLCBzaG93UmVmcmVzaFxuICAgICAgICBodG1sID0gW3NwcmludGYoJzxkaXYgY2xhc3M9XCJjb2x1bW5zIGNvbHVtbnMtJXMgYnRuLWdyb3VwIHB1bGwtJXNcIj4nLFxuICAgICAgICAgICAgdGhpcy5vcHRpb25zLmJ1dHRvbnNBbGlnbiwgdGhpcy5vcHRpb25zLmJ1dHRvbnNBbGlnbildO1xuXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLmljb25zID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLmljb25zID0gY2FsY3VsYXRlT2JqZWN0VmFsdWUobnVsbCwgdGhpcy5vcHRpb25zLmljb25zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd1BhZ2luYXRpb25Td2l0Y2gpIHtcbiAgICAgICAgICAgIGh0bWwucHVzaChzcHJpbnRmKCc8YnV0dG9uIGNsYXNzPVwiYnRuJyArXG4gICAgICAgICAgICAgICAgICAgIHNwcmludGYoJyBidG4tJXMnLCB0aGlzLm9wdGlvbnMuYnV0dG9uc0NsYXNzKSArXG4gICAgICAgICAgICAgICAgICAgIHNwcmludGYoJyBidG4tJXMnLCB0aGlzLm9wdGlvbnMuaWNvblNpemUpICtcbiAgICAgICAgICAgICAgICAgICAgJ1wiIHR5cGU9XCJidXR0b25cIiBuYW1lPVwicGFnaW5hdGlvblN3aXRjaFwiIHRpdGxlPVwiJXNcIj4nLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuZm9ybWF0UGFnaW5hdGlvblN3aXRjaCgpKSxcbiAgICAgICAgICAgICAgICBzcHJpbnRmKCc8aSBjbGFzcz1cIiVzICVzXCI+PC9pPicsIHRoaXMub3B0aW9ucy5pY29uc1ByZWZpeCwgdGhpcy5vcHRpb25zLmljb25zLnBhZ2luYXRpb25Td2l0Y2hEb3duKSxcbiAgICAgICAgICAgICAgICAnPC9idXR0b24+Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNob3dSZWZyZXNoKSB7XG4gICAgICAgICAgICBodG1sLnB1c2goc3ByaW50ZignPGJ1dHRvbiBjbGFzcz1cImJ0bicgK1xuICAgICAgICAgICAgICAgICAgICBzcHJpbnRmKCcgYnRuLSVzJywgdGhpcy5vcHRpb25zLmJ1dHRvbnNDbGFzcykgK1xuICAgICAgICAgICAgICAgICAgICBzcHJpbnRmKCcgYnRuLSVzJywgdGhpcy5vcHRpb25zLmljb25TaXplKSArXG4gICAgICAgICAgICAgICAgICAgICdcIiB0eXBlPVwiYnV0dG9uXCIgbmFtZT1cInJlZnJlc2hcIiB0aXRsZT1cIiVzXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmZvcm1hdFJlZnJlc2goKSksXG4gICAgICAgICAgICAgICAgc3ByaW50ZignPGkgY2xhc3M9XCIlcyAlc1wiPjwvaT4nLCB0aGlzLm9wdGlvbnMuaWNvbnNQcmVmaXgsIHRoaXMub3B0aW9ucy5pY29ucy5yZWZyZXNoKSxcbiAgICAgICAgICAgICAgICAnPC9idXR0b24+Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNob3dUb2dnbGUpIHtcbiAgICAgICAgICAgIGh0bWwucHVzaChzcHJpbnRmKCc8YnV0dG9uIGNsYXNzPVwiYnRuJyArXG4gICAgICAgICAgICAgICAgICAgIHNwcmludGYoJyBidG4tJXMnLCB0aGlzLm9wdGlvbnMuYnV0dG9uc0NsYXNzKSArXG4gICAgICAgICAgICAgICAgICAgIHNwcmludGYoJyBidG4tJXMnLCB0aGlzLm9wdGlvbnMuaWNvblNpemUpICtcbiAgICAgICAgICAgICAgICAgICAgJ1wiIHR5cGU9XCJidXR0b25cIiBuYW1lPVwidG9nZ2xlXCIgdGl0bGU9XCIlc1wiPicsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5mb3JtYXRUb2dnbGUoKSksXG4gICAgICAgICAgICAgICAgc3ByaW50ZignPGkgY2xhc3M9XCIlcyAlc1wiPjwvaT4nLCB0aGlzLm9wdGlvbnMuaWNvbnNQcmVmaXgsIHRoaXMub3B0aW9ucy5pY29ucy50b2dnbGUpLFxuICAgICAgICAgICAgICAgICc8L2J1dHRvbj4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd0NvbHVtbnMpIHtcbiAgICAgICAgICAgIGh0bWwucHVzaChzcHJpbnRmKCc8ZGl2IGNsYXNzPVwia2VlcC1vcGVuIGJ0bi1ncm91cFwiIHRpdGxlPVwiJXNcIj4nLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuZm9ybWF0Q29sdW1ucygpKSxcbiAgICAgICAgICAgICAgICAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4nICtcbiAgICAgICAgICAgICAgICBzcHJpbnRmKCcgYnRuLSVzJywgdGhpcy5vcHRpb25zLmJ1dHRvbnNDbGFzcykgK1xuICAgICAgICAgICAgICAgIHNwcmludGYoJyBidG4tJXMnLCB0aGlzLm9wdGlvbnMuaWNvblNpemUpICtcbiAgICAgICAgICAgICAgICAnIGRyb3Bkb3duLXRvZ2dsZVwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIj4nLFxuICAgICAgICAgICAgICAgIHNwcmludGYoJzxpIGNsYXNzPVwiJXMgJXNcIj48L2k+JywgdGhpcy5vcHRpb25zLmljb25zUHJlZml4LCB0aGlzLm9wdGlvbnMuaWNvbnMuY29sdW1ucyksXG4gICAgICAgICAgICAgICAgJyA8c3BhbiBjbGFzcz1cImNhcmV0XCI+PC9zcGFuPicsXG4gICAgICAgICAgICAgICAgJzwvYnV0dG9uPicsXG4gICAgICAgICAgICAgICAgJzx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnVcIiByb2xlPVwibWVudVwiPicpO1xuXG4gICAgICAgICAgICAkLmVhY2godGhpcy5jb2x1bW5zLCBmdW5jdGlvbiAoaSwgY29sdW1uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5yYWRpbyB8fCBjb2x1bW4uY2hlY2tib3gpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuY2FyZFZpZXcgJiYgIWNvbHVtbi5jYXJkVmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrZWQgPSBjb2x1bW4udmlzaWJsZSA/ICcgY2hlY2tlZD1cImNoZWNrZWRcIicgOiAnJztcblxuICAgICAgICAgICAgICAgIGlmIChjb2x1bW4uc3dpdGNoYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICBodG1sLnB1c2goc3ByaW50ZignPGxpPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxsYWJlbD48aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgZGF0YS1maWVsZD1cIiVzXCIgdmFsdWU9XCIlc1wiJXM+ICVzPC9sYWJlbD4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L2xpPicsIGNvbHVtbi5maWVsZCwgaSwgY2hlY2tlZCwgY29sdW1uLnRpdGxlKSk7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaGFibGVDb3VudCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaHRtbC5wdXNoKCc8L3VsPicsXG4gICAgICAgICAgICAgICAgJzwvZGl2PicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaHRtbC5wdXNoKCc8L2Rpdj4nKTtcblxuICAgICAgICAvLyBGaXggIzE4ODogdGhpcy5zaG93VG9vbGJhciBpcyBmb3IgZXh0ZW5zaW9uc1xuICAgICAgICBpZiAodGhpcy5zaG93VG9vbGJhciB8fCBodG1sLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgIHRoaXMuJHRvb2xiYXIuYXBwZW5kKGh0bWwuam9pbignJykpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zaG93UGFnaW5hdGlvblN3aXRjaCkge1xuICAgICAgICAgICAgdGhpcy4kdG9vbGJhci5maW5kKCdidXR0b25bbmFtZT1cInBhZ2luYXRpb25Td2l0Y2hcIl0nKVxuICAgICAgICAgICAgICAgIC5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgJC5wcm94eSh0aGlzLnRvZ2dsZVBhZ2luYXRpb24sIHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd1JlZnJlc2gpIHtcbiAgICAgICAgICAgIHRoaXMuJHRvb2xiYXIuZmluZCgnYnV0dG9uW25hbWU9XCJyZWZyZXNoXCJdJylcbiAgICAgICAgICAgICAgICAub2ZmKCdjbGljaycpLm9uKCdjbGljaycsICQucHJveHkodGhpcy5yZWZyZXNoLCB0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNob3dUb2dnbGUpIHtcbiAgICAgICAgICAgIHRoaXMuJHRvb2xiYXIuZmluZCgnYnV0dG9uW25hbWU9XCJ0b2dnbGVcIl0nKVxuICAgICAgICAgICAgICAgIC5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnRvZ2dsZVZpZXcoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd0NvbHVtbnMpIHtcbiAgICAgICAgICAgICRrZWVwT3BlbiA9IHRoaXMuJHRvb2xiYXIuZmluZCgnLmtlZXAtb3BlbicpO1xuXG4gICAgICAgICAgICBpZiAoc3dpdGNoYWJsZUNvdW50IDw9IHRoaXMub3B0aW9ucy5taW5pbXVtQ291bnRDb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgJGtlZXBPcGVuLmZpbmQoJ2lucHV0JykucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJGtlZXBPcGVuLmZpbmQoJ2xpJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAka2VlcE9wZW4uZmluZCgnaW5wdXQnKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICB0aGF0LnRvZ2dsZUNvbHVtbigkKHRoaXMpLnZhbCgpLCAkdGhpcy5wcm9wKCdjaGVja2VkJyksIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGF0LnRyaWdnZXIoJ2NvbHVtbi1zd2l0Y2gnLCAkKHRoaXMpLmRhdGEoJ2ZpZWxkJyksICR0aGlzLnByb3AoJ2NoZWNrZWQnKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2VhcmNoKSB7XG4gICAgICAgICAgICBodG1sID0gW107XG4gICAgICAgICAgICBodG1sLnB1c2goXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJwdWxsLScgKyB0aGlzLm9wdGlvbnMuc2VhcmNoQWxpZ24gKyAnIHNlYXJjaFwiPicsXG4gICAgICAgICAgICAgICAgc3ByaW50ZignPGlucHV0IGNsYXNzPVwiZm9ybS1jb250cm9sJyArXG4gICAgICAgICAgICAgICAgICAgIHNwcmludGYoJyBpbnB1dC0lcycsIHRoaXMub3B0aW9ucy5pY29uU2l6ZSkgK1xuICAgICAgICAgICAgICAgICAgICAnXCIgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj1cIiVzXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmZvcm1hdFNlYXJjaCgpKSxcbiAgICAgICAgICAgICAgICAnPC9kaXY+Jyk7XG5cbiAgICAgICAgICAgIHRoaXMuJHRvb2xiYXIuYXBwZW5kKGh0bWwuam9pbignJykpO1xuICAgICAgICAgICAgJHNlYXJjaCA9IHRoaXMuJHRvb2xiYXIuZmluZCgnLnNlYXJjaCBpbnB1dCcpO1xuICAgICAgICAgICAgJHNlYXJjaC5vZmYoJ2tleXVwIGRyb3AnKS5vbigna2V5dXAgZHJvcCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuc2VhcmNoT25FbnRlcktleSAmJiBldmVudC5rZXlDb2RlICE9PSAxMykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShldmVudC5rZXlDb2RlLCBbMzcsIDM4LCAzOSwgNDBdKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTsgLy8gZG9lc24ndCBtYXR0ZXIgaWYgaXQncyAwXG4gICAgICAgICAgICAgICAgdGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQub25TZWFyY2goZXZlbnQpO1xuICAgICAgICAgICAgICAgIH0sIHRoYXQub3B0aW9ucy5zZWFyY2hUaW1lT3V0KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoaXNJRUJyb3dzZXIoKSkge1xuICAgICAgICAgICAgICAgICRzZWFyY2gub2ZmKCdtb3VzZXVwJykub24oJ21vdXNldXAnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7IC8vIGRvZXNuJ3QgbWF0dGVyIGlmIGl0J3MgMFxuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQub25TZWFyY2goZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9LCB0aGF0Lm9wdGlvbnMuc2VhcmNoVGltZU91dCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLm9uU2VhcmNoID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciB0ZXh0ID0gJC50cmltKCQoZXZlbnQuY3VycmVudFRhcmdldCkudmFsKCkpO1xuXG4gICAgICAgIC8vIHRyaW0gc2VhcmNoIGlucHV0XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMudHJpbU9uU2VhcmNoICYmICQoZXZlbnQuY3VycmVudFRhcmdldCkudmFsKCkgIT09IHRleHQpIHtcbiAgICAgICAgICAgICQoZXZlbnQuY3VycmVudFRhcmdldCkudmFsKHRleHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRleHQgPT09IHRoaXMuc2VhcmNoVGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2VhcmNoVGV4dCA9IHRleHQ7XG4gICAgICAgIHRoaXMub3B0aW9ucy5zZWFyY2hUZXh0ID0gdGV4dDtcblxuICAgICAgICB0aGlzLm9wdGlvbnMucGFnZU51bWJlciA9IDE7XG4gICAgICAgIHRoaXMuaW5pdFNlYXJjaCgpO1xuICAgICAgICB0aGlzLnVwZGF0ZVBhZ2luYXRpb24oKTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdzZWFyY2gnLCB0ZXh0KTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmluaXRTZWFyY2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNpZGVQYWdpbmF0aW9uICE9PSAnc2VydmVyJykge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jdXN0b21TZWFyY2ggIT09ICQubm9vcCkge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5jdXN0b21TZWFyY2guYXBwbHkodGhpcywgW3RoaXMuc2VhcmNoVGV4dF0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHMgPSB0aGlzLnNlYXJjaFRleHQgJiYgKHRoaXMub3B0aW9ucy5lc2NhcGUgP1xuICAgICAgICAgICAgICAgIGVzY2FwZUhUTUwodGhpcy5zZWFyY2hUZXh0KSA6IHRoaXMuc2VhcmNoVGV4dCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHZhciBmID0gJC5pc0VtcHR5T2JqZWN0KHRoaXMuZmlsdGVyQ29sdW1ucykgPyBudWxsIDogdGhpcy5maWx0ZXJDb2x1bW5zO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBmaWx0ZXJcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IGYgPyAkLmdyZXAodGhpcy5vcHRpb25zLmRhdGEsIGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGYpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNBcnJheShmW2tleV0pICYmICQuaW5BcnJheShpdGVtW2tleV0sIGZba2V5XSkgPT09IC0xIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVtrZXldICE9PSBmW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pIDogdGhpcy5vcHRpb25zLmRhdGE7XG5cbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IHMgPyAkLmdyZXAodGhpcy5kYXRhLCBmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhhdC5oZWFkZXIuZmllbGRzLmxlbmd0aDsgaisrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGF0LmhlYWRlci5zZWFyY2hhYmxlc1tqXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gJC5pc051bWVyaWModGhhdC5oZWFkZXIuZmllbGRzW2pdKSA/IHBhcnNlSW50KHRoYXQuaGVhZGVyLmZpZWxkc1tqXSwgMTApIDogdGhhdC5oZWFkZXIuZmllbGRzW2pdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sdW1uID0gdGhhdC5jb2x1bW5zW2dldEZpZWxkSW5kZXgodGhhdC5jb2x1bW5zLCBrZXkpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Yga2V5ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBpdGVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BzID0ga2V5LnNwbGl0KCcuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBwcm9wX2luZGV4ID0gMDsgcHJvcF9pbmRleCA8IHByb3BzLmxlbmd0aDsgcHJvcF9pbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZVtwcm9wc1twcm9wX2luZGV4XV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpeCAjMTQyOiByZXNwZWN0IHNlYXJjaEZvcmFtdHRlciBib29sZWFuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29sdW1uICYmIGNvbHVtbi5zZWFyY2hGb3JtYXR0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGNhbGN1bGF0ZU9iamVjdFZhbHVlKGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5oZWFkZXIuZm9ybWF0dGVyc1tqXSwgW3ZhbHVlLCBpdGVtLCBpXSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBpdGVtW2tleV07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLnN0cmljdFNlYXJjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgKyAnJykudG9Mb3dlckNhc2UoKSA9PT0gcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgKyAnJykudG9Mb3dlckNhc2UoKS5pbmRleE9mKHMpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSkgOiB0aGlzLmRhdGE7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmluaXRQYWdpbmF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5wYWdpbmF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLiRwYWdpbmF0aW9uLmhpZGUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuJHBhZ2luYXRpb24uc2hvdygpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgaHRtbCA9IFtdLFxuICAgICAgICAgICAgJGFsbFNlbGVjdGVkID0gZmFsc2UsXG4gICAgICAgICAgICBpLCBmcm9tLCB0byxcbiAgICAgICAgICAgICRwYWdlTGlzdCxcbiAgICAgICAgICAgICRmaXJzdCwgJHByZSxcbiAgICAgICAgICAgICRuZXh0LCAkbGFzdCxcbiAgICAgICAgICAgICRudW1iZXIsXG4gICAgICAgICAgICBkYXRhID0gdGhpcy5nZXREYXRhKCksXG4gICAgICAgICAgICBwYWdlTGlzdCA9IHRoaXMub3B0aW9ucy5wYWdlTGlzdDtcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNpZGVQYWdpbmF0aW9uICE9PSAnc2VydmVyJykge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLnRvdGFsUm93cyA9IGRhdGEubGVuZ3RoO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50b3RhbFBhZ2VzID0gMDtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy50b3RhbFJvd3MpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucGFnZVNpemUgPT09IHRoaXMub3B0aW9ucy5mb3JtYXRBbGxSb3dzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMucGFnZVNpemUgPSB0aGlzLm9wdGlvbnMudG90YWxSb3dzO1xuICAgICAgICAgICAgICAgICRhbGxTZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5wYWdlU2l6ZSA9PT0gdGhpcy5vcHRpb25zLnRvdGFsUm93cykge1xuICAgICAgICAgICAgICAgIC8vIEZpeCAjNjY3IFRhYmxlIHdpdGggcGFnaW5hdGlvbixcbiAgICAgICAgICAgICAgICAvLyBtdWx0aXBsZSBwYWdlcyBhbmQgYSBzZWFyY2ggdGhhdCBtYXRjaGVzIHRvIG9uZSBwYWdlIHRocm93cyBleGNlcHRpb25cbiAgICAgICAgICAgICAgICB2YXIgcGFnZUxzdCA9IHR5cGVvZiB0aGlzLm9wdGlvbnMucGFnZUxpc3QgPT09ICdzdHJpbmcnID9cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnBhZ2VMaXN0LnJlcGxhY2UoJ1snLCAnJykucmVwbGFjZSgnXScsICcnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyAvZywgJycpLnRvTG93ZXJDYXNlKCkuc3BsaXQoJywnKSA6IHRoaXMub3B0aW9ucy5wYWdlTGlzdDtcbiAgICAgICAgICAgICAgICBpZiAoJC5pbkFycmF5KHRoaXMub3B0aW9ucy5mb3JtYXRBbGxSb3dzKCkudG9Mb3dlckNhc2UoKSwgcGFnZUxzdCkgID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgJGFsbFNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudG90YWxQYWdlcyA9IH5+KCh0aGlzLm9wdGlvbnMudG90YWxSb3dzIC0gMSkgLyB0aGlzLm9wdGlvbnMucGFnZVNpemUpICsgMTtcblxuICAgICAgICAgICAgdGhpcy5vcHRpb25zLnRvdGFsUGFnZXMgPSB0aGlzLnRvdGFsUGFnZXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudG90YWxQYWdlcyA+IDAgJiYgdGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgPiB0aGlzLnRvdGFsUGFnZXMpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyID0gdGhpcy50b3RhbFBhZ2VzO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wYWdlRnJvbSA9ICh0aGlzLm9wdGlvbnMucGFnZU51bWJlciAtIDEpICogdGhpcy5vcHRpb25zLnBhZ2VTaXplICsgMTtcbiAgICAgICAgdGhpcy5wYWdlVG8gPSB0aGlzLm9wdGlvbnMucGFnZU51bWJlciAqIHRoaXMub3B0aW9ucy5wYWdlU2l6ZTtcbiAgICAgICAgaWYgKHRoaXMucGFnZVRvID4gdGhpcy5vcHRpb25zLnRvdGFsUm93cykge1xuICAgICAgICAgICAgdGhpcy5wYWdlVG8gPSB0aGlzLm9wdGlvbnMudG90YWxSb3dzO1xuICAgICAgICB9XG5cbiAgICAgICAgaHRtbC5wdXNoKFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJwdWxsLScgKyB0aGlzLm9wdGlvbnMucGFnaW5hdGlvbkRldGFpbEhBbGlnbiArICcgcGFnaW5hdGlvbi1kZXRhaWxcIj4nLFxuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwicGFnaW5hdGlvbi1pbmZvXCI+JyxcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbmx5SW5mb1BhZ2luYXRpb24gPyB0aGlzLm9wdGlvbnMuZm9ybWF0RGV0YWlsUGFnaW5hdGlvbih0aGlzLm9wdGlvbnMudG90YWxSb3dzKSA6XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuZm9ybWF0U2hvd2luZ1Jvd3ModGhpcy5wYWdlRnJvbSwgdGhpcy5wYWdlVG8sIHRoaXMub3B0aW9ucy50b3RhbFJvd3MpLFxuICAgICAgICAgICAgJzwvc3Bhbj4nKTtcblxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5vbmx5SW5mb1BhZ2luYXRpb24pIHtcbiAgICAgICAgICAgIGh0bWwucHVzaCgnPHNwYW4gY2xhc3M9XCJwYWdlLWxpc3RcIj4nKTtcblxuICAgICAgICAgICAgdmFyIHBhZ2VOdW1iZXIgPSBbXG4gICAgICAgICAgICAgICAgICAgIHNwcmludGYoJzxzcGFuIGNsYXNzPVwiYnRuLWdyb3VwICVzXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wYWdpbmF0aW9uVkFsaWduID09PSAndG9wJyB8fCB0aGlzLm9wdGlvbnMucGFnaW5hdGlvblZBbGlnbiA9PT0gJ2JvdGgnID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZHJvcGRvd24nIDogJ2Ryb3B1cCcpLFxuICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4nICtcbiAgICAgICAgICAgICAgICAgICAgc3ByaW50ZignIGJ0bi0lcycsIHRoaXMub3B0aW9ucy5idXR0b25zQ2xhc3MpICtcbiAgICAgICAgICAgICAgICAgICAgc3ByaW50ZignIGJ0bi0lcycsIHRoaXMub3B0aW9ucy5pY29uU2l6ZSkgK1xuICAgICAgICAgICAgICAgICAgICAnIGRyb3Bkb3duLXRvZ2dsZVwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJwYWdlLXNpemVcIj4nLFxuICAgICAgICAgICAgICAgICAgICAkYWxsU2VsZWN0ZWQgPyB0aGlzLm9wdGlvbnMuZm9ybWF0QWxsUm93cygpIDogdGhpcy5vcHRpb25zLnBhZ2VTaXplLFxuICAgICAgICAgICAgICAgICAgICAnPC9zcGFuPicsXG4gICAgICAgICAgICAgICAgICAgICcgPHNwYW4gY2xhc3M9XCJjYXJldFwiPjwvc3Bhbj4nLFxuICAgICAgICAgICAgICAgICAgICAnPC9idXR0b24+JyxcbiAgICAgICAgICAgICAgICAgICAgJzx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnVcIiByb2xlPVwibWVudVwiPidcbiAgICAgICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy5wYWdlTGlzdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMub3B0aW9ucy5wYWdlTGlzdC5yZXBsYWNlKCdbJywgJycpLnJlcGxhY2UoJ10nLCAnJylcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyAvZywgJycpLnNwbGl0KCcsJyk7XG5cbiAgICAgICAgICAgICAgICBwYWdlTGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgICQuZWFjaChsaXN0LCBmdW5jdGlvbiAoaSwgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZUxpc3QucHVzaCh2YWx1ZS50b1VwcGVyQ2FzZSgpID09PSB0aGF0Lm9wdGlvbnMuZm9ybWF0QWxsUm93cygpLnRvVXBwZXJDYXNlKCkgP1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5vcHRpb25zLmZvcm1hdEFsbFJvd3MoKSA6ICt2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQuZWFjaChwYWdlTGlzdCwgZnVuY3Rpb24gKGksIHBhZ2UpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoYXQub3B0aW9ucy5zbWFydERpc3BsYXkgfHwgaSA9PT0gMCB8fCBwYWdlTGlzdFtpIC0gMV0gPD0gdGhhdC5vcHRpb25zLnRvdGFsUm93cykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJGFsbFNlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmUgPSBwYWdlID09PSB0aGF0Lm9wdGlvbnMuZm9ybWF0QWxsUm93cygpID8gJyBjbGFzcz1cImFjdGl2ZVwiJyA6ICcnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gcGFnZSA9PT0gdGhhdC5vcHRpb25zLnBhZ2VTaXplID8gJyBjbGFzcz1cImFjdGl2ZVwiJyA6ICcnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHBhZ2VOdW1iZXIucHVzaChzcHJpbnRmKCc8bGklcz48YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCI+JXM8L2E+PC9saT4nLCBhY3RpdmUsIHBhZ2UpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHBhZ2VOdW1iZXIucHVzaCgnPC91bD48L3NwYW4+Jyk7XG5cbiAgICAgICAgICAgIGh0bWwucHVzaCh0aGlzLm9wdGlvbnMuZm9ybWF0UmVjb3Jkc1BlclBhZ2UocGFnZU51bWJlci5qb2luKCcnKSkpO1xuICAgICAgICAgICAgaHRtbC5wdXNoKCc8L3NwYW4+Jyk7XG5cbiAgICAgICAgICAgIGh0bWwucHVzaCgnPC9kaXY+JyxcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInB1bGwtJyArIHRoaXMub3B0aW9ucy5wYWdpbmF0aW9uSEFsaWduICsgJyBwYWdpbmF0aW9uXCI+JyxcbiAgICAgICAgICAgICAgICAnPHVsIGNsYXNzPVwicGFnaW5hdGlvbicgKyBzcHJpbnRmKCcgcGFnaW5hdGlvbi0lcycsIHRoaXMub3B0aW9ucy5pY29uU2l6ZSkgKyAnXCI+JyxcbiAgICAgICAgICAgICAgICAnPGxpIGNsYXNzPVwicGFnZS1wcmVcIj48YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCI+JyArIHRoaXMub3B0aW9ucy5wYWdpbmF0aW9uUHJlVGV4dCArICc8L2E+PC9saT4nKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMudG90YWxQYWdlcyA8IDUpIHtcbiAgICAgICAgICAgICAgICBmcm9tID0gMTtcbiAgICAgICAgICAgICAgICB0byA9IHRoaXMudG90YWxQYWdlcztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZnJvbSA9IHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyIC0gMjtcbiAgICAgICAgICAgICAgICB0byA9IGZyb20gKyA0O1xuICAgICAgICAgICAgICAgIGlmIChmcm9tIDwgMSkge1xuICAgICAgICAgICAgICAgICAgICBmcm9tID0gMTtcbiAgICAgICAgICAgICAgICAgICAgdG8gPSA1O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodG8gPiB0aGlzLnRvdGFsUGFnZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdG8gPSB0aGlzLnRvdGFsUGFnZXM7XG4gICAgICAgICAgICAgICAgICAgIGZyb20gPSB0byAtIDQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy50b3RhbFBhZ2VzID49IDYpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgPj0gMykge1xuICAgICAgICAgICAgICAgICAgICBodG1sLnB1c2goJzxsaSBjbGFzcz1cInBhZ2UtZmlyc3QnICsgKDEgPT09IHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyID8gJyBhY3RpdmUnIDogJycpICsgJ1wiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiPicsIDEsICc8L2E+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L2xpPicpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZyb20rKztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgPj0gNCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgPT0gNCB8fCB0aGlzLnRvdGFsUGFnZXMgPT0gNiB8fCB0aGlzLnRvdGFsUGFnZXMgPT0gNykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbS0tO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8bGkgY2xhc3M9XCJwYWdlLWZpcnN0LXNlcGFyYXRvciBkaXNhYmxlZFwiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIj4uLi48L2E+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9saT4nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHRvLS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy50b3RhbFBhZ2VzID49IDcpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgPj0gKHRoaXMudG90YWxQYWdlcyAtIDIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb20tLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnRvdGFsUGFnZXMgPT0gNikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucGFnZU51bWJlciA+PSAodGhpcy50b3RhbFBhZ2VzIC0gMikpIHtcbiAgICAgICAgICAgICAgICAgICAgdG8rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMudG90YWxQYWdlcyA+PSA3KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudG90YWxQYWdlcyA9PSA3IHx8IHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyID49ICh0aGlzLnRvdGFsUGFnZXMgLSAzKSkge1xuICAgICAgICAgICAgICAgICAgICB0bysrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yIChpID0gZnJvbTsgaSA8PSB0bzsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8bGkgY2xhc3M9XCJwYWdlLW51bWJlcicgKyAoaSA9PT0gdGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgPyAnIGFjdGl2ZScgOiAnJykgKyAnXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIj4nLCBpLCAnPC9hPicsXG4gICAgICAgICAgICAgICAgICAgICc8L2xpPicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy50b3RhbFBhZ2VzID49IDgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgPD0gKHRoaXMudG90YWxQYWdlcyAtIDQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPGxpIGNsYXNzPVwicGFnZS1sYXN0LXNlcGFyYXRvciBkaXNhYmxlZFwiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiPi4uLjwvYT4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzwvbGk+Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy50b3RhbFBhZ2VzID49IDYpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgPD0gKHRoaXMudG90YWxQYWdlcyAtIDMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPGxpIGNsYXNzPVwicGFnZS1sYXN0JyArICh0aGlzLnRvdGFsUGFnZXMgPT09IHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyID8gJyBhY3RpdmUnIDogJycpICsgJ1wiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiPicsIHRoaXMudG90YWxQYWdlcywgJzwvYT4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzwvbGk+Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBodG1sLnB1c2goXG4gICAgICAgICAgICAgICAgJzxsaSBjbGFzcz1cInBhZ2UtbmV4dFwiPjxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIj4nICsgdGhpcy5vcHRpb25zLnBhZ2luYXRpb25OZXh0VGV4dCArICc8L2E+PC9saT4nLFxuICAgICAgICAgICAgICAgICc8L3VsPicsXG4gICAgICAgICAgICAgICAgJzwvZGl2PicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuJHBhZ2luYXRpb24uaHRtbChodG1sLmpvaW4oJycpKTtcblxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5vbmx5SW5mb1BhZ2luYXRpb24pIHtcbiAgICAgICAgICAgICRwYWdlTGlzdCA9IHRoaXMuJHBhZ2luYXRpb24uZmluZCgnLnBhZ2UtbGlzdCBhJyk7XG4gICAgICAgICAgICAkZmlyc3QgPSB0aGlzLiRwYWdpbmF0aW9uLmZpbmQoJy5wYWdlLWZpcnN0Jyk7XG4gICAgICAgICAgICAkcHJlID0gdGhpcy4kcGFnaW5hdGlvbi5maW5kKCcucGFnZS1wcmUnKTtcbiAgICAgICAgICAgICRuZXh0ID0gdGhpcy4kcGFnaW5hdGlvbi5maW5kKCcucGFnZS1uZXh0Jyk7XG4gICAgICAgICAgICAkbGFzdCA9IHRoaXMuJHBhZ2luYXRpb24uZmluZCgnLnBhZ2UtbGFzdCcpO1xuICAgICAgICAgICAgJG51bWJlciA9IHRoaXMuJHBhZ2luYXRpb24uZmluZCgnLnBhZ2UtbnVtYmVyJyk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc21hcnREaXNwbGF5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudG90YWxQYWdlcyA8PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJHBhZ2luYXRpb24uZmluZCgnZGl2LnBhZ2luYXRpb24nKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwYWdlTGlzdC5sZW5ndGggPCAyIHx8IHRoaXMub3B0aW9ucy50b3RhbFJvd3MgPD0gcGFnZUxpc3RbMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcGFnaW5hdGlvbi5maW5kKCdzcGFuLnBhZ2UtbGlzdCcpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyB3aGVuIGRhdGEgaXMgZW1wdHksIGhpZGUgdGhlIHBhZ2luYXRpb25cbiAgICAgICAgICAgICAgICB0aGlzLiRwYWdpbmF0aW9uW3RoaXMuZ2V0RGF0YSgpLmxlbmd0aCA/ICdzaG93JyA6ICdoaWRlJ10oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkYWxsU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMucGFnZVNpemUgPSB0aGlzLm9wdGlvbnMuZm9ybWF0QWxsUm93cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHBhZ2VMaXN0Lm9mZignY2xpY2snKS5vbignY2xpY2snLCAkLnByb3h5KHRoaXMub25QYWdlTGlzdENoYW5nZSwgdGhpcykpO1xuICAgICAgICAgICAgJGZpcnN0Lm9mZignY2xpY2snKS5vbignY2xpY2snLCAkLnByb3h5KHRoaXMub25QYWdlRmlyc3QsIHRoaXMpKTtcbiAgICAgICAgICAgICRwcmUub2ZmKCdjbGljaycpLm9uKCdjbGljaycsICQucHJveHkodGhpcy5vblBhZ2VQcmUsIHRoaXMpKTtcbiAgICAgICAgICAgICRuZXh0Lm9mZignY2xpY2snKS5vbignY2xpY2snLCAkLnByb3h5KHRoaXMub25QYWdlTmV4dCwgdGhpcykpO1xuICAgICAgICAgICAgJGxhc3Qub2ZmKCdjbGljaycpLm9uKCdjbGljaycsICQucHJveHkodGhpcy5vblBhZ2VMYXN0LCB0aGlzKSk7XG4gICAgICAgICAgICAkbnVtYmVyLm9mZignY2xpY2snKS5vbignY2xpY2snLCAkLnByb3h5KHRoaXMub25QYWdlTnVtYmVyLCB0aGlzKSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnVwZGF0ZVBhZ2luYXRpb24gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy8gRml4ICMxNzE6IElFIGRpc2FibGVkIGJ1dHRvbiBjYW4gYmUgY2xpY2tlZCBidWcuXG4gICAgICAgIGlmIChldmVudCAmJiAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5tYWludGFpblNlbGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0Um93cygpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pbml0UGFnaW5hdGlvbigpO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNpZGVQYWdpbmF0aW9uID09PSAnc2VydmVyJykge1xuICAgICAgICAgICAgdGhpcy5pbml0U2VydmVyKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmluaXRCb2R5KCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ3BhZ2UtY2hhbmdlJywgdGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIsIHRoaXMub3B0aW9ucy5wYWdlU2l6ZSk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5vblBhZ2VMaXN0Q2hhbmdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciAkdGhpcyA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG5cbiAgICAgICAgJHRoaXMucGFyZW50KCkuYWRkQ2xhc3MoJ2FjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB0aGlzLm9wdGlvbnMucGFnZVNpemUgPSAkdGhpcy50ZXh0KCkudG9VcHBlckNhc2UoKSA9PT0gdGhpcy5vcHRpb25zLmZvcm1hdEFsbFJvd3MoKS50b1VwcGVyQ2FzZSgpID9cbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5mb3JtYXRBbGxSb3dzKCkgOiArJHRoaXMudGV4dCgpO1xuICAgICAgICB0aGlzLiR0b29sYmFyLmZpbmQoJy5wYWdlLXNpemUnKS50ZXh0KHRoaXMub3B0aW9ucy5wYWdlU2l6ZSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVQYWdpbmF0aW9uKGV2ZW50KTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLm9uUGFnZUZpcnN0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyID0gMTtcbiAgICAgICAgdGhpcy51cGRhdGVQYWdpbmF0aW9uKGV2ZW50KTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLm9uUGFnZVByZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAoKHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyIC0gMSkgPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyID0gdGhpcy5vcHRpb25zLnRvdGFsUGFnZXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMucGFnZU51bWJlci0tO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlUGFnaW5hdGlvbihldmVudCk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5vblBhZ2VOZXh0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmICgodGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgKyAxKSA+IHRoaXMub3B0aW9ucy50b3RhbFBhZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMucGFnZU51bWJlciA9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMucGFnZU51bWJlcisrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlUGFnaW5hdGlvbihldmVudCk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5vblBhZ2VMYXN0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyID0gdGhpcy50b3RhbFBhZ2VzO1xuICAgICAgICB0aGlzLnVwZGF0ZVBhZ2luYXRpb24oZXZlbnQpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUub25QYWdlTnVtYmVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucGFnZU51bWJlciA9PT0gKyQoZXZlbnQuY3VycmVudFRhcmdldCkudGV4dCgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgPSArJChldmVudC5jdXJyZW50VGFyZ2V0KS50ZXh0KCk7XG4gICAgICAgIHRoaXMudXBkYXRlUGFnaW5hdGlvbihldmVudCk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5pbml0Qm9keSA9IGZ1bmN0aW9uIChmaXhlZFNjcm9sbCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICBodG1sID0gW10sXG4gICAgICAgICAgICBkYXRhID0gdGhpcy5nZXREYXRhKCk7XG5cbiAgICAgICAgdGhpcy50cmlnZ2VyKCdwcmUtYm9keScsIGRhdGEpO1xuXG4gICAgICAgIHRoaXMuJGJvZHkgPSB0aGlzLiRlbC5maW5kKCc+dGJvZHknKTtcbiAgICAgICAgaWYgKCF0aGlzLiRib2R5Lmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy4kYm9keSA9ICQoJzx0Ym9keT48L3Rib2R5PicpLmFwcGVuZFRvKHRoaXMuJGVsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vRml4ICMzODkgQm9vdHN0cmFwLXRhYmxlLWZsYXRKU09OIGlzIG5vdCB3b3JraW5nXG5cbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMucGFnaW5hdGlvbiB8fCB0aGlzLm9wdGlvbnMuc2lkZVBhZ2luYXRpb24gPT09ICdzZXJ2ZXInKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2VGcm9tID0gMTtcbiAgICAgICAgICAgIHRoaXMucGFnZVRvID0gZGF0YS5sZW5ndGg7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5wYWdlRnJvbSAtIDE7IGkgPCB0aGlzLnBhZ2VUbzsgaSsrKSB7XG4gICAgICAgICAgICB2YXIga2V5LFxuICAgICAgICAgICAgICAgIGl0ZW0gPSBkYXRhW2ldLFxuICAgICAgICAgICAgICAgIHN0eWxlID0ge30sXG4gICAgICAgICAgICAgICAgY3NzZXMgPSBbXSxcbiAgICAgICAgICAgICAgICBkYXRhXyA9ICcnLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSB7fSxcbiAgICAgICAgICAgICAgICBodG1sQXR0cmlidXRlcyA9IFtdO1xuXG4gICAgICAgICAgICBzdHlsZSA9IGNhbGN1bGF0ZU9iamVjdFZhbHVlKHRoaXMub3B0aW9ucywgdGhpcy5vcHRpb25zLnJvd1N0eWxlLCBbaXRlbSwgaV0sIHN0eWxlKTtcblxuICAgICAgICAgICAgaWYgKHN0eWxlICYmIHN0eWxlLmNzcykge1xuICAgICAgICAgICAgICAgIGZvciAoa2V5IGluIHN0eWxlLmNzcykge1xuICAgICAgICAgICAgICAgICAgICBjc3Nlcy5wdXNoKGtleSArICc6ICcgKyBzdHlsZS5jc3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhdHRyaWJ1dGVzID0gY2FsY3VsYXRlT2JqZWN0VmFsdWUodGhpcy5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5yb3dBdHRyaWJ1dGVzLCBbaXRlbSwgaV0sIGF0dHJpYnV0ZXMpO1xuXG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGZvciAoa2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbEF0dHJpYnV0ZXMucHVzaChzcHJpbnRmKCclcz1cIiVzXCInLCBrZXksIGVzY2FwZUhUTUwoYXR0cmlidXRlc1trZXldKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGl0ZW0uX2RhdGEgJiYgISQuaXNFbXB0eU9iamVjdChpdGVtLl9kYXRhKSkge1xuICAgICAgICAgICAgICAgICQuZWFjaChpdGVtLl9kYXRhLCBmdW5jdGlvbiAoaywgdikge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgZGF0YS1pbmRleFxuICAgICAgICAgICAgICAgICAgICBpZiAoayA9PT0gJ2luZGV4Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRhdGFfICs9IHNwcmludGYoJyBkYXRhLSVzPVwiJXNcIicsIGssIHYpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBodG1sLnB1c2goJzx0cicsXG4gICAgICAgICAgICAgICAgc3ByaW50ZignICVzJywgaHRtbEF0dHJpYnV0ZXMuam9pbignICcpKSxcbiAgICAgICAgICAgICAgICBzcHJpbnRmKCcgaWQ9XCIlc1wiJywgJC5pc0FycmF5KGl0ZW0pID8gdW5kZWZpbmVkIDogaXRlbS5faWQpLFxuICAgICAgICAgICAgICAgIHNwcmludGYoJyBjbGFzcz1cIiVzXCInLCBzdHlsZS5jbGFzc2VzIHx8ICgkLmlzQXJyYXkoaXRlbSkgPyB1bmRlZmluZWQgOiBpdGVtLl9jbGFzcykpLFxuICAgICAgICAgICAgICAgIHNwcmludGYoJyBkYXRhLWluZGV4PVwiJXNcIicsIGkpLFxuICAgICAgICAgICAgICAgIHNwcmludGYoJyBkYXRhLXVuaXF1ZWlkPVwiJXNcIicsIGl0ZW1bdGhpcy5vcHRpb25zLnVuaXF1ZUlkXSksXG4gICAgICAgICAgICAgICAgc3ByaW50ZignJXMnLCBkYXRhXyksXG4gICAgICAgICAgICAgICAgJz4nXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNhcmRWaWV3KSB7XG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKHNwcmludGYoJzx0ZCBjb2xzcGFuPVwiJXNcIj48ZGl2IGNsYXNzPVwiY2FyZC12aWV3c1wiPicsIHRoaXMuaGVhZGVyLmZpZWxkcy5sZW5ndGgpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuY2FyZFZpZXcgJiYgdGhpcy5vcHRpb25zLmRldGFpbFZpZXcpIHtcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goJzx0ZD4nLFxuICAgICAgICAgICAgICAgICAgICAnPGEgY2xhc3M9XCJkZXRhaWwtaWNvblwiIGhyZWY9XCJqYXZhc2NyaXB0OlwiPicsXG4gICAgICAgICAgICAgICAgICAgIHNwcmludGYoJzxpIGNsYXNzPVwiJXMgJXNcIj48L2k+JywgdGhpcy5vcHRpb25zLmljb25zUHJlZml4LCB0aGlzLm9wdGlvbnMuaWNvbnMuZGV0YWlsT3BlbiksXG4gICAgICAgICAgICAgICAgICAgICc8L2E+JyxcbiAgICAgICAgICAgICAgICAgICAgJzwvdGQ+Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQuZWFjaCh0aGlzLmhlYWRlci5maWVsZHMsIGZ1bmN0aW9uIChqLCBmaWVsZCkge1xuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gJycsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZ2V0SXRlbUZpZWxkKGl0ZW0sIGZpZWxkLCB0aGF0Lm9wdGlvbnMuZXNjYXBlKSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICcnLFxuICAgICAgICAgICAgICAgICAgICBjZWxsU3R5bGUgPSB7fSxcbiAgICAgICAgICAgICAgICAgICAgaWRfID0gJycsXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzXyA9IHRoYXQuaGVhZGVyLmNsYXNzZXNbal0sXG4gICAgICAgICAgICAgICAgICAgIGRhdGFfID0gJycsXG4gICAgICAgICAgICAgICAgICAgIHJvd3NwYW5fID0gJycsXG4gICAgICAgICAgICAgICAgICAgIGNvbHNwYW5fID0gJycsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlXyA9ICcnLFxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gPSB0aGF0LmNvbHVtbnNbal07XG5cbiAgICAgICAgICAgICAgICBpZiAodGhhdC5mcm9tSHRtbCAmJiB0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWNvbHVtbi52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmNhcmRWaWV3ICYmICFjb2x1bW4uY2FyZFZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHN0eWxlID0gc3ByaW50Zignc3R5bGU9XCIlc1wiJywgY3NzZXMuY29uY2F0KHRoYXQuaGVhZGVyLnN0eWxlc1tqXSkuam9pbignOyAnKSk7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGQncyBpZCBhbmQgY2xhc3NcbiAgICAgICAgICAgICAgICBpZiAoaXRlbVsnXycgKyBmaWVsZCArICdfaWQnXSkge1xuICAgICAgICAgICAgICAgICAgICBpZF8gPSBzcHJpbnRmKCcgaWQ9XCIlc1wiJywgaXRlbVsnXycgKyBmaWVsZCArICdfaWQnXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpdGVtWydfJyArIGZpZWxkICsgJ19jbGFzcyddKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzXyA9IHNwcmludGYoJyBjbGFzcz1cIiVzXCInLCBpdGVtWydfJyArIGZpZWxkICsgJ19jbGFzcyddKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW1bJ18nICsgZmllbGQgKyAnX3Jvd3NwYW4nXSkge1xuICAgICAgICAgICAgICAgICAgICByb3dzcGFuXyA9IHNwcmludGYoJyByb3dzcGFuPVwiJXNcIicsIGl0ZW1bJ18nICsgZmllbGQgKyAnX3Jvd3NwYW4nXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpdGVtWydfJyArIGZpZWxkICsgJ19jb2xzcGFuJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgY29sc3Bhbl8gPSBzcHJpbnRmKCcgY29sc3Bhbj1cIiVzXCInLCBpdGVtWydfJyArIGZpZWxkICsgJ19jb2xzcGFuJ10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXRlbVsnXycgKyBmaWVsZCArICdfdGl0bGUnXSkge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZV8gPSBzcHJpbnRmKCcgdGl0bGU9XCIlc1wiJywgaXRlbVsnXycgKyBmaWVsZCArICdfdGl0bGUnXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNlbGxTdHlsZSA9IGNhbGN1bGF0ZU9iamVjdFZhbHVlKHRoYXQuaGVhZGVyLFxuICAgICAgICAgICAgICAgICAgICB0aGF0LmhlYWRlci5jZWxsU3R5bGVzW2pdLCBbdmFsdWUsIGl0ZW0sIGksIGZpZWxkXSwgY2VsbFN0eWxlKTtcbiAgICAgICAgICAgICAgICBpZiAoY2VsbFN0eWxlLmNsYXNzZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NfID0gc3ByaW50ZignIGNsYXNzPVwiJXNcIicsIGNlbGxTdHlsZS5jbGFzc2VzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNlbGxTdHlsZS5jc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNzc2VzXyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gY2VsbFN0eWxlLmNzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3NzZXNfLnB1c2goa2V5ICsgJzogJyArIGNlbGxTdHlsZS5jc3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3R5bGUgPSBzcHJpbnRmKCdzdHlsZT1cIiVzXCInLCBjc3Nlc18uY29uY2F0KHRoYXQuaGVhZGVyLnN0eWxlc1tqXSkuam9pbignOyAnKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBjYWxjdWxhdGVPYmplY3RWYWx1ZShjb2x1bW4sXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaGVhZGVyLmZvcm1hdHRlcnNbal0sIFt2YWx1ZSwgaXRlbSwgaV0sIHZhbHVlKTtcblxuICAgICAgICAgICAgICAgIGlmIChpdGVtWydfJyArIGZpZWxkICsgJ19kYXRhJ10gJiYgISQuaXNFbXB0eU9iamVjdChpdGVtWydfJyArIGZpZWxkICsgJ19kYXRhJ10pKSB7XG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChpdGVtWydfJyArIGZpZWxkICsgJ19kYXRhJ10sIGZ1bmN0aW9uIChrLCB2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgZGF0YS1pbmRleFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGsgPT09ICdpbmRleCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhXyArPSBzcHJpbnRmKCcgZGF0YS0lcz1cIiVzXCInLCBrLCB2KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5jaGVja2JveCB8fCBjb2x1bW4ucmFkaW8pIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IGNvbHVtbi5jaGVja2JveCA/ICdjaGVja2JveCcgOiB0eXBlO1xuICAgICAgICAgICAgICAgICAgICB0eXBlID0gY29sdW1uLnJhZGlvID8gJ3JhZGlvJyA6IHR5cGU7XG5cbiAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFtzcHJpbnRmKHRoYXQub3B0aW9ucy5jYXJkVmlldyA/XG4gICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNhcmQtdmlldyAlc1wiPicgOiAnPHRkIGNsYXNzPVwiYnMtY2hlY2tib3ggJXNcIj4nLCBjb2x1bW5bJ2NsYXNzJ10gfHwgJycpLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxpbnB1dCcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ByaW50ZignIGRhdGEtaW5kZXg9XCIlc1wiJywgaSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ByaW50ZignIG5hbWU9XCIlc1wiJywgdGhhdC5vcHRpb25zLnNlbGVjdEl0ZW1OYW1lKSArXG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpbnRmKCcgdHlwZT1cIiVzXCInLCB0eXBlKSArXG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpbnRmKCcgdmFsdWU9XCIlc1wiJywgaXRlbVt0aGF0Lm9wdGlvbnMuaWRGaWVsZF0pICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwcmludGYoJyBjaGVja2VkPVwiJXNcIicsIHZhbHVlID09PSB0cnVlIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAodmFsdWUgJiYgdmFsdWUuY2hlY2tlZCkgPyAnY2hlY2tlZCcgOiB1bmRlZmluZWQpICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwcmludGYoJyBkaXNhYmxlZD1cIiVzXCInLCAhY29sdW1uLmNoZWNrYm94RW5hYmxlZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlICYmIHZhbHVlLmRpc2FibGVkKSA/ICdkaXNhYmxlZCcgOiB1bmRlZmluZWQpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICcgLz4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5oZWFkZXIuZm9ybWF0dGVyc1tqXSAmJiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnID8gdmFsdWUgOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQub3B0aW9ucy5jYXJkVmlldyA/ICc8L2Rpdj4nIDogJzwvdGQ+J1xuICAgICAgICAgICAgICAgICAgICBdLmpvaW4oJycpO1xuXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1bdGhhdC5oZWFkZXIuc3RhdGVGaWVsZF0gPSB2YWx1ZSA9PT0gdHJ1ZSB8fCAodmFsdWUgJiYgdmFsdWUuY2hlY2tlZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IHZhbHVlID09PSBudWxsID9cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQub3B0aW9ucy51bmRlZmluZWRUZXh0IDogdmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgdGV4dCA9IHRoYXQub3B0aW9ucy5jYXJkVmlldyA/IFsnPGRpdiBjbGFzcz1cImNhcmQtdmlld1wiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0Lm9wdGlvbnMuc2hvd0hlYWRlciA/IHNwcmludGYoJzxzcGFuIGNsYXNzPVwidGl0bGVcIiAlcz4lczwvc3Bhbj4nLCBzdHlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRQcm9wZXJ0eUZyb21PdGhlcih0aGF0LmNvbHVtbnMsICdmaWVsZCcsICd0aXRsZScsIGZpZWxkKSkgOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwcmludGYoJzxzcGFuIGNsYXNzPVwidmFsdWVcIj4lczwvc3Bhbj4nLCB2YWx1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+J1xuICAgICAgICAgICAgICAgICAgICBdLmpvaW4oJycpIDogW3NwcmludGYoJzx0ZCVzICVzICVzICVzICVzICVzICVzPicsXG4gICAgICAgICAgICAgICAgICAgICAgICBpZF8sIGNsYXNzXywgc3R5bGUsIGRhdGFfLCByb3dzcGFuXywgY29sc3Bhbl8sIHRpdGxlXyksXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L3RkPidcbiAgICAgICAgICAgICAgICAgICAgXS5qb2luKCcnKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBIaWRlIGVtcHR5IGRhdGEgb24gQ2FyZCB2aWV3IHdoZW4gc21hcnREaXNwbGF5IGlzIHNldCB0byB0cnVlLlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmNhcmRWaWV3ICYmIHRoYXQub3B0aW9ucy5zbWFydERpc3BsYXkgJiYgdmFsdWUgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTaG91bGQgc2V0IGEgcGxhY2Vob2xkZXIgZm9yIGV2ZW50IGJpbmRpbmcgY29ycmVjdCBmaWVsZEluZGV4XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gJzxkaXYgY2xhc3M9XCJjYXJkLXZpZXdcIj48L2Rpdj4nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKHRleHQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY2FyZFZpZXcpIHtcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goJzwvZGl2PjwvdGQ+Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGh0bWwucHVzaCgnPC90cj4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHNob3cgbm8gcmVjb3Jkc1xuICAgICAgICBpZiAoIWh0bWwubGVuZ3RoKSB7XG4gICAgICAgICAgICBodG1sLnB1c2goJzx0ciBjbGFzcz1cIm5vLXJlY29yZHMtZm91bmRcIj4nLFxuICAgICAgICAgICAgICAgIHNwcmludGYoJzx0ZCBjb2xzcGFuPVwiJXNcIj4lczwvdGQ+JyxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kaGVhZGVyLmZpbmQoJ3RoJykubGVuZ3RoLCB0aGlzLm9wdGlvbnMuZm9ybWF0Tm9NYXRjaGVzKCkpLFxuICAgICAgICAgICAgICAgICc8L3RyPicpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4kYm9keS5odG1sKGh0bWwuam9pbignJykpO1xuXG4gICAgICAgIGlmICghZml4ZWRTY3JvbGwpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG8oMCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjbGljayB0byBzZWxlY3QgYnkgY29sdW1uXG4gICAgICAgIHRoaXMuJGJvZHkuZmluZCgnPiB0cltkYXRhLWluZGV4XSA+IHRkJykub2ZmKCdjbGljayBkYmxjbGljaycpLm9uKCdjbGljayBkYmxjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgJHRkID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAkdHIgPSAkdGQucGFyZW50KCksXG4gICAgICAgICAgICAgICAgaXRlbSA9IHRoYXQuZGF0YVskdHIuZGF0YSgnaW5kZXgnKV0sXG4gICAgICAgICAgICAgICAgaW5kZXggPSAkdGRbMF0uY2VsbEluZGV4LFxuICAgICAgICAgICAgICAgIGZpZWxkcyA9IHRoYXQuZ2V0VmlzaWJsZUZpZWxkcygpLFxuICAgICAgICAgICAgICAgIGZpZWxkID0gZmllbGRzW3RoYXQub3B0aW9ucy5kZXRhaWxWaWV3ICYmICF0aGF0Lm9wdGlvbnMuY2FyZFZpZXcgPyBpbmRleCAtIDEgOiBpbmRleF0sXG4gICAgICAgICAgICAgICAgY29sdW1uID0gdGhhdC5jb2x1bW5zW2dldEZpZWxkSW5kZXgodGhhdC5jb2x1bW5zLCBmaWVsZCldLFxuICAgICAgICAgICAgICAgIHZhbHVlID0gZ2V0SXRlbUZpZWxkKGl0ZW0sIGZpZWxkLCB0aGF0Lm9wdGlvbnMuZXNjYXBlKTtcblxuICAgICAgICAgICAgaWYgKCR0ZC5maW5kKCcuZGV0YWlsLWljb24nKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoYXQudHJpZ2dlcihlLnR5cGUgPT09ICdjbGljaycgPyAnY2xpY2stY2VsbCcgOiAnZGJsLWNsaWNrLWNlbGwnLCBmaWVsZCwgdmFsdWUsIGl0ZW0sICR0ZCk7XG4gICAgICAgICAgICB0aGF0LnRyaWdnZXIoZS50eXBlID09PSAnY2xpY2snID8gJ2NsaWNrLXJvdycgOiAnZGJsLWNsaWNrLXJvdycsIGl0ZW0sICR0ciwgZmllbGQpO1xuXG4gICAgICAgICAgICAvLyBpZiBjbGljayB0byBzZWxlY3QgLSB0aGVuIHRyaWdnZXIgdGhlIGNoZWNrYm94L3JhZGlvIGNsaWNrXG4gICAgICAgICAgICBpZiAoZS50eXBlID09PSAnY2xpY2snICYmIHRoYXQub3B0aW9ucy5jbGlja1RvU2VsZWN0ICYmIGNvbHVtbi5jbGlja1RvU2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyICRzZWxlY3RJdGVtID0gJHRyLmZpbmQoc3ByaW50ZignW25hbWU9XCIlc1wiXScsIHRoYXQub3B0aW9ucy5zZWxlY3RJdGVtTmFtZSkpO1xuICAgICAgICAgICAgICAgIGlmICgkc2VsZWN0SXRlbS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNlbGVjdEl0ZW1bMF0uY2xpY2soKTsgLy8gIzE0NDogLnRyaWdnZXIoJ2NsaWNrJykgYnVnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLiRib2R5LmZpbmQoJz4gdHJbZGF0YS1pbmRleF0gPiB0ZCA+IC5kZXRhaWwtaWNvbicpLm9mZignY2xpY2snKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICR0ciA9ICR0aGlzLnBhcmVudCgpLnBhcmVudCgpLFxuICAgICAgICAgICAgICAgIGluZGV4ID0gJHRyLmRhdGEoJ2luZGV4JyksXG4gICAgICAgICAgICAgICAgcm93ID0gZGF0YVtpbmRleF07IC8vIEZpeCAjOTgwIERldGFpbCB2aWV3LCB3aGVuIHNlYXJjaGluZywgcmV0dXJucyB3cm9uZyByb3dcblxuICAgICAgICAgICAgLy8gcmVtb3ZlIGFuZCB1cGRhdGVcbiAgICAgICAgICAgIGlmICgkdHIubmV4dCgpLmlzKCd0ci5kZXRhaWwtdmlldycpKSB7XG4gICAgICAgICAgICAgICAgJHRoaXMuZmluZCgnaScpLmF0dHIoJ2NsYXNzJywgc3ByaW50ZignJXMgJXMnLCB0aGF0Lm9wdGlvbnMuaWNvbnNQcmVmaXgsIHRoYXQub3B0aW9ucy5pY29ucy5kZXRhaWxPcGVuKSk7XG4gICAgICAgICAgICAgICAgJHRyLm5leHQoKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB0aGF0LnRyaWdnZXIoJ2NvbGxhcHNlLXJvdycsIGluZGV4LCByb3cpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkdGhpcy5maW5kKCdpJykuYXR0cignY2xhc3MnLCBzcHJpbnRmKCclcyAlcycsIHRoYXQub3B0aW9ucy5pY29uc1ByZWZpeCwgdGhhdC5vcHRpb25zLmljb25zLmRldGFpbENsb3NlKSk7XG4gICAgICAgICAgICAgICAgJHRyLmFmdGVyKHNwcmludGYoJzx0ciBjbGFzcz1cImRldGFpbC12aWV3XCI+PHRkIGNvbHNwYW49XCIlc1wiPjwvdGQ+PC90cj4nLCAkdHIuZmluZCgndGQnKS5sZW5ndGgpKTtcbiAgICAgICAgICAgICAgICB2YXIgJGVsZW1lbnQgPSAkdHIubmV4dCgpLmZpbmQoJ3RkJyk7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBjYWxjdWxhdGVPYmplY3RWYWx1ZSh0aGF0Lm9wdGlvbnMsIHRoYXQub3B0aW9ucy5kZXRhaWxGb3JtYXR0ZXIsIFtpbmRleCwgcm93LCAkZWxlbWVudF0sICcnKTtcbiAgICAgICAgICAgICAgICBpZigkZWxlbWVudC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQuYXBwZW5kKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGF0LnRyaWdnZXIoJ2V4cGFuZC1yb3cnLCBpbmRleCwgcm93LCAkZWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGF0LnJlc2V0VmlldygpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLiRzZWxlY3RJdGVtID0gdGhpcy4kYm9keS5maW5kKHNwcmludGYoJ1tuYW1lPVwiJXNcIl0nLCB0aGlzLm9wdGlvbnMuc2VsZWN0SXRlbU5hbWUpKTtcbiAgICAgICAgdGhpcy4kc2VsZWN0SXRlbS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICBjaGVja2VkID0gJHRoaXMucHJvcCgnY2hlY2tlZCcpLFxuICAgICAgICAgICAgICAgIHJvdyA9IHRoYXQuZGF0YVskdGhpcy5kYXRhKCdpbmRleCcpXTtcblxuICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5tYWludGFpblNlbGVjdGVkICYmICQodGhpcykuaXMoJzpyYWRpbycpKSB7XG4gICAgICAgICAgICAgICAgJC5lYWNoKHRoYXQub3B0aW9ucy5kYXRhLCBmdW5jdGlvbiAoaSwgcm93KSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd1t0aGF0LmhlYWRlci5zdGF0ZUZpZWxkXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByb3dbdGhhdC5oZWFkZXIuc3RhdGVGaWVsZF0gPSBjaGVja2VkO1xuXG4gICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLnNpbmdsZVNlbGVjdCkge1xuICAgICAgICAgICAgICAgIHRoYXQuJHNlbGVjdEl0ZW0ubm90KHRoaXMpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmRhdGFbJCh0aGlzKS5kYXRhKCdpbmRleCcpXVt0aGF0LmhlYWRlci5zdGF0ZUZpZWxkXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoYXQuJHNlbGVjdEl0ZW0uZmlsdGVyKCc6Y2hlY2tlZCcpLm5vdCh0aGlzKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGF0LnVwZGF0ZVNlbGVjdGVkKCk7XG4gICAgICAgICAgICB0aGF0LnRyaWdnZXIoY2hlY2tlZCA/ICdjaGVjaycgOiAndW5jaGVjaycsIHJvdywgJHRoaXMpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkLmVhY2godGhpcy5oZWFkZXIuZXZlbnRzLCBmdW5jdGlvbiAoaSwgZXZlbnRzKSB7XG4gICAgICAgICAgICBpZiAoIWV2ZW50cykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGZpeCBidWcsIGlmIGV2ZW50cyBpcyBkZWZpbmVkIHdpdGggbmFtZXNwYWNlXG4gICAgICAgICAgICBpZiAodHlwZW9mIGV2ZW50cyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBldmVudHMgPSBjYWxjdWxhdGVPYmplY3RWYWx1ZShudWxsLCBldmVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZmllbGQgPSB0aGF0LmhlYWRlci5maWVsZHNbaV0sXG4gICAgICAgICAgICAgICAgZmllbGRJbmRleCA9ICQuaW5BcnJheShmaWVsZCwgdGhhdC5nZXRWaXNpYmxlRmllbGRzKCkpO1xuXG4gICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmRldGFpbFZpZXcgJiYgIXRoYXQub3B0aW9ucy5jYXJkVmlldykge1xuICAgICAgICAgICAgICAgIGZpZWxkSW5kZXggKz0gMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGV2ZW50cykge1xuICAgICAgICAgICAgICAgIHRoYXQuJGJvZHkuZmluZCgnPnRyOm5vdCgubm8tcmVjb3Jkcy1mb3VuZCknKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICR0ciA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGQgPSAkdHIuZmluZCh0aGF0Lm9wdGlvbnMuY2FyZFZpZXcgPyAnLmNhcmQtdmlldycgOiAndGQnKS5lcShmaWVsZEluZGV4KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0ga2V5LmluZGV4T2YoJyAnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBrZXkuc3Vic3RyaW5nKDAsIGluZGV4KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsID0ga2V5LnN1YnN0cmluZyhpbmRleCArIDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuYyA9IGV2ZW50c1trZXldO1xuXG4gICAgICAgICAgICAgICAgICAgICR0ZC5maW5kKGVsKS5vZmYobmFtZSkub24obmFtZSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9ICR0ci5kYXRhKCdpbmRleCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdyA9IHRoYXQuZGF0YVtpbmRleF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSByb3dbZmllbGRdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jLmFwcGx5KHRoaXMsIFtlLCB2YWx1ZSwgcm93LCBpbmRleF0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVTZWxlY3RlZCgpO1xuICAgICAgICB0aGlzLnJlc2V0VmlldygpO1xuXG4gICAgICAgIHRoaXMudHJpZ2dlcigncG9zdC1ib2R5JywgZGF0YSk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5pbml0U2VydmVyID0gZnVuY3Rpb24gKHNpbGVudCwgcXVlcnksIHVybCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICBkYXRhID0ge30sXG4gICAgICAgICAgICBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgc2VhcmNoVGV4dDogdGhpcy5zZWFyY2hUZXh0LFxuICAgICAgICAgICAgICAgIHNvcnROYW1lOiB0aGlzLm9wdGlvbnMuc29ydE5hbWUsXG4gICAgICAgICAgICAgICAgc29ydE9yZGVyOiB0aGlzLm9wdGlvbnMuc29ydE9yZGVyXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVxdWVzdDtcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBhZ2luYXRpb24pIHtcbiAgICAgICAgICAgIHBhcmFtcy5wYWdlU2l6ZSA9IHRoaXMub3B0aW9ucy5wYWdlU2l6ZSA9PT0gdGhpcy5vcHRpb25zLmZvcm1hdEFsbFJvd3MoKSA/XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnRvdGFsUm93cyA6IHRoaXMub3B0aW9ucy5wYWdlU2l6ZTtcbiAgICAgICAgICAgIHBhcmFtcy5wYWdlTnVtYmVyID0gdGhpcy5vcHRpb25zLnBhZ2VOdW1iZXI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoISh1cmwgfHwgdGhpcy5vcHRpb25zLnVybCkgJiYgIXRoaXMub3B0aW9ucy5hamF4KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnF1ZXJ5UGFyYW1zVHlwZSA9PT0gJ2xpbWl0Jykge1xuICAgICAgICAgICAgcGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIHNlYXJjaDogcGFyYW1zLnNlYXJjaFRleHQsXG4gICAgICAgICAgICAgICAgc29ydDogcGFyYW1zLnNvcnROYW1lLFxuICAgICAgICAgICAgICAgIG9yZGVyOiBwYXJhbXMuc29ydE9yZGVyXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBhZ2luYXRpb24pIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMub2Zmc2V0ID0gdGhpcy5vcHRpb25zLnBhZ2VTaXplID09PSB0aGlzLm9wdGlvbnMuZm9ybWF0QWxsUm93cygpID9cbiAgICAgICAgICAgICAgICAgICAgMCA6IHRoaXMub3B0aW9ucy5wYWdlU2l6ZSAqICh0aGlzLm9wdGlvbnMucGFnZU51bWJlciAtIDEpO1xuICAgICAgICAgICAgICAgIHBhcmFtcy5saW1pdCA9IHRoaXMub3B0aW9ucy5wYWdlU2l6ZSA9PT0gdGhpcy5vcHRpb25zLmZvcm1hdEFsbFJvd3MoKSA/XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy50b3RhbFJvd3MgOiB0aGlzLm9wdGlvbnMucGFnZVNpemU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoISgkLmlzRW1wdHlPYmplY3QodGhpcy5maWx0ZXJDb2x1bW5zUGFydGlhbCkpKSB7XG4gICAgICAgICAgICBwYXJhbXMuZmlsdGVyID0gSlNPTi5zdHJpbmdpZnkodGhpcy5maWx0ZXJDb2x1bW5zUGFydGlhbCwgbnVsbCk7XG4gICAgICAgIH1cblxuICAgICAgICBkYXRhID0gY2FsY3VsYXRlT2JqZWN0VmFsdWUodGhpcy5vcHRpb25zLCB0aGlzLm9wdGlvbnMucXVlcnlQYXJhbXMsIFtwYXJhbXNdLCBkYXRhKTtcblxuICAgICAgICAkLmV4dGVuZChkYXRhLCBxdWVyeSB8fCB7fSk7XG5cbiAgICAgICAgLy8gZmFsc2UgdG8gc3RvcCByZXF1ZXN0XG4gICAgICAgIGlmIChkYXRhID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFzaWxlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuJHRhYmxlTG9hZGluZy5zaG93KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVxdWVzdCA9ICQuZXh0ZW5kKHt9LCBjYWxjdWxhdGVPYmplY3RWYWx1ZShudWxsLCB0aGlzLm9wdGlvbnMuYWpheE9wdGlvbnMpLCB7XG4gICAgICAgICAgICB0eXBlOiB0aGlzLm9wdGlvbnMubWV0aG9kLFxuICAgICAgICAgICAgdXJsOiAgdXJsIHx8IHRoaXMub3B0aW9ucy51cmwsXG4gICAgICAgICAgICBkYXRhOiB0aGlzLm9wdGlvbnMuY29udGVudFR5cGUgPT09ICdhcHBsaWNhdGlvbi9qc29uJyAmJiB0aGlzLm9wdGlvbnMubWV0aG9kID09PSAncG9zdCcgP1xuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KGRhdGEpIDogZGF0YSxcbiAgICAgICAgICAgIGNhY2hlOiB0aGlzLm9wdGlvbnMuY2FjaGUsXG4gICAgICAgICAgICBjb250ZW50VHlwZTogdGhpcy5vcHRpb25zLmNvbnRlbnRUeXBlLFxuICAgICAgICAgICAgZGF0YVR5cGU6IHRoaXMub3B0aW9ucy5kYXRhVHlwZSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICByZXMgPSBjYWxjdWxhdGVPYmplY3RWYWx1ZSh0aGF0Lm9wdGlvbnMsIHRoYXQub3B0aW9ucy5yZXNwb25zZUhhbmRsZXIsIFtyZXNdLCByZXMpO1xuXG4gICAgICAgICAgICAgICAgdGhhdC5sb2FkKHJlcyk7XG4gICAgICAgICAgICAgICAgdGhhdC50cmlnZ2VyKCdsb2FkLXN1Y2Nlc3MnLCByZXMpO1xuICAgICAgICAgICAgICAgIGlmICghc2lsZW50KSB0aGF0LiR0YWJsZUxvYWRpbmcuaGlkZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgdGhhdC50cmlnZ2VyKCdsb2FkLWVycm9yJywgcmVzLnN0YXR1cywgcmVzKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNpbGVudCkgdGhhdC4kdGFibGVMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5hamF4KSB7XG4gICAgICAgICAgICBjYWxjdWxhdGVPYmplY3RWYWx1ZSh0aGlzLCB0aGlzLm9wdGlvbnMuYWpheCwgW3JlcXVlc3RdLCBudWxsKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl94aHIgJiYgdGhpcy5feGhyLnJlYWR5U3RhdGUgIT09IDQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3hociA9ICQuYWpheChyZXF1ZXN0KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuaW5pdFNlYXJjaFRleHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2VhcmNoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNlYXJjaFRleHQgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgdmFyICRzZWFyY2ggPSB0aGlzLiR0b29sYmFyLmZpbmQoJy5zZWFyY2ggaW5wdXQnKTtcbiAgICAgICAgICAgICAgICAkc2VhcmNoLnZhbCh0aGlzLm9wdGlvbnMuc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vblNlYXJjaCh7Y3VycmVudFRhcmdldDogJHNlYXJjaH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5nZXRDYXJldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgICQuZWFjaCh0aGlzLiRoZWFkZXIuZmluZCgndGgnKSwgZnVuY3Rpb24gKGksIHRoKSB7XG4gICAgICAgICAgICAkKHRoKS5maW5kKCcuc29ydGFibGUnKS5yZW1vdmVDbGFzcygnZGVzYyBhc2MnKS5hZGRDbGFzcygkKHRoKS5kYXRhKCdmaWVsZCcpID09PSB0aGF0Lm9wdGlvbnMuc29ydE5hbWUgPyB0aGF0Lm9wdGlvbnMuc29ydE9yZGVyIDogJ2JvdGgnKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS51cGRhdGVTZWxlY3RlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNoZWNrQWxsID0gdGhpcy4kc2VsZWN0SXRlbS5maWx0ZXIoJzplbmFibGVkJykubGVuZ3RoICYmXG4gICAgICAgICAgICB0aGlzLiRzZWxlY3RJdGVtLmZpbHRlcignOmVuYWJsZWQnKS5sZW5ndGggPT09XG4gICAgICAgICAgICB0aGlzLiRzZWxlY3RJdGVtLmZpbHRlcignOmVuYWJsZWQnKS5maWx0ZXIoJzpjaGVja2VkJykubGVuZ3RoO1xuXG4gICAgICAgIHRoaXMuJHNlbGVjdEFsbC5hZGQodGhpcy4kc2VsZWN0QWxsXykucHJvcCgnY2hlY2tlZCcsIGNoZWNrQWxsKTtcblxuICAgICAgICB0aGlzLiRzZWxlY3RJdGVtLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCd0cicpWyQodGhpcykucHJvcCgnY2hlY2tlZCcpID8gJ2FkZENsYXNzJyA6ICdyZW1vdmVDbGFzcyddKCdzZWxlY3RlZCcpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnVwZGF0ZVJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICB0aGlzLiRzZWxlY3RJdGVtLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhhdC5kYXRhWyQodGhpcykuZGF0YSgnaW5kZXgnKV1bdGhhdC5oZWFkZXIuc3RhdGVGaWVsZF0gPSAkKHRoaXMpLnByb3AoJ2NoZWNrZWQnKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5yZXNldFJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICAkLmVhY2godGhpcy5kYXRhLCBmdW5jdGlvbiAoaSwgcm93KSB7XG4gICAgICAgICAgICB0aGF0LiRzZWxlY3RBbGwucHJvcCgnY2hlY2tlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoYXQuJHNlbGVjdEl0ZW0ucHJvcCgnY2hlY2tlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgIGlmICh0aGF0LmhlYWRlci5zdGF0ZUZpZWxkKSB7XG4gICAgICAgICAgICAgICAgcm93W3RoYXQuaGVhZGVyLnN0YXRlRmllbGRdID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUudHJpZ2dlciA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcblxuICAgICAgICBuYW1lICs9ICcuYnMudGFibGUnO1xuICAgICAgICB0aGlzLm9wdGlvbnNbQm9vdHN0cmFwVGFibGUuRVZFTlRTW25hbWVdXS5hcHBseSh0aGlzLm9wdGlvbnMsIGFyZ3MpO1xuICAgICAgICB0aGlzLiRlbC50cmlnZ2VyKCQuRXZlbnQobmFtZSksIGFyZ3MpO1xuXG4gICAgICAgIHRoaXMub3B0aW9ucy5vbkFsbChuYW1lLCBhcmdzKTtcbiAgICAgICAgdGhpcy4kZWwudHJpZ2dlcigkLkV2ZW50KCdhbGwuYnMudGFibGUnKSwgW25hbWUsIGFyZ3NdKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnJlc2V0SGVhZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBmaXggIzYxOiB0aGUgaGlkZGVuIHRhYmxlIHJlc2V0IGhlYWRlciBidWcuXG4gICAgICAgIC8vIGZpeCBidWc6IGdldCAkZWwuY3NzKCd3aWR0aCcpIGVycm9yIHNvbWV0aW1lIChoZWlnaHQgPSA1MDApXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRJZF8pO1xuICAgICAgICB0aGlzLnRpbWVvdXRJZF8gPSBzZXRUaW1lb3V0KCQucHJveHkodGhpcy5maXRIZWFkZXIsIHRoaXMpLCB0aGlzLiRlbC5pcygnOmhpZGRlbicpID8gMTAwIDogMCk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5maXRIZWFkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgICAgICAgIGZpeGVkQm9keSxcbiAgICAgICAgICAgIHNjcm9sbFdpZHRoLFxuICAgICAgICAgICAgZm9jdXNlZCxcbiAgICAgICAgICAgIGZvY3VzZWRUZW1wO1xuXG4gICAgICAgIGlmICh0aGF0LiRlbC5pcygnOmhpZGRlbicpKSB7XG4gICAgICAgICAgICB0aGF0LnRpbWVvdXRJZF8gPSBzZXRUaW1lb3V0KCQucHJveHkodGhhdC5maXRIZWFkZXIsIHRoYXQpLCAxMDApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZpeGVkQm9keSA9IHRoaXMuJHRhYmxlQm9keS5nZXQoMCk7XG5cbiAgICAgICAgc2Nyb2xsV2lkdGggPSBmaXhlZEJvZHkuc2Nyb2xsV2lkdGggPiBmaXhlZEJvZHkuY2xpZW50V2lkdGggJiZcbiAgICAgICAgZml4ZWRCb2R5LnNjcm9sbEhlaWdodCA+IGZpeGVkQm9keS5jbGllbnRIZWlnaHQgKyB0aGlzLiRoZWFkZXIub3V0ZXJIZWlnaHQoKSA/XG4gICAgICAgICAgICBnZXRTY3JvbGxCYXJXaWR0aCgpIDogMDtcblxuICAgICAgICB0aGlzLiRlbC5jc3MoJ21hcmdpbi10b3AnLCAtdGhpcy4kaGVhZGVyLm91dGVySGVpZ2h0KCkpO1xuXG4gICAgICAgIGZvY3VzZWQgPSAkKCc6Zm9jdXMnKTtcbiAgICAgICAgaWYgKGZvY3VzZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyICR0aCA9IGZvY3VzZWQucGFyZW50cygndGgnKTtcbiAgICAgICAgICAgIGlmICgkdGgubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhRmllbGQgPSAkdGguYXR0cignZGF0YS1maWVsZCcpO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhRmllbGQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJGhlYWRlclRoID0gdGhpcy4kaGVhZGVyLmZpbmQoXCJbZGF0YS1maWVsZD0nXCIgKyBkYXRhRmllbGQgKyBcIiddXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJGhlYWRlclRoLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRoZWFkZXJUaC5maW5kKFwiOmlucHV0XCIpLmFkZENsYXNzKFwiZm9jdXMtdGVtcFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuJGhlYWRlcl8gPSB0aGlzLiRoZWFkZXIuY2xvbmUodHJ1ZSwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuJHNlbGVjdEFsbF8gPSB0aGlzLiRoZWFkZXJfLmZpbmQoJ1tuYW1lPVwiYnRTZWxlY3RBbGxcIl0nKTtcbiAgICAgICAgdGhpcy4kdGFibGVIZWFkZXIuY3NzKHtcbiAgICAgICAgICAgICdtYXJnaW4tcmlnaHQnOiBzY3JvbGxXaWR0aFxuICAgICAgICB9KS5maW5kKCd0YWJsZScpLmNzcygnd2lkdGgnLCB0aGlzLiRlbC5vdXRlcldpZHRoKCkpXG4gICAgICAgICAgICAuaHRtbCgnJykuYXR0cignY2xhc3MnLCB0aGlzLiRlbC5hdHRyKCdjbGFzcycpKVxuICAgICAgICAgICAgLmFwcGVuZCh0aGlzLiRoZWFkZXJfKTtcblxuXG4gICAgICAgIGZvY3VzZWRUZW1wID0gJCgnLmZvY3VzLXRlbXA6dmlzaWJsZTplcSgwKScpO1xuICAgICAgICBpZiAoZm9jdXNlZFRlbXAubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZm9jdXNlZFRlbXAuZm9jdXMoKTtcbiAgICAgICAgICAgIHRoaXMuJGhlYWRlci5maW5kKCcuZm9jdXMtdGVtcCcpLnJlbW92ZUNsYXNzKCdmb2N1cy10ZW1wJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmaXggYnVnOiAkLmRhdGEoKSBpcyBub3Qgd29ya2luZyBhcyBleHBlY3RlZCBhZnRlciAkLmFwcGVuZCgpXG4gICAgICAgIHRoaXMuJGhlYWRlci5maW5kKCd0aFtkYXRhLWZpZWxkXScpLmVhY2goZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgIHRoYXQuJGhlYWRlcl8uZmluZChzcHJpbnRmKCd0aFtkYXRhLWZpZWxkPVwiJXNcIl0nLCAkKHRoaXMpLmRhdGEoJ2ZpZWxkJykpKS5kYXRhKCQodGhpcykuZGF0YSgpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIHZpc2libGVGaWVsZHMgPSB0aGlzLmdldFZpc2libGVGaWVsZHMoKSxcbiAgICAgICAgICAgICR0aHMgPSB0aGlzLiRoZWFkZXJfLmZpbmQoJ3RoJyk7XG5cbiAgICAgICAgdGhpcy4kYm9keS5maW5kKCc+dHI6Zmlyc3QtY2hpbGQ6bm90KC5uby1yZWNvcmRzLWZvdW5kKSA+IConKS5lYWNoKGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcblxuICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5kZXRhaWxWaWV3ICYmICF0aGF0Lm9wdGlvbnMuY2FyZFZpZXcpIHtcbiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LiRoZWFkZXJfLmZpbmQoJ3RoLmRldGFpbCcpLmZpbmQoJy5maHQtY2VsbCcpLndpZHRoKCR0aGlzLmlubmVyV2lkdGgoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGluZGV4ID0gaSAtIDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciAkdGggPSB0aGF0LiRoZWFkZXJfLmZpbmQoc3ByaW50ZigndGhbZGF0YS1maWVsZD1cIiVzXCJdJywgdmlzaWJsZUZpZWxkc1tpbmRleF0pKTtcbiAgICAgICAgICAgIGlmICgkdGgubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICR0aCA9ICQoJHRoc1skdGhpc1swXS5jZWxsSW5kZXhdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHRoLmZpbmQoJy5maHQtY2VsbCcpLndpZHRoKCR0aGlzLmlubmVyV2lkdGgoKSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBob3Jpem9udGFsIHNjcm9sbCBldmVudFxuICAgICAgICAvLyBUT0RPOiBpdCdzIHByb2JhYmx5IGJldHRlciBpbXByb3ZpbmcgdGhlIGxheW91dCB0aGFuIGJpbmRpbmcgdG8gc2Nyb2xsIGV2ZW50XG4gICAgICAgIHRoaXMuJHRhYmxlQm9keS5vZmYoJ3Njcm9sbCcpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGF0LiR0YWJsZUhlYWRlci5zY3JvbGxMZWZ0KCQodGhpcykuc2Nyb2xsTGVmdCgpKTtcblxuICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5zaG93Rm9vdGVyICYmICF0aGF0Lm9wdGlvbnMuY2FyZFZpZXcpIHtcbiAgICAgICAgICAgICAgICB0aGF0LiR0YWJsZUZvb3Rlci5zY3JvbGxMZWZ0KCQodGhpcykuc2Nyb2xsTGVmdCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoYXQudHJpZ2dlcigncG9zdC1oZWFkZXInKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnJlc2V0Rm9vdGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICBkYXRhID0gdGhhdC5nZXREYXRhKCksXG4gICAgICAgICAgICBodG1sID0gW107XG5cbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuc2hvd0Zvb3RlciB8fCB0aGlzLm9wdGlvbnMuY2FyZFZpZXcpIHsgLy9kbyBub3RoaW5nXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5jYXJkVmlldyAmJiB0aGlzLm9wdGlvbnMuZGV0YWlsVmlldykge1xuICAgICAgICAgICAgaHRtbC5wdXNoKCc8dGQ+PGRpdiBjbGFzcz1cInRoLWlubmVyXCI+Jm5ic3A7PC9kaXY+PGRpdiBjbGFzcz1cImZodC1jZWxsXCI+PC9kaXY+PC90ZD4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgICQuZWFjaCh0aGlzLmNvbHVtbnMsIGZ1bmN0aW9uIChpLCBjb2x1bW4pIHtcbiAgICAgICAgICAgIHZhciBrZXksXG4gICAgICAgICAgICAgICAgZmFsaWduID0gJycsIC8vIGZvb3RlciBhbGlnbiBzdHlsZVxuICAgICAgICAgICAgICAgIHZhbGlnbiA9ICcnLFxuICAgICAgICAgICAgICAgIGNzc2VzID0gW10sXG4gICAgICAgICAgICAgICAgc3R5bGUgPSB7fSxcbiAgICAgICAgICAgICAgICBjbGFzc18gPSBzcHJpbnRmKCcgY2xhc3M9XCIlc1wiJywgY29sdW1uWydjbGFzcyddKTtcblxuICAgICAgICAgICAgaWYgKCFjb2x1bW4udmlzaWJsZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5jYXJkVmlldyAmJiAoIWNvbHVtbi5jYXJkVmlzaWJsZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZhbGlnbiA9IHNwcmludGYoJ3RleHQtYWxpZ246ICVzOyAnLCBjb2x1bW4uZmFsaWduID8gY29sdW1uLmZhbGlnbiA6IGNvbHVtbi5hbGlnbik7XG4gICAgICAgICAgICB2YWxpZ24gPSBzcHJpbnRmKCd2ZXJ0aWNhbC1hbGlnbjogJXM7ICcsIGNvbHVtbi52YWxpZ24pO1xuXG4gICAgICAgICAgICBzdHlsZSA9IGNhbGN1bGF0ZU9iamVjdFZhbHVlKG51bGwsIHRoYXQub3B0aW9ucy5mb290ZXJTdHlsZSk7XG5cbiAgICAgICAgICAgIGlmIChzdHlsZSAmJiBzdHlsZS5jc3MpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGtleSBpbiBzdHlsZS5jc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY3NzZXMucHVzaChrZXkgKyAnOiAnICsgc3R5bGUuY3NzW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8dGQnLCBjbGFzc18sIHNwcmludGYoJyBzdHlsZT1cIiVzXCInLCBmYWxpZ24gKyB2YWxpZ24gKyBjc3Nlcy5jb25jYXQoKS5qb2luKCc7ICcpKSwgJz4nKTtcbiAgICAgICAgICAgIGh0bWwucHVzaCgnPGRpdiBjbGFzcz1cInRoLWlubmVyXCI+Jyk7XG5cbiAgICAgICAgICAgIGh0bWwucHVzaChjYWxjdWxhdGVPYmplY3RWYWx1ZShjb2x1bW4sIGNvbHVtbi5mb290ZXJGb3JtYXR0ZXIsIFtkYXRhXSwgJyZuYnNwOycpIHx8ICcmbmJzcDsnKTtcblxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8L2Rpdj4nKTtcbiAgICAgICAgICAgIGh0bWwucHVzaCgnPGRpdiBjbGFzcz1cImZodC1jZWxsXCI+PC9kaXY+Jyk7XG4gICAgICAgICAgICBodG1sLnB1c2goJzwvZGl2PicpO1xuICAgICAgICAgICAgaHRtbC5wdXNoKCc8L3RkPicpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLiR0YWJsZUZvb3Rlci5maW5kKCd0cicpLmh0bWwoaHRtbC5qb2luKCcnKSk7XG4gICAgICAgIHRoaXMuJHRhYmxlRm9vdGVyLnNob3coKTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dEZvb3Rlcl8pO1xuICAgICAgICB0aGlzLnRpbWVvdXRGb290ZXJfID0gc2V0VGltZW91dCgkLnByb3h5KHRoaXMuZml0Rm9vdGVyLCB0aGlzKSxcbiAgICAgICAgICAgIHRoaXMuJGVsLmlzKCc6aGlkZGVuJykgPyAxMDAgOiAwKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmZpdEZvb3RlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgJGZvb3RlclRkLFxuICAgICAgICAgICAgZWxXaWR0aCxcbiAgICAgICAgICAgIHNjcm9sbFdpZHRoO1xuXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRGb290ZXJfKTtcbiAgICAgICAgaWYgKHRoaXMuJGVsLmlzKCc6aGlkZGVuJykpIHtcbiAgICAgICAgICAgIHRoaXMudGltZW91dEZvb3Rlcl8gPSBzZXRUaW1lb3V0KCQucHJveHkodGhpcy5maXRGb290ZXIsIHRoaXMpLCAxMDApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxXaWR0aCA9IHRoaXMuJGVsLmNzcygnd2lkdGgnKTtcbiAgICAgICAgc2Nyb2xsV2lkdGggPSBlbFdpZHRoID4gdGhpcy4kdGFibGVCb2R5LndpZHRoKCkgPyBnZXRTY3JvbGxCYXJXaWR0aCgpIDogMDtcblxuICAgICAgICB0aGlzLiR0YWJsZUZvb3Rlci5jc3Moe1xuICAgICAgICAgICAgJ21hcmdpbi1yaWdodCc6IHNjcm9sbFdpZHRoXG4gICAgICAgIH0pLmZpbmQoJ3RhYmxlJykuY3NzKCd3aWR0aCcsIGVsV2lkdGgpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCB0aGlzLiRlbC5hdHRyKCdjbGFzcycpKTtcblxuICAgICAgICAkZm9vdGVyVGQgPSB0aGlzLiR0YWJsZUZvb3Rlci5maW5kKCd0ZCcpO1xuXG4gICAgICAgIHRoaXMuJGJvZHkuZmluZCgnPnRyOmZpcnN0LWNoaWxkOm5vdCgubm8tcmVjb3Jkcy1mb3VuZCkgPiAqJykuZWFjaChmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcblxuICAgICAgICAgICAgJGZvb3RlclRkLmVxKGkpLmZpbmQoJy5maHQtY2VsbCcpLndpZHRoKCR0aGlzLmlubmVyV2lkdGgoKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUudG9nZ2xlQ29sdW1uID0gZnVuY3Rpb24gKGluZGV4LCBjaGVja2VkLCBuZWVkVXBkYXRlKSB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbHVtbnNbaW5kZXhdLnZpc2libGUgPSBjaGVja2VkO1xuICAgICAgICB0aGlzLmluaXRIZWFkZXIoKTtcbiAgICAgICAgdGhpcy5pbml0U2VhcmNoKCk7XG4gICAgICAgIHRoaXMuaW5pdFBhZ2luYXRpb24oKTtcbiAgICAgICAgdGhpcy5pbml0Qm9keSgpO1xuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd0NvbHVtbnMpIHtcbiAgICAgICAgICAgIHZhciAkaXRlbXMgPSB0aGlzLiR0b29sYmFyLmZpbmQoJy5rZWVwLW9wZW4gaW5wdXQnKS5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcblxuICAgICAgICAgICAgaWYgKG5lZWRVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICAkaXRlbXMuZmlsdGVyKHNwcmludGYoJ1t2YWx1ZT1cIiVzXCJdJywgaW5kZXgpKS5wcm9wKCdjaGVja2VkJywgY2hlY2tlZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICgkaXRlbXMuZmlsdGVyKCc6Y2hlY2tlZCcpLmxlbmd0aCA8PSB0aGlzLm9wdGlvbnMubWluaW11bUNvdW50Q29sdW1ucykge1xuICAgICAgICAgICAgICAgICRpdGVtcy5maWx0ZXIoJzpjaGVja2VkJykucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUudG9nZ2xlUm93ID0gZnVuY3Rpb24gKGluZGV4LCB1bmlxdWVJZCwgdmlzaWJsZSkge1xuICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLiRib2R5LmZpbmQodHlwZW9mIGluZGV4ICE9PSAndW5kZWZpbmVkJyA/XG4gICAgICAgICAgICBzcHJpbnRmKCd0cltkYXRhLWluZGV4PVwiJXNcIl0nLCBpbmRleCkgOlxuICAgICAgICAgICAgc3ByaW50ZigndHJbZGF0YS11bmlxdWVpZD1cIiVzXCJdJywgdW5pcXVlSWQpKVxuICAgICAgICAgICAgW3Zpc2libGUgPyAnc2hvdycgOiAnaGlkZSddKCk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5nZXRWaXNpYmxlRmllbGRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICB2aXNpYmxlRmllbGRzID0gW107XG5cbiAgICAgICAgJC5lYWNoKHRoaXMuaGVhZGVyLmZpZWxkcywgZnVuY3Rpb24gKGosIGZpZWxkKSB7XG4gICAgICAgICAgICB2YXIgY29sdW1uID0gdGhhdC5jb2x1bW5zW2dldEZpZWxkSW5kZXgodGhhdC5jb2x1bW5zLCBmaWVsZCldO1xuXG4gICAgICAgICAgICBpZiAoIWNvbHVtbi52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmlzaWJsZUZpZWxkcy5wdXNoKGZpZWxkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB2aXNpYmxlRmllbGRzO1xuICAgIH07XG5cbiAgICAvLyBQVUJMSUMgRlVOQ1RJT04gREVGSU5JVElPTlxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUucmVzZXRWaWV3ID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcGFkZGluZyA9IDA7XG5cbiAgICAgICAgaWYgKHBhcmFtcyAmJiBwYXJhbXMuaGVpZ2h0KSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuaGVpZ2h0ID0gcGFyYW1zLmhlaWdodDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuJHNlbGVjdEFsbC5wcm9wKCdjaGVja2VkJywgdGhpcy4kc2VsZWN0SXRlbS5sZW5ndGggPiAwICYmXG4gICAgICAgICAgICB0aGlzLiRzZWxlY3RJdGVtLmxlbmd0aCA9PT0gdGhpcy4kc2VsZWN0SXRlbS5maWx0ZXIoJzpjaGVja2VkJykubGVuZ3RoKTtcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmhlaWdodCkge1xuICAgICAgICAgICAgdmFyIHRvb2xiYXJIZWlnaHQgPSBnZXRSZWFsSGVpZ2h0KHRoaXMuJHRvb2xiYXIpLFxuICAgICAgICAgICAgICAgIHBhZ2luYXRpb25IZWlnaHQgPSBnZXRSZWFsSGVpZ2h0KHRoaXMuJHBhZ2luYXRpb24pLFxuICAgICAgICAgICAgICAgIGhlaWdodCA9IHRoaXMub3B0aW9ucy5oZWlnaHQgLSB0b29sYmFySGVpZ2h0IC0gcGFnaW5hdGlvbkhlaWdodDtcblxuICAgICAgICAgICAgdGhpcy4kdGFibGVDb250YWluZXIuY3NzKCdoZWlnaHQnLCBoZWlnaHQgKyAncHgnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY2FyZFZpZXcpIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgZWxlbWVudCBjc3NcbiAgICAgICAgICAgIHRoaXMuJGVsLmNzcygnbWFyZ2luLXRvcCcsICcwJyk7XG4gICAgICAgICAgICB0aGlzLiR0YWJsZUNvbnRhaW5lci5jc3MoJ3BhZGRpbmctYm90dG9tJywgJzAnKTtcbiAgICAgICAgICAgIHRoaXMuJHRhYmxlRm9vdGVyLmhpZGUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd0hlYWRlciAmJiB0aGlzLm9wdGlvbnMuaGVpZ2h0KSB7XG4gICAgICAgICAgICB0aGlzLiR0YWJsZUhlYWRlci5zaG93KCk7XG4gICAgICAgICAgICB0aGlzLnJlc2V0SGVhZGVyKCk7XG4gICAgICAgICAgICBwYWRkaW5nICs9IHRoaXMuJGhlYWRlci5vdXRlckhlaWdodCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy4kdGFibGVIZWFkZXIuaGlkZSgpO1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdwb3N0LWhlYWRlcicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zaG93Rm9vdGVyKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0Rm9vdGVyKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmhlaWdodCkge1xuICAgICAgICAgICAgICAgIHBhZGRpbmcgKz0gdGhpcy4kdGFibGVGb290ZXIub3V0ZXJIZWlnaHQoKSArIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBc3NpZ24gdGhlIGNvcnJlY3Qgc29ydGFibGUgYXJyb3dcbiAgICAgICAgdGhpcy5nZXRDYXJldCgpO1xuICAgICAgICB0aGlzLiR0YWJsZUNvbnRhaW5lci5jc3MoJ3BhZGRpbmctYm90dG9tJywgcGFkZGluZyArICdweCcpO1xuICAgICAgICB0aGlzLnRyaWdnZXIoJ3Jlc2V0LXZpZXcnKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmdldERhdGEgPSBmdW5jdGlvbiAodXNlQ3VycmVudFBhZ2UpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnNlYXJjaFRleHQgfHwgISQuaXNFbXB0eU9iamVjdCh0aGlzLmZpbHRlckNvbHVtbnMpIHx8ICEkLmlzRW1wdHlPYmplY3QodGhpcy5maWx0ZXJDb2x1bW5zUGFydGlhbCkpID9cbiAgICAgICAgICAgICh1c2VDdXJyZW50UGFnZSA/IHRoaXMuZGF0YS5zbGljZSh0aGlzLnBhZ2VGcm9tIC0gMSwgdGhpcy5wYWdlVG8pIDogdGhpcy5kYXRhKSA6XG4gICAgICAgICAgICAodXNlQ3VycmVudFBhZ2UgPyB0aGlzLm9wdGlvbnMuZGF0YS5zbGljZSh0aGlzLnBhZ2VGcm9tIC0gMSwgdGhpcy5wYWdlVG8pIDogdGhpcy5vcHRpb25zLmRhdGEpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBmaXhlZFNjcm9sbCA9IGZhbHNlO1xuXG4gICAgICAgIC8vICM0MzE6IHN1cHBvcnQgcGFnaW5hdGlvblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNpZGVQYWdpbmF0aW9uID09PSAnc2VydmVyJykge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLnRvdGFsUm93cyA9IGRhdGEudG90YWw7XG4gICAgICAgICAgICBmaXhlZFNjcm9sbCA9IGRhdGEuZml4ZWRTY3JvbGw7XG4gICAgICAgICAgICBkYXRhID0gZGF0YVt0aGlzLm9wdGlvbnMuZGF0YUZpZWxkXTtcbiAgICAgICAgfSBlbHNlIGlmICghJC5pc0FycmF5KGRhdGEpKSB7IC8vIHN1cHBvcnQgZml4ZWRTY3JvbGxcbiAgICAgICAgICAgIGZpeGVkU2Nyb2xsID0gZGF0YS5maXhlZFNjcm9sbDtcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLmRhdGE7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmluaXREYXRhKGRhdGEpO1xuICAgICAgICB0aGlzLmluaXRTZWFyY2goKTtcbiAgICAgICAgdGhpcy5pbml0UGFnaW5hdGlvbigpO1xuICAgICAgICB0aGlzLmluaXRCb2R5KGZpeGVkU2Nyb2xsKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMuaW5pdERhdGEoZGF0YSwgJ2FwcGVuZCcpO1xuICAgICAgICB0aGlzLmluaXRTZWFyY2goKTtcbiAgICAgICAgdGhpcy5pbml0UGFnaW5hdGlvbigpO1xuICAgICAgICB0aGlzLmluaXRTb3J0KCk7XG4gICAgICAgIHRoaXMuaW5pdEJvZHkodHJ1ZSk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5wcmVwZW5kID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdGhpcy5pbml0RGF0YShkYXRhLCAncHJlcGVuZCcpO1xuICAgICAgICB0aGlzLmluaXRTZWFyY2goKTtcbiAgICAgICAgdGhpcy5pbml0UGFnaW5hdGlvbigpO1xuICAgICAgICB0aGlzLmluaXRTb3J0KCk7XG4gICAgICAgIHRoaXMuaW5pdEJvZHkodHJ1ZSk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBsZW4gPSB0aGlzLm9wdGlvbnMuZGF0YS5sZW5ndGgsXG4gICAgICAgICAgICBpLCByb3c7XG5cbiAgICAgICAgaWYgKCFwYXJhbXMuaGFzT3duUHJvcGVydHkoJ2ZpZWxkJykgfHwgIXBhcmFtcy5oYXNPd25Qcm9wZXJ0eSgndmFsdWVzJykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoaSA9IGxlbiAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICByb3cgPSB0aGlzLm9wdGlvbnMuZGF0YVtpXTtcblxuICAgICAgICAgICAgaWYgKCFyb3cuaGFzT3duUHJvcGVydHkocGFyYW1zLmZpZWxkKSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCQuaW5BcnJheShyb3dbcGFyYW1zLmZpZWxkXSwgcGFyYW1zLnZhbHVlcykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmRhdGEuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxlbiA9PT0gdGhpcy5vcHRpb25zLmRhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmluaXRTZWFyY2goKTtcbiAgICAgICAgdGhpcy5pbml0UGFnaW5hdGlvbigpO1xuICAgICAgICB0aGlzLmluaXRTb3J0KCk7XG4gICAgICAgIHRoaXMuaW5pdEJvZHkodHJ1ZSk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5yZW1vdmVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuZGF0YS5zcGxpY2UoMCwgdGhpcy5vcHRpb25zLmRhdGEubGVuZ3RoKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdFNlYXJjaCgpO1xuICAgICAgICAgICAgdGhpcy5pbml0UGFnaW5hdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5pbml0Qm9keSh0cnVlKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuZ2V0Um93QnlVbmlxdWVJZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICB2YXIgdW5pcXVlSWQgPSB0aGlzLm9wdGlvbnMudW5pcXVlSWQsXG4gICAgICAgICAgICBsZW4gPSB0aGlzLm9wdGlvbnMuZGF0YS5sZW5ndGgsXG4gICAgICAgICAgICBkYXRhUm93ID0gbnVsbCxcbiAgICAgICAgICAgIGksIHJvdywgcm93VW5pcXVlSWQ7XG5cbiAgICAgICAgZm9yIChpID0gbGVuIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHJvdyA9IHRoaXMub3B0aW9ucy5kYXRhW2ldO1xuXG4gICAgICAgICAgICBpZiAocm93Lmhhc093blByb3BlcnR5KHVuaXF1ZUlkKSkgeyAvLyB1bmlxdWVJZCBpcyBhIGNvbHVtblxuICAgICAgICAgICAgICAgIHJvd1VuaXF1ZUlkID0gcm93W3VuaXF1ZUlkXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZihyb3cuX2RhdGEuaGFzT3duUHJvcGVydHkodW5pcXVlSWQpKSB7IC8vIHVuaXF1ZUlkIGlzIGEgcm93IGRhdGEgcHJvcGVydHlcbiAgICAgICAgICAgICAgICByb3dVbmlxdWVJZCA9IHJvdy5fZGF0YVt1bmlxdWVJZF07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZW9mIHJvd1VuaXF1ZUlkID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGlkID0gaWQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHJvd1VuaXF1ZUlkID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgIGlmICgoTnVtYmVyKHJvd1VuaXF1ZUlkKSA9PT0gcm93VW5pcXVlSWQpICYmIChyb3dVbmlxdWVJZCAlIDEgPT09IDApKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkID0gcGFyc2VJbnQoaWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKHJvd1VuaXF1ZUlkID09PSBOdW1iZXIocm93VW5pcXVlSWQpKSAmJiAocm93VW5pcXVlSWQgIT09IDApKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkID0gcGFyc2VGbG9hdChpZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocm93VW5pcXVlSWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgZGF0YVJvdyA9IHJvdztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkYXRhUm93O1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUucmVtb3ZlQnlVbmlxdWVJZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICB2YXIgbGVuID0gdGhpcy5vcHRpb25zLmRhdGEubGVuZ3RoLFxuICAgICAgICAgICAgcm93ID0gdGhpcy5nZXRSb3dCeVVuaXF1ZUlkKGlkKTtcblxuICAgICAgICBpZiAocm93KSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuZGF0YS5zcGxpY2UodGhpcy5vcHRpb25zLmRhdGEuaW5kZXhPZihyb3cpLCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsZW4gPT09IHRoaXMub3B0aW9ucy5kYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pbml0U2VhcmNoKCk7XG4gICAgICAgIHRoaXMuaW5pdFBhZ2luYXRpb24oKTtcbiAgICAgICAgdGhpcy5pbml0Qm9keSh0cnVlKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnVwZGF0ZUJ5VW5pcXVlSWQgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgdmFyIGFsbFBhcmFtcyA9ICQuaXNBcnJheShwYXJhbXMpID8gcGFyYW1zIDogWyBwYXJhbXMgXTtcblxuICAgICAgICAkLmVhY2goYWxsUGFyYW1zLCBmdW5jdGlvbihpLCBwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciByb3dJZDtcblxuICAgICAgICAgICAgaWYgKCFwYXJhbXMuaGFzT3duUHJvcGVydHkoJ2lkJykgfHwgIXBhcmFtcy5oYXNPd25Qcm9wZXJ0eSgncm93JykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJvd0lkID0gJC5pbkFycmF5KHRoYXQuZ2V0Um93QnlVbmlxdWVJZChwYXJhbXMuaWQpLCB0aGF0Lm9wdGlvbnMuZGF0YSk7XG5cbiAgICAgICAgICAgIGlmIChyb3dJZCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkLmV4dGVuZCh0aGF0Lm9wdGlvbnMuZGF0YVtyb3dJZF0sIHBhcmFtcy5yb3cpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmluaXRTZWFyY2goKTtcbiAgICAgICAgdGhpcy5pbml0U29ydCgpO1xuICAgICAgICB0aGlzLmluaXRCb2R5KHRydWUpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuaW5zZXJ0Um93ID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICBpZiAoIXBhcmFtcy5oYXNPd25Qcm9wZXJ0eSgnaW5kZXgnKSB8fCAhcGFyYW1zLmhhc093blByb3BlcnR5KCdyb3cnKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGF0YS5zcGxpY2UocGFyYW1zLmluZGV4LCAwLCBwYXJhbXMucm93KTtcbiAgICAgICAgdGhpcy5pbml0U2VhcmNoKCk7XG4gICAgICAgIHRoaXMuaW5pdFBhZ2luYXRpb24oKTtcbiAgICAgICAgdGhpcy5pbml0U29ydCgpO1xuICAgICAgICB0aGlzLmluaXRCb2R5KHRydWUpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUudXBkYXRlUm93ID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHZhciBhbGxQYXJhbXMgPSAkLmlzQXJyYXkocGFyYW1zKSA/IHBhcmFtcyA6IFsgcGFyYW1zIF07XG5cbiAgICAgICAgJC5lYWNoKGFsbFBhcmFtcywgZnVuY3Rpb24oaSwgcGFyYW1zKSB7XG4gICAgICAgICAgICBpZiAoIXBhcmFtcy5oYXNPd25Qcm9wZXJ0eSgnaW5kZXgnKSB8fCAhcGFyYW1zLmhhc093blByb3BlcnR5KCdyb3cnKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQuZXh0ZW5kKHRoYXQub3B0aW9ucy5kYXRhW3BhcmFtcy5pbmRleF0sIHBhcmFtcy5yb3cpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmluaXRTZWFyY2goKTtcbiAgICAgICAgdGhpcy5pbml0U29ydCgpO1xuICAgICAgICB0aGlzLmluaXRCb2R5KHRydWUpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuc2hvd1JvdyA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgaWYgKCFwYXJhbXMuaGFzT3duUHJvcGVydHkoJ2luZGV4JykgJiYgIXBhcmFtcy5oYXNPd25Qcm9wZXJ0eSgndW5pcXVlSWQnKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudG9nZ2xlUm93KHBhcmFtcy5pbmRleCwgcGFyYW1zLnVuaXF1ZUlkLCB0cnVlKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmhpZGVSb3cgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIGlmICghcGFyYW1zLmhhc093blByb3BlcnR5KCdpbmRleCcpICYmICFwYXJhbXMuaGFzT3duUHJvcGVydHkoJ3VuaXF1ZUlkJykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRvZ2dsZVJvdyhwYXJhbXMuaW5kZXgsIHBhcmFtcy51bmlxdWVJZCwgZmFsc2UpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuZ2V0Um93c0hpZGRlbiA9IGZ1bmN0aW9uIChzaG93KSB7XG4gICAgICAgIHZhciByb3dzID0gJCh0aGlzLiRib2R5WzBdKS5jaGlsZHJlbigpLmZpbHRlcignOmhpZGRlbicpLFxuICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgIGlmIChzaG93KSB7XG4gICAgICAgICAgICBmb3IgKDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAkKHJvd3NbaV0pLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcm93cztcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLm1lcmdlQ2VsbHMgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICB2YXIgcm93ID0gb3B0aW9ucy5pbmRleCxcbiAgICAgICAgICAgIGNvbCA9ICQuaW5BcnJheShvcHRpb25zLmZpZWxkLCB0aGlzLmdldFZpc2libGVGaWVsZHMoKSksXG4gICAgICAgICAgICByb3dzcGFuID0gb3B0aW9ucy5yb3dzcGFuIHx8IDEsXG4gICAgICAgICAgICBjb2xzcGFuID0gb3B0aW9ucy5jb2xzcGFuIHx8IDEsXG4gICAgICAgICAgICBpLCBqLFxuICAgICAgICAgICAgJHRyID0gdGhpcy4kYm9keS5maW5kKCc+dHInKSxcbiAgICAgICAgICAgICR0ZDtcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRldGFpbFZpZXcgJiYgIXRoaXMub3B0aW9ucy5jYXJkVmlldykge1xuICAgICAgICAgICAgY29sICs9IDE7XG4gICAgICAgIH1cblxuICAgICAgICAkdGQgPSAkdHIuZXEocm93KS5maW5kKCc+dGQnKS5lcShjb2wpO1xuXG4gICAgICAgIGlmIChyb3cgPCAwIHx8IGNvbCA8IDAgfHwgcm93ID49IHRoaXMuZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoaSA9IHJvdzsgaSA8IHJvdyArIHJvd3NwYW47IGkrKykge1xuICAgICAgICAgICAgZm9yIChqID0gY29sOyBqIDwgY29sICsgY29sc3BhbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgJHRyLmVxKGkpLmZpbmQoJz50ZCcpLmVxKGopLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgICR0ZC5hdHRyKCdyb3dzcGFuJywgcm93c3BhbikuYXR0cignY29sc3BhbicsIGNvbHNwYW4pLnNob3coKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnVwZGF0ZUNlbGwgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIGlmICghcGFyYW1zLmhhc093blByb3BlcnR5KCdpbmRleCcpIHx8XG4gICAgICAgICAgICAhcGFyYW1zLmhhc093blByb3BlcnR5KCdmaWVsZCcpIHx8XG4gICAgICAgICAgICAhcGFyYW1zLmhhc093blByb3BlcnR5KCd2YWx1ZScpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kYXRhW3BhcmFtcy5pbmRleF1bcGFyYW1zLmZpZWxkXSA9IHBhcmFtcy52YWx1ZTtcblxuICAgICAgICBpZiAocGFyYW1zLnJlaW5pdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRTb3J0KCk7XG4gICAgICAgIHRoaXMuaW5pdEJvZHkodHJ1ZSk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5nZXRPcHRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuZ2V0U2VsZWN0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgIHJldHVybiAkLmdyZXAodGhpcy5vcHRpb25zLmRhdGEsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgIHJldHVybiByb3dbdGhhdC5oZWFkZXIuc3RhdGVGaWVsZF07XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuZ2V0QWxsU2VsZWN0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgIHJldHVybiAkLmdyZXAodGhpcy5vcHRpb25zLmRhdGEsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgIHJldHVybiByb3dbdGhhdC5oZWFkZXIuc3RhdGVGaWVsZF07XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuY2hlY2tBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tBbGxfKHRydWUpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUudW5jaGVja0FsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jaGVja0FsbF8oZmFsc2UpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuY2hlY2tJbnZlcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgdmFyIHJvd3MgPSB0aGF0LiRzZWxlY3RJdGVtLmZpbHRlcignOmVuYWJsZWQnKTtcbiAgICAgICAgdmFyIGNoZWNrZWQgPSByb3dzLmZpbHRlcignOmNoZWNrZWQnKTtcbiAgICAgICAgcm93cy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJCh0aGlzKS5wcm9wKCdjaGVja2VkJywgISQodGhpcykucHJvcCgnY2hlY2tlZCcpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoYXQudXBkYXRlUm93cygpO1xuICAgICAgICB0aGF0LnVwZGF0ZVNlbGVjdGVkKCk7XG4gICAgICAgIHRoYXQudHJpZ2dlcigndW5jaGVjay1zb21lJywgY2hlY2tlZCk7XG4gICAgICAgIGNoZWNrZWQgPSB0aGF0LmdldFNlbGVjdGlvbnMoKTtcbiAgICAgICAgdGhhdC50cmlnZ2VyKCdjaGVjay1zb21lJywgY2hlY2tlZCk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5jaGVja0FsbF8gPSBmdW5jdGlvbiAoY2hlY2tlZCkge1xuICAgICAgICB2YXIgcm93cztcbiAgICAgICAgaWYgKCFjaGVja2VkKSB7XG4gICAgICAgICAgICByb3dzID0gdGhpcy5nZXRTZWxlY3Rpb25zKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy4kc2VsZWN0QWxsLmFkZCh0aGlzLiRzZWxlY3RBbGxfKS5wcm9wKCdjaGVja2VkJywgY2hlY2tlZCk7XG4gICAgICAgIHRoaXMuJHNlbGVjdEl0ZW0uZmlsdGVyKCc6ZW5hYmxlZCcpLnByb3AoJ2NoZWNrZWQnLCBjaGVja2VkKTtcbiAgICAgICAgdGhpcy51cGRhdGVSb3dzKCk7XG4gICAgICAgIGlmIChjaGVja2VkKSB7XG4gICAgICAgICAgICByb3dzID0gdGhpcy5nZXRTZWxlY3Rpb25zKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50cmlnZ2VyKGNoZWNrZWQgPyAnY2hlY2stYWxsJyA6ICd1bmNoZWNrLWFsbCcsIHJvd3MpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdGhpcy5jaGVja18odHJ1ZSwgaW5kZXgpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUudW5jaGVjayA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB0aGlzLmNoZWNrXyhmYWxzZSwgaW5kZXgpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuY2hlY2tfID0gZnVuY3Rpb24gKGNoZWNrZWQsIGluZGV4KSB7XG4gICAgICAgIHZhciAkZWwgPSB0aGlzLiRzZWxlY3RJdGVtLmZpbHRlcihzcHJpbnRmKCdbZGF0YS1pbmRleD1cIiVzXCJdJywgaW5kZXgpKS5wcm9wKCdjaGVja2VkJywgY2hlY2tlZCk7XG4gICAgICAgIHRoaXMuZGF0YVtpbmRleF1bdGhpcy5oZWFkZXIuc3RhdGVGaWVsZF0gPSBjaGVja2VkO1xuICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGVkKCk7XG4gICAgICAgIHRoaXMudHJpZ2dlcihjaGVja2VkID8gJ2NoZWNrJyA6ICd1bmNoZWNrJywgdGhpcy5kYXRhW2luZGV4XSwgJGVsKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmNoZWNrQnkgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIHRoaXMuY2hlY2tCeV8odHJ1ZSwgb2JqKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnVuY2hlY2tCeSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgdGhpcy5jaGVja0J5XyhmYWxzZSwgb2JqKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmNoZWNrQnlfID0gZnVuY3Rpb24gKGNoZWNrZWQsIG9iaikge1xuICAgICAgICBpZiAoIW9iai5oYXNPd25Qcm9wZXJ0eSgnZmllbGQnKSB8fCAhb2JqLmhhc093blByb3BlcnR5KCd2YWx1ZXMnKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgcm93cyA9IFtdO1xuICAgICAgICAkLmVhY2godGhpcy5vcHRpb25zLmRhdGEsIGZ1bmN0aW9uIChpbmRleCwgcm93KSB7XG4gICAgICAgICAgICBpZiAoIXJvdy5oYXNPd25Qcm9wZXJ0eShvYmouZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCQuaW5BcnJheShyb3dbb2JqLmZpZWxkXSwgb2JqLnZhbHVlcykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyICRlbCA9IHRoYXQuJHNlbGVjdEl0ZW0uZmlsdGVyKCc6ZW5hYmxlZCcpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoc3ByaW50ZignW2RhdGEtaW5kZXg9XCIlc1wiXScsIGluZGV4KSkucHJvcCgnY2hlY2tlZCcsIGNoZWNrZWQpO1xuICAgICAgICAgICAgICAgIHJvd1t0aGF0LmhlYWRlci5zdGF0ZUZpZWxkXSA9IGNoZWNrZWQ7XG4gICAgICAgICAgICAgICAgcm93cy5wdXNoKHJvdyk7XG4gICAgICAgICAgICAgICAgdGhhdC50cmlnZ2VyKGNoZWNrZWQgPyAnY2hlY2snIDogJ3VuY2hlY2snLCByb3csICRlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGVkKCk7XG4gICAgICAgIHRoaXMudHJpZ2dlcihjaGVja2VkID8gJ2NoZWNrLXNvbWUnIDogJ3VuY2hlY2stc29tZScsIHJvd3MpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy4kZWwuaW5zZXJ0QmVmb3JlKHRoaXMuJGNvbnRhaW5lcik7XG4gICAgICAgICQodGhpcy5vcHRpb25zLnRvb2xiYXIpLmluc2VydEJlZm9yZSh0aGlzLiRlbCk7XG4gICAgICAgIHRoaXMuJGNvbnRhaW5lci5uZXh0KCkucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuJGNvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy4kZWwuaHRtbCh0aGlzLiRlbF8uaHRtbCgpKVxuICAgICAgICAgICAgLmNzcygnbWFyZ2luLXRvcCcsICcwJylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsIHRoaXMuJGVsXy5hdHRyKCdjbGFzcycpIHx8ICcnKTsgLy8gcmVzZXQgdGhlIGNsYXNzXG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5zaG93TG9hZGluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy4kdGFibGVMb2FkaW5nLnNob3coKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmhpZGVMb2FkaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLiR0YWJsZUxvYWRpbmcuaGlkZSgpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUudG9nZ2xlUGFnaW5hdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLnBhZ2luYXRpb24gPSAhdGhpcy5vcHRpb25zLnBhZ2luYXRpb247XG4gICAgICAgIHZhciBidXR0b24gPSB0aGlzLiR0b29sYmFyLmZpbmQoJ2J1dHRvbltuYW1lPVwicGFnaW5hdGlvblN3aXRjaFwiXSBpJyk7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucGFnaW5hdGlvbikge1xuICAgICAgICAgICAgYnV0dG9uLmF0dHIoXCJjbGFzc1wiLCB0aGlzLm9wdGlvbnMuaWNvbnNQcmVmaXggKyBcIiBcIiArIHRoaXMub3B0aW9ucy5pY29ucy5wYWdpbmF0aW9uU3dpdGNoRG93bik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidXR0b24uYXR0cihcImNsYXNzXCIsIHRoaXMub3B0aW9ucy5pY29uc1ByZWZpeCArIFwiIFwiICsgdGhpcy5vcHRpb25zLmljb25zLnBhZ2luYXRpb25Td2l0Y2hVcCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVQYWdpbmF0aW9uKCk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICBpZiAocGFyYW1zICYmIHBhcmFtcy51cmwpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyID0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRTZXJ2ZXIocGFyYW1zICYmIHBhcmFtcy5zaWxlbnQsXG4gICAgICAgICAgICBwYXJhbXMgJiYgcGFyYW1zLnF1ZXJ5LCBwYXJhbXMgJiYgcGFyYW1zLnVybCk7XG4gICAgICAgIHRoaXMudHJpZ2dlcigncmVmcmVzaCcsIHBhcmFtcyk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5yZXNldFdpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNob3dIZWFkZXIgJiYgdGhpcy5vcHRpb25zLmhlaWdodCkge1xuICAgICAgICAgICAgdGhpcy5maXRIZWFkZXIoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNob3dGb290ZXIpIHtcbiAgICAgICAgICAgIHRoaXMuZml0Rm9vdGVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnNob3dDb2x1bW4gPSBmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgICAgdGhpcy50b2dnbGVDb2x1bW4oZ2V0RmllbGRJbmRleCh0aGlzLmNvbHVtbnMsIGZpZWxkKSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5oaWRlQ29sdW1uID0gZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlQ29sdW1uKGdldEZpZWxkSW5kZXgodGhpcy5jb2x1bW5zLCBmaWVsZCksIGZhbHNlLCB0cnVlKTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmdldEhpZGRlbkNvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkLmdyZXAodGhpcy5jb2x1bW5zLCBmdW5jdGlvbiAoY29sdW1uKSB7XG4gICAgICAgICAgICByZXR1cm4gIWNvbHVtbi52aXNpYmxlO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmdldFZpc2libGVDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJC5ncmVwKHRoaXMuY29sdW1ucywgZnVuY3Rpb24gKGNvbHVtbikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbHVtbi52aXNpYmxlO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnRvZ2dsZUFsbENvbHVtbnMgPSBmdW5jdGlvbiAodmlzaWJsZSkge1xuICAgICAgICAkLmVhY2godGhpcy5jb2x1bW5zLCBmdW5jdGlvbiAoaSwgY29sdW1uKSB7XG4gICAgICAgICAgICB0aGlzLmNvbHVtbnNbaV0udmlzaWJsZSA9IHZpc2libGU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuaW5pdEhlYWRlcigpO1xuICAgICAgICB0aGlzLmluaXRTZWFyY2goKTtcbiAgICAgICAgdGhpcy5pbml0UGFnaW5hdGlvbigpO1xuICAgICAgICB0aGlzLmluaXRCb2R5KCk7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd0NvbHVtbnMpIHtcbiAgICAgICAgICAgIHZhciAkaXRlbXMgPSB0aGlzLiR0b29sYmFyLmZpbmQoJy5rZWVwLW9wZW4gaW5wdXQnKS5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcblxuICAgICAgICAgICAgaWYgKCRpdGVtcy5maWx0ZXIoJzpjaGVja2VkJykubGVuZ3RoIDw9IHRoaXMub3B0aW9ucy5taW5pbXVtQ291bnRDb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgJGl0ZW1zLmZpbHRlcignOmNoZWNrZWQnKS5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5zaG93QWxsQ29sdW1ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy50b2dnbGVBbGxDb2x1bW5zKHRydWUpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuaGlkZUFsbENvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlQWxsQ29sdW1ucyhmYWxzZSk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5maWx0ZXJCeSA9IGZ1bmN0aW9uIChjb2x1bW5zKSB7XG4gICAgICAgIHRoaXMuZmlsdGVyQ29sdW1ucyA9ICQuaXNFbXB0eU9iamVjdChjb2x1bW5zKSA/IHt9IDogY29sdW1ucztcbiAgICAgICAgdGhpcy5vcHRpb25zLnBhZ2VOdW1iZXIgPSAxO1xuICAgICAgICB0aGlzLmluaXRTZWFyY2goKTtcbiAgICAgICAgdGhpcy51cGRhdGVQYWdpbmF0aW9uKCk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5zY3JvbGxUbyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSA9PT0gJ2JvdHRvbScgPyB0aGlzLiR0YWJsZUJvZHlbMF0uc2Nyb2xsSGVpZ2h0IDogMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdGhpcy4kdGFibGVCb2R5LnNjcm9sbFRvcCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiR0YWJsZUJvZHkuc2Nyb2xsVG9wKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmdldFNjcm9sbFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY3JvbGxUbygpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuc2VsZWN0UGFnZSA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICAgIGlmIChwYWdlID4gMCAmJiBwYWdlIDw9IHRoaXMub3B0aW9ucy50b3RhbFBhZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMucGFnZU51bWJlciA9IHBhZ2U7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVBhZ2luYXRpb24oKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUucHJldlBhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucGFnZU51bWJlciA+IDEpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wYWdlTnVtYmVyLS07XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVBhZ2luYXRpb24oKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUubmV4dFBhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucGFnZU51bWJlciA8IHRoaXMub3B0aW9ucy50b3RhbFBhZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMucGFnZU51bWJlcisrO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVQYWdpbmF0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnRvZ2dsZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5jYXJkVmlldyA9ICF0aGlzLm9wdGlvbnMuY2FyZFZpZXc7XG4gICAgICAgIHRoaXMuaW5pdEhlYWRlcigpO1xuICAgICAgICAvLyBGaXhlZCByZW1vdmUgdG9vbGJhciB3aGVuIGNsaWNrIGNhcmRWaWV3IGJ1dHRvbi5cbiAgICAgICAgLy90aGF0LmluaXRUb29sYmFyKCk7XG4gICAgICAgIHRoaXMuaW5pdEJvZHkoKTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCd0b2dnbGUnLCB0aGlzLm9wdGlvbnMuY2FyZFZpZXcpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUucmVmcmVzaE9wdGlvbnMgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICAvL0lmIHRoZSBvYmplY3RzIGFyZSBlcXVpdmFsZW50IHRoZW4gYXZvaWQgdGhlIGNhbGwgb2YgZGVzdHJveSAvIGluaXQgbWV0aG9kc1xuICAgICAgICBpZiAoY29tcGFyZU9iamVjdHModGhpcy5vcHRpb25zLCBvcHRpb25zLCB0cnVlKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMudHJpZ2dlcigncmVmcmVzaC1vcHRpb25zJywgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgdGhpcy5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuaW5pdCgpO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUucmVzZXRTZWFyY2ggPSBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICB2YXIgJHNlYXJjaCA9IHRoaXMuJHRvb2xiYXIuZmluZCgnLnNlYXJjaCBpbnB1dCcpO1xuICAgICAgICAkc2VhcmNoLnZhbCh0ZXh0IHx8ICcnKTtcbiAgICAgICAgdGhpcy5vblNlYXJjaCh7Y3VycmVudFRhcmdldDogJHNlYXJjaH0pO1xuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuZXhwYW5kUm93XyA9IGZ1bmN0aW9uIChleHBhbmQsIGluZGV4KSB7XG4gICAgICAgIHZhciAkdHIgPSB0aGlzLiRib2R5LmZpbmQoc3ByaW50ZignPiB0cltkYXRhLWluZGV4PVwiJXNcIl0nLCBpbmRleCkpO1xuICAgICAgICBpZiAoJHRyLm5leHQoKS5pcygndHIuZGV0YWlsLXZpZXcnKSA9PT0gKGV4cGFuZCA/IGZhbHNlIDogdHJ1ZSkpIHtcbiAgICAgICAgICAgICR0ci5maW5kKCc+IHRkID4gLmRldGFpbC1pY29uJykuY2xpY2soKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBCb290c3RyYXBUYWJsZS5wcm90b3R5cGUuZXhwYW5kUm93ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHRoaXMuZXhwYW5kUm93Xyh0cnVlLCBpbmRleCk7XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5jb2xsYXBzZVJvdyA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB0aGlzLmV4cGFuZFJvd18oZmFsc2UsIGluZGV4KTtcbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLmV4cGFuZEFsbFJvd3MgPSBmdW5jdGlvbiAoaXNTdWJUYWJsZSkge1xuICAgICAgICBpZiAoaXNTdWJUYWJsZSkge1xuICAgICAgICAgICAgdmFyICR0ciA9IHRoaXMuJGJvZHkuZmluZChzcHJpbnRmKCc+IHRyW2RhdGEtaW5kZXg9XCIlc1wiXScsIDApKSxcbiAgICAgICAgICAgICAgICB0aGF0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBkZXRhaWxJY29uID0gbnVsbCxcbiAgICAgICAgICAgICAgICBleGVjdXRlSW50ZXJ2YWwgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICBpZEludGVydmFsID0gLTE7XG5cbiAgICAgICAgICAgIGlmICghJHRyLm5leHQoKS5pcygndHIuZGV0YWlsLXZpZXcnKSkge1xuICAgICAgICAgICAgICAgICR0ci5maW5kKCc+IHRkID4gLmRldGFpbC1pY29uJykuY2xpY2soKTtcbiAgICAgICAgICAgICAgICBleGVjdXRlSW50ZXJ2YWwgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghJHRyLm5leHQoKS5uZXh0KCkuaXMoJ3RyLmRldGFpbC12aWV3JykpIHtcbiAgICAgICAgICAgICAgICAkdHIubmV4dCgpLmZpbmQoXCIuZGV0YWlsLWljb25cIikuY2xpY2soKTtcbiAgICAgICAgICAgICAgICBleGVjdXRlSW50ZXJ2YWwgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZXhlY3V0ZUludGVydmFsKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWRJbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbEljb24gPSB0aGF0LiRib2R5LmZpbmQoXCJ0ci5kZXRhaWwtdmlld1wiKS5sYXN0KCkuZmluZChcIi5kZXRhaWwtaWNvblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZXRhaWxJY29uLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxJY29uLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaWRJbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sIDEpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaWRJbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHRycyA9IHRoaXMuJGJvZHkuY2hpbGRyZW4oKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdHJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5leHBhbmRSb3dfKHRydWUsICQodHJzW2ldKS5kYXRhKFwiaW5kZXhcIikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIEJvb3RzdHJhcFRhYmxlLnByb3RvdHlwZS5jb2xsYXBzZUFsbFJvd3MgPSBmdW5jdGlvbiAoaXNTdWJUYWJsZSkge1xuICAgICAgICBpZiAoaXNTdWJUYWJsZSkge1xuICAgICAgICAgICAgdGhpcy5leHBhbmRSb3dfKGZhbHNlLCAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciB0cnMgPSB0aGlzLiRib2R5LmNoaWxkcmVuKCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuZXhwYW5kUm93XyhmYWxzZSwgJCh0cnNbaV0pLmRhdGEoXCJpbmRleFwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgQm9vdHN0cmFwVGFibGUucHJvdG90eXBlLnVwZGF0ZUZvcm1hdFRleHQgPSBmdW5jdGlvbiAobmFtZSwgdGV4dCkge1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zW3NwcmludGYoJ2Zvcm1hdCVzJywgbmFtZSldKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRleHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zW3NwcmludGYoJ2Zvcm1hdCVzJywgbmFtZSldID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dDtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGV4dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uc1tzcHJpbnRmKCdmb3JtYXQlcycsIG5hbWUpXSA9IHRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0VG9vbGJhcigpO1xuICAgICAgICB0aGlzLmluaXRQYWdpbmF0aW9uKCk7XG4gICAgICAgIHRoaXMuaW5pdEJvZHkoKTtcbiAgICB9O1xuXG4gICAgLy8gQk9PVFNUUkFQIFRBQkxFIFBMVUdJTiBERUZJTklUSU9OXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT1cblxuICAgIHZhciBhbGxvd2VkTWV0aG9kcyA9IFtcbiAgICAgICAgJ2dldE9wdGlvbnMnLFxuICAgICAgICAnZ2V0U2VsZWN0aW9ucycsICdnZXRBbGxTZWxlY3Rpb25zJywgJ2dldERhdGEnLFxuICAgICAgICAnbG9hZCcsICdhcHBlbmQnLCAncHJlcGVuZCcsICdyZW1vdmUnLCAncmVtb3ZlQWxsJyxcbiAgICAgICAgJ2luc2VydFJvdycsICd1cGRhdGVSb3cnLCAndXBkYXRlQ2VsbCcsICd1cGRhdGVCeVVuaXF1ZUlkJywgJ3JlbW92ZUJ5VW5pcXVlSWQnLFxuICAgICAgICAnZ2V0Um93QnlVbmlxdWVJZCcsICdzaG93Um93JywgJ2hpZGVSb3cnLCAnZ2V0Um93c0hpZGRlbicsXG4gICAgICAgICdtZXJnZUNlbGxzJyxcbiAgICAgICAgJ2NoZWNrQWxsJywgJ3VuY2hlY2tBbGwnLCAnY2hlY2tJbnZlcnQnLFxuICAgICAgICAnY2hlY2snLCAndW5jaGVjaycsXG4gICAgICAgICdjaGVja0J5JywgJ3VuY2hlY2tCeScsXG4gICAgICAgICdyZWZyZXNoJyxcbiAgICAgICAgJ3Jlc2V0VmlldycsXG4gICAgICAgICdyZXNldFdpZHRoJyxcbiAgICAgICAgJ2Rlc3Ryb3knLFxuICAgICAgICAnc2hvd0xvYWRpbmcnLCAnaGlkZUxvYWRpbmcnLFxuICAgICAgICAnc2hvd0NvbHVtbicsICdoaWRlQ29sdW1uJywgJ2dldEhpZGRlbkNvbHVtbnMnLCAnZ2V0VmlzaWJsZUNvbHVtbnMnLFxuICAgICAgICAnc2hvd0FsbENvbHVtbnMnLCAnaGlkZUFsbENvbHVtbnMnLFxuICAgICAgICAnZmlsdGVyQnknLFxuICAgICAgICAnc2Nyb2xsVG8nLFxuICAgICAgICAnZ2V0U2Nyb2xsUG9zaXRpb24nLFxuICAgICAgICAnc2VsZWN0UGFnZScsICdwcmV2UGFnZScsICduZXh0UGFnZScsXG4gICAgICAgICd0b2dnbGVQYWdpbmF0aW9uJyxcbiAgICAgICAgJ3RvZ2dsZVZpZXcnLFxuICAgICAgICAncmVmcmVzaE9wdGlvbnMnLFxuICAgICAgICAncmVzZXRTZWFyY2gnLFxuICAgICAgICAnZXhwYW5kUm93JywgJ2NvbGxhcHNlUm93JywgJ2V4cGFuZEFsbFJvd3MnLCAnY29sbGFwc2VBbGxSb3dzJyxcbiAgICAgICAgJ3VwZGF0ZUZvcm1hdFRleHQnXG4gICAgXTtcblxuICAgICQuZm4uYm9vdHN0cmFwVGFibGUgPSBmdW5jdGlvbiAob3B0aW9uKSB7XG4gICAgICAgIHZhciB2YWx1ZSxcbiAgICAgICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuXG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgIGRhdGEgPSAkdGhpcy5kYXRhKCdib290c3RyYXAudGFibGUnKSxcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gJC5leHRlbmQoe30sIEJvb3RzdHJhcFRhYmxlLkRFRkFVTFRTLCAkdGhpcy5kYXRhKCksXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBvcHRpb24gPT09ICdvYmplY3QnICYmIG9wdGlvbik7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkob3B0aW9uLCBhbGxvd2VkTWV0aG9kcykgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVua25vd24gbWV0aG9kOiBcIiArIG9wdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGFbb3B0aW9uXS5hcHBseShkYXRhLCBhcmdzKTtcblxuICAgICAgICAgICAgICAgIGlmIChvcHRpb24gPT09ICdkZXN0cm95Jykge1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy5yZW1vdmVEYXRhKCdib290c3RyYXAudGFibGUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgICAgICR0aGlzLmRhdGEoJ2Jvb3RzdHJhcC50YWJsZScsIChkYXRhID0gbmV3IEJvb3RzdHJhcFRhYmxlKHRoaXMsIG9wdGlvbnMpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnID8gdGhpcyA6IHZhbHVlO1xuICAgIH07XG5cbiAgICAkLmZuLmJvb3RzdHJhcFRhYmxlLkNvbnN0cnVjdG9yID0gQm9vdHN0cmFwVGFibGU7XG4gICAgJC5mbi5ib290c3RyYXBUYWJsZS5kZWZhdWx0cyA9IEJvb3RzdHJhcFRhYmxlLkRFRkFVTFRTO1xuICAgICQuZm4uYm9vdHN0cmFwVGFibGUuY29sdW1uRGVmYXVsdHMgPSBCb290c3RyYXBUYWJsZS5DT0xVTU5fREVGQVVMVFM7XG4gICAgJC5mbi5ib290c3RyYXBUYWJsZS5sb2NhbGVzID0gQm9vdHN0cmFwVGFibGUuTE9DQUxFUztcbiAgICAkLmZuLmJvb3RzdHJhcFRhYmxlLm1ldGhvZHMgPSBhbGxvd2VkTWV0aG9kcztcbiAgICAkLmZuLmJvb3RzdHJhcFRhYmxlLnV0aWxzID0ge1xuICAgICAgICBzcHJpbnRmOiBzcHJpbnRmLFxuICAgICAgICBnZXRGaWVsZEluZGV4OiBnZXRGaWVsZEluZGV4LFxuICAgICAgICBjb21wYXJlT2JqZWN0czogY29tcGFyZU9iamVjdHMsXG4gICAgICAgIGNhbGN1bGF0ZU9iamVjdFZhbHVlOiBjYWxjdWxhdGVPYmplY3RWYWx1ZSxcbiAgICAgICAgZ2V0SXRlbUZpZWxkOiBnZXRJdGVtRmllbGQsXG4gICAgICAgIG9iamVjdEtleXM6IG9iamVjdEtleXMsXG4gICAgICAgIGlzSUVCcm93c2VyOiBpc0lFQnJvd3NlclxuICAgIH07XG5cbiAgICAvLyBCT09UU1RSQVAgVEFCTEUgSU5JVFxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCgnW2RhdGEtdG9nZ2xlPVwidGFibGVcIl0nKS5ib290c3RyYXBUYWJsZSgpO1xuICAgIH0pO1xufSkoalF1ZXJ5KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vYXNzZXRzL2pzL3BsdWdpbnMvYm9vdHN0cmFwLXRhYmxlL2Jvb3RzdHJhcC10YWJsZS5qc1xuLy8gbW9kdWxlIGlkID0gNDhcbi8vIG1vZHVsZSBjaHVua3MgPSA0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///48\n")},49:function(module,exports){eval('/*\n* bootstrap-table - v1.9.0 - 2015-09-30\n* https://github.com/wenzhixin/bootstrap-table\n* Copyright (c) 2015 zhixin wen\n* Licensed MIT License\n*/\n!function(a){"use strict";a.fn.bootstrapTable.locales["zh-CN"]={formatLoadingMessage:function(){return"正在努力地加载数据中，请稍候……"},formatRecordsPerPage:function(a){return"每页显示 "+a+" 条记录"},formatShowingRows:function(a,b,c){return"显示第 "+a+" 到第 "+b+" 条记录，总共 "+c+" 条记录"},formatSearch:function(){return"搜索"},formatNoMatches:function(){return"没有找到匹配的记录"},formatPaginationSwitch:function(){return"隐藏/显示分页"},formatRefresh:function(){return"刷新"},formatToggle:function(){return"切换"},formatColumns:function(){return"列"}},a.extend(a.fn.bootstrapTable.defaults,a.fn.bootstrapTable.locales["zh-CN"])}(jQuery);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanMvcGx1Z2lucy9ib290c3RyYXAtdGFibGUvbG9jYWxlL2Jvb3RzdHJhcC10YWJsZS16aC1DTi5taW4uanM/MWYyOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGFBQWEsc0NBQXNDLGdDQUFnQyx5QkFBeUIsa0NBQWtDLHVCQUF1QixtQ0FBbUMsNENBQTRDLHlCQUF5QixXQUFXLDRCQUE0QixrQkFBa0IsbUNBQW1DLGdCQUFnQiwwQkFBMEIsV0FBVyx5QkFBeUIsV0FBVywwQkFBMEIsV0FBVyw2RUFBNkUiLCJmaWxlIjoiNDkuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuKiBib290c3RyYXAtdGFibGUgLSB2MS45LjAgLSAyMDE1LTA5LTMwXG4qIGh0dHBzOi8vZ2l0aHViLmNvbS93ZW56aGl4aW4vYm9vdHN0cmFwLXRhYmxlXG4qIENvcHlyaWdodCAoYykgMjAxNSB6aGl4aW4gd2VuXG4qIExpY2Vuc2VkIE1JVCBMaWNlbnNlXG4qL1xuIWZ1bmN0aW9uKGEpe1widXNlIHN0cmljdFwiO2EuZm4uYm9vdHN0cmFwVGFibGUubG9jYWxlc1tcInpoLUNOXCJdPXtmb3JtYXRMb2FkaW5nTWVzc2FnZTpmdW5jdGlvbigpe3JldHVyblwi5q2j5Zyo5Yqq5Yqb5Zyw5Yqg6L295pWw5o2u5Lit77yM6K+356iN5YCZ4oCm4oCmXCJ9LGZvcm1hdFJlY29yZHNQZXJQYWdlOmZ1bmN0aW9uKGEpe3JldHVyblwi5q+P6aG15pi+56S6IFwiK2ErXCIg5p2h6K6w5b2VXCJ9LGZvcm1hdFNob3dpbmdSb3dzOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm5cIuaYvuekuuesrCBcIithK1wiIOWIsOesrCBcIitiK1wiIOadoeiusOW9le+8jOaAu+WFsSBcIitjK1wiIOadoeiusOW9lVwifSxmb3JtYXRTZWFyY2g6ZnVuY3Rpb24oKXtyZXR1cm5cIuaQnOe0olwifSxmb3JtYXROb01hdGNoZXM6ZnVuY3Rpb24oKXtyZXR1cm5cIuayoeacieaJvuWIsOWMuemFjeeahOiusOW9lVwifSxmb3JtYXRQYWdpbmF0aW9uU3dpdGNoOmZ1bmN0aW9uKCl7cmV0dXJuXCLpmpDol48v5pi+56S65YiG6aG1XCJ9LGZvcm1hdFJlZnJlc2g6ZnVuY3Rpb24oKXtyZXR1cm5cIuWIt+aWsFwifSxmb3JtYXRUb2dnbGU6ZnVuY3Rpb24oKXtyZXR1cm5cIuWIh+aNolwifSxmb3JtYXRDb2x1bW5zOmZ1bmN0aW9uKCl7cmV0dXJuXCLliJdcIn19LGEuZXh0ZW5kKGEuZm4uYm9vdHN0cmFwVGFibGUuZGVmYXVsdHMsYS5mbi5ib290c3RyYXBUYWJsZS5sb2NhbGVzW1wiemgtQ05cIl0pfShqUXVlcnkpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9hc3NldHMvanMvcGx1Z2lucy9ib290c3RyYXAtdGFibGUvbG9jYWxlL2Jvb3RzdHJhcC10YWJsZS16aC1DTi5taW4uanNcbi8vIG1vZHVsZSBpZCA9IDQ5XG4vLyBtb2R1bGUgY2h1bmtzID0gNCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///49\n')},50:function(module,exports){eval('(function($) {\n\t// 初始\n\t$.init = function() {\n\t\t$.initGrid();\n\t\t// 查询\n\t\t$.handlerSearch();\n\t\t// 重置查询\n\t\t$.handlerReSetSearch();\n\t\t// 删除选中行\n\t\t$.handlerRemoveSelect();\n\n\t\t$.handlerCollapseExpand();\n\t};\n\t// 查询\n\t$.search = function(obj) {\n\t\tif ($(obj).hasClass(\'disabled\'))\n\t\t\treturn;\n\t\tvar param = {};\n\t\t$("input,select","#searchForm").each(function(item,i){\n\t\t\tif(!$(this).val())return ;\n\t\t\tparam[$(this).attr("id")] = $(this).val();\n\t\t});\n\t\t\n\t\t$("[ab-grid]").bootstrapTable("refresh",{query:param});\n\t};\n\n\t// 清空查询参数 重置查询\n\t$.clearSearch = function() {\n\t\tvar inputs = $("input,select","#searchForm");\n\t\t$(inputs).each(function(i, k) {\n\t\t\tk.value = "";\n\t\t});\n\t\t$.search();\n\t};\n\n\t/**\n\t * obj：选择的范围，默认body\n\t */\n\t$.getDatagridCheckedId = function() {\n\t\tvar arrays = $("[ab-grid]").bootstrapTable(\'getSelections\');\n\t\tvar idName = $("[ab-grid]").bootstrapTable(\'getOptions\').idField;\n\t\tvar ids = [];\n\t\tarrays.forEach(function(item){\n\t\t\tids.push(item[idName]);\n\t\t})\n\t\t\n\t\treturn ids;\n\t}\n\n\t$.getUrl = function(url, param) {\n\t\tif (url.indexOf(\'http://\') == 0 || url.indexOf(__ctx) == 0) {// 已是标准请求地址或已带项目前缀\n\t\t\treturn url;\n\t\t}\n\n\t\treturn __ctx + url;// 加上项目前缀\n\t}\n\n\t// 处理查询\n\t$.handlerSearch = function() {\n\t\tvar $obj = $("#searchForm .btn.fa-search");\n\t\t$obj.unbind(\'click\');\n\t\t$obj.click(function() {\n\t\t\t$.search(this);\n\t\t});\n\t};\n\t// 重置处理查询\n\t$.handlerReSetSearch = function() {\n\t\tvar $obj = $("#searchForm .btn.fa-rotate-left");\n\t\t$obj.unbind(\'click\');\n\t\t$obj.click(function() {\n\t\t\t$.clearSearch(this);\n\t\t});\n\t};\n\n\n\t// 删除选中行\n\t$.handlerRemoveSelect = function() {\n\t\tvar $obj = $(".toolbar  a.btn.fa-remove");\n\t\t$obj.unbind(\'click\');\n\t\t$obj.bind(\'click\', function() {\n\t\t\tif ($(this).hasClass(\'disabled\')) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar ids = $.getDatagridCheckedId();// 删除的ID数组\n\t\t\tvar url = $(this).attr("url");// 删除请求的URL\n\t\t\tvar idField = $("[ab-grid]").bootstrapTable(\'getOptions\').idField;// 主键key\n\t\t\tif (ids == null || ids.length < 1) {\n\t\t\t\t$.Dialog.msg(\'请选择记录!\');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (url == null || url == \'\') {\n\t\t\t\t$.Dialog.msg(\'未找到配置参数[action]!\');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\turl = $.getUrl(url);\n\n\t\t\tvar param = {};\n\t\t\tparam[idField] = ids.join(\',\');\n\n\t\t\t$.Dialog.confirm("温馨提示", "是否要删除选中的项", function() {\n\t\t\t\t$.post(url, param, function(data) {\n\t\t\t\t\tvar resultMessage = new com.dstz.form.ResultMessage(data);\n\t\t\t\t\tif (resultMessage.isSuccess()) {\n\t\t\t\t\t\ttoastr.success("删除成功");\n\t\t\t\t\t\t$(\'[ab-grid]\').bootstrapTable(\'refresh\');\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$.Dialog.alert("请求出错，请联系管理员。错误内容：" + resultMessage.getMessage());\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t});\n\t};\n\n\t$.handlerCollapseExpand = function() {\n\t\tvar $obj = $(\'[toggle-collapse]\');\n\t\t$obj.unbind(\'click\');\n\t\t// 收缩、展开\n\t\t$obj.bind("click", function() {\n\t\t\tvar me = $(this);\n\t\t\tvar el = $(me.attr("toggle-collapse"));\n\t\t\tif (!me.hasClass("expand")) {\n\t\t\t\tme.attr("title", "展开");\n\t\t\t\tme.removeClass("collapse").addClass("expand");\n\t\t\t\tme.removeClass("fa-angle-double-up").addClass("fa-angle-double-down");\n\t\t\t\tel.slideUp(200);\n\t\t\t} else {\n\t\t\t\tme.attr("title", "收缩");\n\t\t\t\tme.removeClass("expand").addClass("collapse");\n\t\t\t\tme.removeClass("fa-angle-double-down").addClass("fa-angle-double-up");\n\t\t\t\tel.slideDown(200);\n\t\t\t}\n\t\t\t// 重置\n\t\t\twindow.setTimeout(function() {\n\t\t\t\tresizeGrid();\n\t\t\t}, 300);\n\t\t});\n\t\tif($obj.attr("closed")){\n\t\t\t$obj.click();\n\t\t}\n\t\t\n\t}\n\t$.initGrid = function(){\n\t\t\n\t\tvar url = $("[ab-grid]").attr("data-url");\n\t\turl = getCtxUrl(url,true);\n\n\t\t$("[ab-grid]").bootstrapTable({\n\t\t\turl:url,\n            method: \'post\',                      //请求方式（*）\n            contentType:\'application/x-www-form-urlencoded\',\n            toolbar: \'.toolbar\',                //工具按钮用哪个容器\n   //         striped: false,                      //是否显示行间隔色\n            cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）\n            pagination: true,                   //是否显示分页（*）\n            sortable: true,                     //是否启用排序\n            sortOrder: "asc",\t\t\t\t\t//排序方式\n            queryParams: $.getQueryParam,\t\t//传递参数（*）\n            sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）\n            pageNumber:1,                       //初始化加载第一页，默认第一页\n            pageSize: 10,                       //每页的记录行数（*）\n            pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）\n            search: false,                      //是否显示表格搜索\n            strictSearch: false,\t\t\t\t//全匹配搜索\n            showColumns: true,                  //是否显示所有的列\n            showRefresh: true,                  //是否显示刷新按钮\n            minimumCountColumns: 2,             //最少允许的列数\n            clickToSelect: true,                //是否启用点击选中行\n        //  height: 500,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度\n            uniqueId: "id",                     //每一行的唯一标识，一般为主键列\n            showToggle:false,                   //是否显示详细视图和列表视图的切换按钮\n            cardView: false,                    //是否显示详细视图\n            detailView: false,                  //是否显示父子表\n            striped:true,\t\t\t\t\t\t//隔行变色效果\n            classes:\'table table-hover\',\t\t//表格样式\n            searchAlign:\'right\',\n            onLoadSuccess: dataCheck\n        });\n\t\t\n\t}\n\t//获取参数\n\t$.getQueryParam = function(params){\n\t\t//params.limit,   //页面大小\n       // params.offset,  //页码\n\t\t//bug sort\n\t\t\n\t\treturn params;\n\t}\n\n})(jQuery);\n\n$(function() {\n\t$.init();\n\trowsManager.sendAction();\n\tresizeGrid();\n\tinitQtip();\n\tinitButtonPermission();\n});\n\nfunction dataCheck(data){\n\tif(data.isOk === false && data.code === "401"){\n\t\t jQuery.Toast.error("登录超时，请重新登录");\n\t}\n}\n\nfunction initQtip(){\n\t$("body").delegate("[qtip]", \'mouseover\', function() {\n\t\tvar qtipApi = $(this).qtip("api"); \n\t\tvar msg = $(this).attr("qtip");\n\t\tif(!qtipApi){\n\t\t\tvar defaultSetting = {\n\t\t\t\t\tshow: { solo: true },\n\t\t\t\t\tstyle: {classes: \'qtip-default  qtip qtip-bootstrap qtip-shadow\' },//position: { my: \'center left\', at: \'center right\'},\n\t\t\t\t\tposition : { my: \'bottom center\', at: \'top center\'},\n\t\t\t\t\tcontent : msg\n\t\t\t};\n\t\t\n\t\t\t $(this).qtip(defaultSetting);\t\n\t\t\t qtipApi = $(this).qtip("api"); \n\t\t}else{\n\t\t\tif(qtipApi.disabled)qtipApi.enable();\n\t\t}\n\t\tqtipApi.show();\n\t});\n}\n\nfunction initButtonPermission(){\n\t$("[ab-btn-rights]").each(function(){\n\t\thandelPermission(this)\n\t})\n}\nfunction handelPermission(target){\n\tvar btnRightsKey = $(target).attr("ab-btn-rights");\n\tif(window.localStorage){\n\t\tvar btnPermission = window.localStorage.getItem( \'buttonPermision\' );\n\t\tbtnPermission = btnPermission ? JSON.parse( btnPermission ) : {};\n\t\t \n\t\tif( btnRightsKey && btnPermission[btnRightsKey]){\n\t\t\treturn;\n\t\t}\n\t\tconsole.info(btnRightsKey +" no rights");\n\t\t$(target).hide();\n\t}else{\n\t\tconsole.info("浏览器版本太低不支持按钮权限！");\n\t}\n}\n\n\nwindow.reloadGrid = function() {\n\tif ($(\'[ab-grid]\').length == 1) $(\'[ab-grid]\').bootstrapTable(\'refresh\');\n}\nfunction resizeGrid(){\n\tvar pageSize = $.getPageSize();\n\tif(!pageSize.height){ return;  }\n\t\n\tvar searchHeith = $(".search-panel").height()+10;\n\t$(\'[ab-grid]\').bootstrapTable(\'resetView\',{height:pageSize.height-searchHeith})\n}\n\n\n\nwindow.labelFmt = function(arr, value) {\n\tfor(var i=0,item;item=arr[i++];){\n\t\tif(item.key==value){\n\t\t\treturn \'<span class="label label-\'+item.css+\'">\'+item.val+\'</span>\'\n\t\t}\n\t}\n  return \'\';\n}\n\n\n// 打开一个连接\nvar rowsManager = {};\n\nrowsManager.getUrl = function(obj) {\n\tvar url = obj.attr("url");\n\tif (!url)\n\t\treturn "";\n\n\tif (url.substr(0, 1) == "/" && url.substr(0, 7) != "http://") {\n\t\turl = __ctx + url;\n\t}\n\treturn url;\n}\n\n// 执行一个动作\nrowsManager.sendAction = function() {\n\t$("body").delegate("[sendAction]", \'click\', function() {\n\t\tvar me = $(this);\n\t\tvar url = rowsManager.getUrl(me);\n\t\tif(!url)alert("url不能为空！");\n\t\t\n\t\tvar text = me.attr("sendAction") || me.text();\n\t\t$.Dialog.confirm("对话框", \'确认\' + text + \'吗？\', function(r) {\n\t\t\tif (!r)\n\t\t\t\treturn;\n\t\t\t$.post(url, function(responseText) {\n\t\t\t\tvar result\t= eval(\'(\' + responseText + \')\');\n\t\t\t\tif (result.isOk) {\n\t\t\t\t\t$.Toast.success(text + \'成功！\', function() {\n\t\t\t\t\t\treloadGrid();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$.Toast.error(result.msg);\n\t\t\t\t}\n\t\t\t});\n\n\t\t});\n\n\t});\n};\n\n\n//常用的格式化\nwindow.dateTimeFormatter=function(value, row, index) {\n    if (value == null || value == ""){return "";}\n    //IE 不支持  new date(“2018-11-9”);\n    if(value.indexOf("-")!=-1){\n    \tvalue = value.replaceAll("-",\'/\');\n    }\n    \n    return new Date(value).format("yyyy-MM-dd HH:mm:ss");\n};\n\nwindow.dateFormatter=function(value, row, index) {\n\tif (value == null || value == ""){return "";}\n    if(value.indexOf("-")!=-1){\n    \tvalue = value.replaceAll("-",\'/\');\n    }\n    return new Date(value).format("yyyy-MM-dd");\n}\n/**\n * 在ab-grid 的colom配置中\n * @eg: data-formatter="labelFormatter" data-val-text="{\'0\':\'禁用\',\'1\':\'启用\'}" data-val-style="{\'0\':\'primary\',\'1\':\'info\'}"\n * @valStyle : default primary success info warning danger\n * @valText key对应的text值的配置\n * @eg: 其他形式 data-value-style="key_val_style,key2_val2_style2,"\n */\nwindow.labelFormatter = function(value, row, index){\n\tif (value === null || value === "")  return "";\n\tvar lableStyle = \'primary\';\n\t\n\t/**如果是data-val-text第一种形式*/\n\tif(this.valText){\n\t\ttry{\n\t\t\tvar valText = eval("("+this.valText+")");\n\t\t\tvar labelText = valText[value];\n\t\t\tif(labelText == undefined) labelText = \'\';\n\t\t\t\n\t\t\tif(this.valStyle){\n\t\t\t\tvar valStyle = eval("("+this.valStyle+")");\n\t\t\t\tif(valStyle[value]){\n\t\t\t\t\tlableStyle = valStyle[value];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn \'<span class="label label-\'+lableStyle+\'">\'+labelText+\'</span>\';\n\t\t}catch(e){\n\t\t\tconsole.error(e+"格式化异常！"+row);\n\t\t\tif(labelText){\n\t\t\t\treturn labelText;\n\t\t\t}\n\t\t}\n\t}\n\t/** 第二种实现 data-value-style="key-val-style,key2-val2-style2,"*/\n\tif(this.valueStyle){\n\t\tvar patt = new RegExp("(?="+value+"-).*?(?=,)","g");\n\t\ttry{\n\t\tvar result = patt.exec(this.valueStyle);\n\t\tif(result && result[0]){\n\t\t\tvar vs = result[0].split("-");\n\t\t\tif(vs.length==3){\n\t\t\t\tlableStyle =vs[2];\n\t\t\t}\n\t\t\treturn \'<span class="label label-\'+lableStyle+\'">\'+vs[1]+\'</span>\';\n\t\t}\n\t\t}catch(e){\n\t\t\tconsole.error(row);\n\t\t\tconsole.error("labelFormatter格式化异常:"+valueStyle,e);\n\t\t}\n\t}\n\t\n\treturn value;\n\t\n}\n\n/**\n * 可以对bootstrapTable 的内容进行HTML形式的格式化，此时使用data-title作为title，innerHtml则进行参数格式化<br>\n * @提示 使用innerHtmlFormatter 必须添加 data-title属性\n * @param row\n * eg:<th data-field="value" data-formatter="innerHtmlFormatter" data-title="管理">\n *   \t<a class=\'btn btn-outline btn-primary fa fa-edit\' openDialog=\'编辑\'qtip=\'编辑\' url=\'./sysPropertiesEdit.html?id={id}\'></a>\n *\t\t<a class=\'btn btn-outline btn-primary fa fa-detail\' openDialog=\'明细\' qtip=\'明细\' url=\'./sysPropertiesGet.html?id={id}\'></a>\n *\t\t<a class=\' btn btn-outline btn-primary fa  fa-trash\' sendAction=\'删除\' qtip=\'删除\' url=\'/sys/sysProperties/remove?id={id}\'></a>\n *    </th>\n * 案例中会对innerHTML的{id}进行取值，数据scope为row，eg:row.id 可以用{id}取值\n */\nwindow.innerHtmlFormatter = function(value, row, index){\n\trow.__ctx=__ctx;\n\tif(row && this.html){\n\t\tvar htmlStr = this.html.format(row);\n\t\t\n\t\tvar jqHtml = $("<div>"+htmlStr+"</div>");\n\t\tvar ifEl = $("[if]",jqHtml);\n\t\tvar btnRightEl = $("[ab-btn-rights]",jqHtml);\n\t\t\n\t\t// 权限标签\n\t\tfor(var j_=0,btn_;btn_=btnRightEl[j_++];){\n\t\t\thandelPermission(btn_);\n\t\t}\n\t\t// if 标签\n\t\ttry{\n\t\t\tfor(var i_=0,item_;item_=ifEl[i_++];){\n\t\t\t\tvar fnStr = $(item_).attr("if");\n\t\t\t\tif(!eval(fnStr)){\n\t\t\t\t\t$(item_).remove();\n\t\t\t\t}\n\t\t\t}\n\t\t}catch (e) {\n\t\t\tconsole.error(row);\n\t\t\tconsole.error("innerHtmlFormatter if 标签解析异常:"+fnStr,e);\n\t\t}\n\t\t\n\t\treturn jqHtml[0].innerHTML;\n\t}\n\treturn "";\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanMvY29tbW9uL2dyaWQuanM/YzkzOSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUgsMkNBQTJDLFlBQVk7QUFDdkQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBLCtEQUErRDtBQUMvRDtBQUNBOztBQUVBLHFCQUFxQjtBQUNyQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsc0NBQXNDO0FBQ3RDLGlDQUFpQztBQUNqQyxxRUFBcUU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTs7QUFFSixHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esb0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGFBQWE7QUFDekIsYUFBYSwwREFBMEQsY0FBYyx1Q0FBdUM7QUFDNUgsaUJBQWlCLHVDQUF1QztBQUN4RDtBQUNBOztBQUVBLGlDO0FBQ0Esa0M7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsUUFBUTs7QUFFOUI7QUFDQSw0Q0FBNEMsbUNBQW1DO0FBQy9FOzs7O0FBSUE7QUFDQSxrQkFBa0IsY0FBYztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTs7QUFFSixHQUFHOztBQUVILEVBQUU7QUFDRjs7O0FBR0E7QUFDQTtBQUNBLHNDQUFzQztBQUN0QztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELGtCQUFrQixtQkFBbUIseUJBQXlCO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1IQUFtSCxHQUFHO0FBQ3RILG1IQUFtSCxHQUFHO0FBQ3RILHNIQUFzSCxHQUFHO0FBQ3pIO0FBQ0EsbUJBQW1CLEdBQUcsK0JBQStCLEdBQUc7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0Isc0JBQXNCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGlCQUFpQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiI1MC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigkKSB7XG5cdC8vIOWIneWni1xuXHQkLmluaXQgPSBmdW5jdGlvbigpIHtcblx0XHQkLmluaXRHcmlkKCk7XG5cdFx0Ly8g5p+l6K+iXG5cdFx0JC5oYW5kbGVyU2VhcmNoKCk7XG5cdFx0Ly8g6YeN572u5p+l6K+iXG5cdFx0JC5oYW5kbGVyUmVTZXRTZWFyY2goKTtcblx0XHQvLyDliKDpmaTpgInkuK3ooYxcblx0XHQkLmhhbmRsZXJSZW1vdmVTZWxlY3QoKTtcblxuXHRcdCQuaGFuZGxlckNvbGxhcHNlRXhwYW5kKCk7XG5cdH07XG5cdC8vIOafpeivolxuXHQkLnNlYXJjaCA9IGZ1bmN0aW9uKG9iaikge1xuXHRcdGlmICgkKG9iaikuaGFzQ2xhc3MoJ2Rpc2FibGVkJykpXG5cdFx0XHRyZXR1cm47XG5cdFx0dmFyIHBhcmFtID0ge307XG5cdFx0JChcImlucHV0LHNlbGVjdFwiLFwiI3NlYXJjaEZvcm1cIikuZWFjaChmdW5jdGlvbihpdGVtLGkpe1xuXHRcdFx0aWYoISQodGhpcykudmFsKCkpcmV0dXJuIDtcblx0XHRcdHBhcmFtWyQodGhpcykuYXR0cihcImlkXCIpXSA9ICQodGhpcykudmFsKCk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0JChcIlthYi1ncmlkXVwiKS5ib290c3RyYXBUYWJsZShcInJlZnJlc2hcIix7cXVlcnk6cGFyYW19KTtcblx0fTtcblxuXHQvLyDmuIXnqbrmn6Xor6Llj4LmlbAg6YeN572u5p+l6K+iXG5cdCQuY2xlYXJTZWFyY2ggPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgaW5wdXRzID0gJChcImlucHV0LHNlbGVjdFwiLFwiI3NlYXJjaEZvcm1cIik7XG5cdFx0JChpbnB1dHMpLmVhY2goZnVuY3Rpb24oaSwgaykge1xuXHRcdFx0ay52YWx1ZSA9IFwiXCI7XG5cdFx0fSk7XG5cdFx0JC5zZWFyY2goKTtcblx0fTtcblxuXHQvKipcblx0ICogb2Jq77ya6YCJ5oup55qE6IyD5Zu077yM6buY6K6kYm9keVxuXHQgKi9cblx0JC5nZXREYXRhZ3JpZENoZWNrZWRJZCA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBhcnJheXMgPSAkKFwiW2FiLWdyaWRdXCIpLmJvb3RzdHJhcFRhYmxlKCdnZXRTZWxlY3Rpb25zJyk7XG5cdFx0dmFyIGlkTmFtZSA9ICQoXCJbYWItZ3JpZF1cIikuYm9vdHN0cmFwVGFibGUoJ2dldE9wdGlvbnMnKS5pZEZpZWxkO1xuXHRcdHZhciBpZHMgPSBbXTtcblx0XHRhcnJheXMuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcblx0XHRcdGlkcy5wdXNoKGl0ZW1baWROYW1lXSk7XG5cdFx0fSlcblx0XHRcblx0XHRyZXR1cm4gaWRzO1xuXHR9XG5cblx0JC5nZXRVcmwgPSBmdW5jdGlvbih1cmwsIHBhcmFtKSB7XG5cdFx0aWYgKHVybC5pbmRleE9mKCdodHRwOi8vJykgPT0gMCB8fCB1cmwuaW5kZXhPZihfX2N0eCkgPT0gMCkgey8vIOW3suaYr+agh+WHhuivt+axguWcsOWdgOaIluW3suW4pumhueebruWJjee8gFxuXHRcdFx0cmV0dXJuIHVybDtcblx0XHR9XG5cblx0XHRyZXR1cm4gX19jdHggKyB1cmw7Ly8g5Yqg5LiK6aG555uu5YmN57yAXG5cdH1cblxuXHQvLyDlpITnkIbmn6Xor6Jcblx0JC5oYW5kbGVyU2VhcmNoID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyICRvYmogPSAkKFwiI3NlYXJjaEZvcm0gLmJ0bi5mYS1zZWFyY2hcIik7XG5cdFx0JG9iai51bmJpbmQoJ2NsaWNrJyk7XG5cdFx0JG9iai5jbGljayhmdW5jdGlvbigpIHtcblx0XHRcdCQuc2VhcmNoKHRoaXMpO1xuXHRcdH0pO1xuXHR9O1xuXHQvLyDph43nva7lpITnkIbmn6Xor6Jcblx0JC5oYW5kbGVyUmVTZXRTZWFyY2ggPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgJG9iaiA9ICQoXCIjc2VhcmNoRm9ybSAuYnRuLmZhLXJvdGF0ZS1sZWZ0XCIpO1xuXHRcdCRvYmoudW5iaW5kKCdjbGljaycpO1xuXHRcdCRvYmouY2xpY2soZnVuY3Rpb24oKSB7XG5cdFx0XHQkLmNsZWFyU2VhcmNoKHRoaXMpO1xuXHRcdH0pO1xuXHR9O1xuXG5cblx0Ly8g5Yig6Zmk6YCJ5Lit6KGMXG5cdCQuaGFuZGxlclJlbW92ZVNlbGVjdCA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciAkb2JqID0gJChcIi50b29sYmFyICBhLmJ0bi5mYS1yZW1vdmVcIik7XG5cdFx0JG9iai51bmJpbmQoJ2NsaWNrJyk7XG5cdFx0JG9iai5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCQodGhpcykuaGFzQ2xhc3MoJ2Rpc2FibGVkJykpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgaWRzID0gJC5nZXREYXRhZ3JpZENoZWNrZWRJZCgpOy8vIOWIoOmZpOeahElE5pWw57uEXG5cdFx0XHR2YXIgdXJsID0gJCh0aGlzKS5hdHRyKFwidXJsXCIpOy8vIOWIoOmZpOivt+axgueahFVSTFxuXHRcdFx0dmFyIGlkRmllbGQgPSAkKFwiW2FiLWdyaWRdXCIpLmJvb3RzdHJhcFRhYmxlKCdnZXRPcHRpb25zJykuaWRGaWVsZDsvLyDkuLvplK5rZXlcblx0XHRcdGlmIChpZHMgPT0gbnVsbCB8fCBpZHMubGVuZ3RoIDwgMSkge1xuXHRcdFx0XHQkLkRpYWxvZy5tc2coJ+ivt+mAieaLqeiusOW9lSEnKTtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHVybCA9PSBudWxsIHx8IHVybCA9PSAnJykge1xuXHRcdFx0XHQkLkRpYWxvZy5tc2coJ+acquaJvuWIsOmFjee9ruWPguaVsFthY3Rpb25dIScpO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR1cmwgPSAkLmdldFVybCh1cmwpO1xuXG5cdFx0XHR2YXIgcGFyYW0gPSB7fTtcblx0XHRcdHBhcmFtW2lkRmllbGRdID0gaWRzLmpvaW4oJywnKTtcblxuXHRcdFx0JC5EaWFsb2cuY29uZmlybShcIua4qemmqOaPkOekulwiLCBcIuaYr+WQpuimgeWIoOmZpOmAieS4reeahOmhuVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0JC5wb3N0KHVybCwgcGFyYW0sIGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdFx0XHR2YXIgcmVzdWx0TWVzc2FnZSA9IG5ldyBjb20uZHN0ei5mb3JtLlJlc3VsdE1lc3NhZ2UoZGF0YSk7XG5cdFx0XHRcdFx0aWYgKHJlc3VsdE1lc3NhZ2UuaXNTdWNjZXNzKCkpIHtcblx0XHRcdFx0XHRcdHRvYXN0ci5zdWNjZXNzKFwi5Yig6Zmk5oiQ5YqfXCIpO1xuXHRcdFx0XHRcdFx0JCgnW2FiLWdyaWRdJykuYm9vdHN0cmFwVGFibGUoJ3JlZnJlc2gnKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0JC5EaWFsb2cuYWxlcnQoXCLor7fmsYLlh7rplJnvvIzor7fogZTns7vnrqHnkIblkZjjgILplJnor6/lhoXlrrnvvJpcIiArIHJlc3VsdE1lc3NhZ2UuZ2V0TWVzc2FnZSgpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHR9KTtcblx0fTtcblxuXHQkLmhhbmRsZXJDb2xsYXBzZUV4cGFuZCA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciAkb2JqID0gJCgnW3RvZ2dsZS1jb2xsYXBzZV0nKTtcblx0XHQkb2JqLnVuYmluZCgnY2xpY2snKTtcblx0XHQvLyDmlLbnvKnjgIHlsZXlvIBcblx0XHQkb2JqLmJpbmQoXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBtZSA9ICQodGhpcyk7XG5cdFx0XHR2YXIgZWwgPSAkKG1lLmF0dHIoXCJ0b2dnbGUtY29sbGFwc2VcIikpO1xuXHRcdFx0aWYgKCFtZS5oYXNDbGFzcyhcImV4cGFuZFwiKSkge1xuXHRcdFx0XHRtZS5hdHRyKFwidGl0bGVcIiwgXCLlsZXlvIBcIik7XG5cdFx0XHRcdG1lLnJlbW92ZUNsYXNzKFwiY29sbGFwc2VcIikuYWRkQ2xhc3MoXCJleHBhbmRcIik7XG5cdFx0XHRcdG1lLnJlbW92ZUNsYXNzKFwiZmEtYW5nbGUtZG91YmxlLXVwXCIpLmFkZENsYXNzKFwiZmEtYW5nbGUtZG91YmxlLWRvd25cIik7XG5cdFx0XHRcdGVsLnNsaWRlVXAoMjAwKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1lLmF0dHIoXCJ0aXRsZVwiLCBcIuaUtue8qVwiKTtcblx0XHRcdFx0bWUucmVtb3ZlQ2xhc3MoXCJleHBhbmRcIikuYWRkQ2xhc3MoXCJjb2xsYXBzZVwiKTtcblx0XHRcdFx0bWUucmVtb3ZlQ2xhc3MoXCJmYS1hbmdsZS1kb3VibGUtZG93blwiKS5hZGRDbGFzcyhcImZhLWFuZ2xlLWRvdWJsZS11cFwiKTtcblx0XHRcdFx0ZWwuc2xpZGVEb3duKDIwMCk7XG5cdFx0XHR9XG5cdFx0XHQvLyDph43nva5cblx0XHRcdHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXNpemVHcmlkKCk7XG5cdFx0XHR9LCAzMDApO1xuXHRcdH0pO1xuXHRcdGlmKCRvYmouYXR0cihcImNsb3NlZFwiKSl7XG5cdFx0XHQkb2JqLmNsaWNrKCk7XG5cdFx0fVxuXHRcdFxuXHR9XG5cdCQuaW5pdEdyaWQgPSBmdW5jdGlvbigpe1xuXHRcdFxuXHRcdHZhciB1cmwgPSAkKFwiW2FiLWdyaWRdXCIpLmF0dHIoXCJkYXRhLXVybFwiKTtcblx0XHR1cmwgPSBnZXRDdHhVcmwodXJsLHRydWUpO1xuXG5cdFx0JChcIlthYi1ncmlkXVwiKS5ib290c3RyYXBUYWJsZSh7XG5cdFx0XHR1cmw6dXJsLFxuICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsICAgICAgICAgICAgICAgICAgICAgIC8v6K+35rGC5pa55byP77yIKu+8iVxuICAgICAgICAgICAgY29udGVudFR5cGU6J2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXG4gICAgICAgICAgICB0b29sYmFyOiAnLnRvb2xiYXInLCAgICAgICAgICAgICAgICAvL+W3peWFt+aMiemSrueUqOWTquS4quWuueWZqFxuICAgLy8gICAgICAgICBzdHJpcGVkOiBmYWxzZSwgICAgICAgICAgICAgICAgICAgICAgLy/mmK/lkKbmmL7npLrooYzpl7TpmpToibJcbiAgICAgICAgICAgIGNhY2hlOiBmYWxzZSwgICAgICAgICAgICAgICAgICAgICAgIC8v5piv5ZCm5L2/55So57yT5a2Y77yM6buY6K6k5Li6dHJ1Ze+8jOaJgOS7peS4gOiIrOaDheWGteS4i+mcgOimgeiuvue9ruS4gOS4i+i/meS4quWxnuaAp++8iCrvvIlcbiAgICAgICAgICAgIHBhZ2luYXRpb246IHRydWUsICAgICAgICAgICAgICAgICAgIC8v5piv5ZCm5pi+56S65YiG6aG177yIKu+8iVxuICAgICAgICAgICAgc29ydGFibGU6IHRydWUsICAgICAgICAgICAgICAgICAgICAgLy/mmK/lkKblkK/nlKjmjpLluo9cbiAgICAgICAgICAgIHNvcnRPcmRlcjogXCJhc2NcIixcdFx0XHRcdFx0Ly/mjpLluo/mlrnlvI9cbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zOiAkLmdldFF1ZXJ5UGFyYW0sXHRcdC8v5Lyg6YCS5Y+C5pWw77yIKu+8iVxuICAgICAgICAgICAgc2lkZVBhZ2luYXRpb246IFwic2VydmVyXCIsICAgICAgICAgICAvL+WIhumhteaWueW8j++8mmNsaWVudOWuouaIt+err+WIhumhte+8jHNlcnZlcuacjeWKoeerr+WIhumhte+8iCrvvIlcbiAgICAgICAgICAgIHBhZ2VOdW1iZXI6MSwgICAgICAgICAgICAgICAgICAgICAgIC8v5Yid5aeL5YyW5Yqg6L2956ys5LiA6aG177yM6buY6K6k56ys5LiA6aG1XG4gICAgICAgICAgICBwYWdlU2l6ZTogMTAsICAgICAgICAgICAgICAgICAgICAgICAvL+avj+mhteeahOiusOW9leihjOaVsO+8iCrvvIlcbiAgICAgICAgICAgIHBhZ2VMaXN0OiBbMTAsIDI1LCA1MCwgMTAwXSwgICAgICAgIC8v5Y+v5L6b6YCJ5oup55qE5q+P6aG155qE6KGM5pWw77yIKu+8iVxuICAgICAgICAgICAgc2VhcmNoOiBmYWxzZSwgICAgICAgICAgICAgICAgICAgICAgLy/mmK/lkKbmmL7npLrooajmoLzmkJzntKJcbiAgICAgICAgICAgIHN0cmljdFNlYXJjaDogZmFsc2UsXHRcdFx0XHQvL+WFqOWMuemFjeaQnOe0olxuICAgICAgICAgICAgc2hvd0NvbHVtbnM6IHRydWUsICAgICAgICAgICAgICAgICAgLy/mmK/lkKbmmL7npLrmiYDmnInnmoTliJdcbiAgICAgICAgICAgIHNob3dSZWZyZXNoOiB0cnVlLCAgICAgICAgICAgICAgICAgIC8v5piv5ZCm5pi+56S65Yi35paw5oyJ6ZKuXG4gICAgICAgICAgICBtaW5pbXVtQ291bnRDb2x1bW5zOiAyLCAgICAgICAgICAgICAvL+acgOWwkeWFgeiuuOeahOWIl+aVsFxuICAgICAgICAgICAgY2xpY2tUb1NlbGVjdDogdHJ1ZSwgICAgICAgICAgICAgICAgLy/mmK/lkKblkK/nlKjngrnlh7vpgInkuK3ooYxcbiAgICAgICAgLy8gIGhlaWdodDogNTAwLCAgICAgICAgICAgICAgICAgICAgICAgIC8v6KGM6auY77yM5aaC5p6c5rKh5pyJ6K6+572uaGVpZ2h05bGe5oCn77yM6KGo5qC86Ieq5Yqo5qC55o2u6K6w5b2V5p2h5pWw6KeJ5b6X6KGo5qC86auY5bqmXG4gICAgICAgICAgICB1bmlxdWVJZDogXCJpZFwiLCAgICAgICAgICAgICAgICAgICAgIC8v5q+P5LiA6KGM55qE5ZSv5LiA5qCH6K+G77yM5LiA6Iis5Li65Li76ZSu5YiXXG4gICAgICAgICAgICBzaG93VG9nZ2xlOmZhbHNlLCAgICAgICAgICAgICAgICAgICAvL+aYr+WQpuaYvuekuuivpue7huinhuWbvuWSjOWIl+ihqOinhuWbvueahOWIh+aNouaMiemSrlxuICAgICAgICAgICAgY2FyZFZpZXc6IGZhbHNlLCAgICAgICAgICAgICAgICAgICAgLy/mmK/lkKbmmL7npLror6bnu4bop4blm75cbiAgICAgICAgICAgIGRldGFpbFZpZXc6IGZhbHNlLCAgICAgICAgICAgICAgICAgIC8v5piv5ZCm5pi+56S654i25a2Q6KGoXG4gICAgICAgICAgICBzdHJpcGVkOnRydWUsXHRcdFx0XHRcdFx0Ly/pmpTooYzlj5joibLmlYjmnpxcbiAgICAgICAgICAgIGNsYXNzZXM6J3RhYmxlIHRhYmxlLWhvdmVyJyxcdFx0Ly/ooajmoLzmoLflvI9cbiAgICAgICAgICAgIHNlYXJjaEFsaWduOidyaWdodCcsXG4gICAgICAgICAgICBvbkxvYWRTdWNjZXNzOiBkYXRhQ2hlY2tcbiAgICAgICAgfSk7XG5cdFx0XG5cdH1cblx0Ly/ojrflj5blj4LmlbBcblx0JC5nZXRRdWVyeVBhcmFtID0gZnVuY3Rpb24ocGFyYW1zKXtcblx0XHQvL3BhcmFtcy5saW1pdCwgICAvL+mhtemdouWkp+Wwj1xuICAgICAgIC8vIHBhcmFtcy5vZmZzZXQsICAvL+mhteeggVxuXHRcdC8vYnVnIHNvcnRcblx0XHRcblx0XHRyZXR1cm4gcGFyYW1zO1xuXHR9XG5cbn0pKGpRdWVyeSk7XG5cbiQoZnVuY3Rpb24oKSB7XG5cdCQuaW5pdCgpO1xuXHRyb3dzTWFuYWdlci5zZW5kQWN0aW9uKCk7XG5cdHJlc2l6ZUdyaWQoKTtcblx0aW5pdFF0aXAoKTtcblx0aW5pdEJ1dHRvblBlcm1pc3Npb24oKTtcbn0pO1xuXG5mdW5jdGlvbiBkYXRhQ2hlY2soZGF0YSl7XG5cdGlmKGRhdGEuaXNPayA9PT0gZmFsc2UgJiYgZGF0YS5jb2RlID09PSBcIjQwMVwiKXtcblx0XHQgalF1ZXJ5LlRvYXN0LmVycm9yKFwi55m75b2V6LaF5pe277yM6K+36YeN5paw55m75b2VXCIpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGluaXRRdGlwKCl7XG5cdCQoXCJib2R5XCIpLmRlbGVnYXRlKFwiW3F0aXBdXCIsICdtb3VzZW92ZXInLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgcXRpcEFwaSA9ICQodGhpcykucXRpcChcImFwaVwiKTsgXG5cdFx0dmFyIG1zZyA9ICQodGhpcykuYXR0cihcInF0aXBcIik7XG5cdFx0aWYoIXF0aXBBcGkpe1xuXHRcdFx0dmFyIGRlZmF1bHRTZXR0aW5nID0ge1xuXHRcdFx0XHRcdHNob3c6IHsgc29sbzogdHJ1ZSB9LFxuXHRcdFx0XHRcdHN0eWxlOiB7Y2xhc3NlczogJ3F0aXAtZGVmYXVsdCAgcXRpcCBxdGlwLWJvb3RzdHJhcCBxdGlwLXNoYWRvdycgfSwvL3Bvc2l0aW9uOiB7IG15OiAnY2VudGVyIGxlZnQnLCBhdDogJ2NlbnRlciByaWdodCd9LFxuXHRcdFx0XHRcdHBvc2l0aW9uIDogeyBteTogJ2JvdHRvbSBjZW50ZXInLCBhdDogJ3RvcCBjZW50ZXInfSxcblx0XHRcdFx0XHRjb250ZW50IDogbXNnXG5cdFx0XHR9O1xuXHRcdFxuXHRcdFx0ICQodGhpcykucXRpcChkZWZhdWx0U2V0dGluZyk7XHRcblx0XHRcdCBxdGlwQXBpID0gJCh0aGlzKS5xdGlwKFwiYXBpXCIpOyBcblx0XHR9ZWxzZXtcblx0XHRcdGlmKHF0aXBBcGkuZGlzYWJsZWQpcXRpcEFwaS5lbmFibGUoKTtcblx0XHR9XG5cdFx0cXRpcEFwaS5zaG93KCk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBpbml0QnV0dG9uUGVybWlzc2lvbigpe1xuXHQkKFwiW2FiLWJ0bi1yaWdodHNdXCIpLmVhY2goZnVuY3Rpb24oKXtcblx0XHRoYW5kZWxQZXJtaXNzaW9uKHRoaXMpXG5cdH0pXG59XG5mdW5jdGlvbiBoYW5kZWxQZXJtaXNzaW9uKHRhcmdldCl7XG5cdHZhciBidG5SaWdodHNLZXkgPSAkKHRhcmdldCkuYXR0cihcImFiLWJ0bi1yaWdodHNcIik7XG5cdGlmKHdpbmRvdy5sb2NhbFN0b3JhZ2Upe1xuXHRcdHZhciBidG5QZXJtaXNzaW9uID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCAnYnV0dG9uUGVybWlzaW9uJyApO1xuXHRcdGJ0blBlcm1pc3Npb24gPSBidG5QZXJtaXNzaW9uID8gSlNPTi5wYXJzZSggYnRuUGVybWlzc2lvbiApIDoge307XG5cdFx0IFxuXHRcdGlmKCBidG5SaWdodHNLZXkgJiYgYnRuUGVybWlzc2lvbltidG5SaWdodHNLZXldKXtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0Y29uc29sZS5pbmZvKGJ0blJpZ2h0c0tleSArXCIgbm8gcmlnaHRzXCIpO1xuXHRcdCQodGFyZ2V0KS5oaWRlKCk7XG5cdH1lbHNle1xuXHRcdGNvbnNvbGUuaW5mbyhcIua1j+iniOWZqOeJiOacrOWkquS9juS4jeaUr+aMgeaMiemSruadg+mZkO+8gVwiKTtcblx0fVxufVxuXG5cbndpbmRvdy5yZWxvYWRHcmlkID0gZnVuY3Rpb24oKSB7XG5cdGlmICgkKCdbYWItZ3JpZF0nKS5sZW5ndGggPT0gMSkgJCgnW2FiLWdyaWRdJykuYm9vdHN0cmFwVGFibGUoJ3JlZnJlc2gnKTtcbn1cbmZ1bmN0aW9uIHJlc2l6ZUdyaWQoKXtcblx0dmFyIHBhZ2VTaXplID0gJC5nZXRQYWdlU2l6ZSgpO1xuXHRpZighcGFnZVNpemUuaGVpZ2h0KXsgcmV0dXJuOyAgfVxuXHRcblx0dmFyIHNlYXJjaEhlaXRoID0gJChcIi5zZWFyY2gtcGFuZWxcIikuaGVpZ2h0KCkrMTA7XG5cdCQoJ1thYi1ncmlkXScpLmJvb3RzdHJhcFRhYmxlKCdyZXNldFZpZXcnLHtoZWlnaHQ6cGFnZVNpemUuaGVpZ2h0LXNlYXJjaEhlaXRofSlcbn1cblxuXG5cbndpbmRvdy5sYWJlbEZtdCA9IGZ1bmN0aW9uKGFyciwgdmFsdWUpIHtcblx0Zm9yKHZhciBpPTAsaXRlbTtpdGVtPWFycltpKytdOyl7XG5cdFx0aWYoaXRlbS5rZXk9PXZhbHVlKXtcblx0XHRcdHJldHVybiAnPHNwYW4gY2xhc3M9XCJsYWJlbCBsYWJlbC0nK2l0ZW0uY3NzKydcIj4nK2l0ZW0udmFsKyc8L3NwYW4+J1xuXHRcdH1cblx0fVxuICByZXR1cm4gJyc7XG59XG5cblxuLy8g5omT5byA5LiA5Liq6L+e5o6lXG52YXIgcm93c01hbmFnZXIgPSB7fTtcblxucm93c01hbmFnZXIuZ2V0VXJsID0gZnVuY3Rpb24ob2JqKSB7XG5cdHZhciB1cmwgPSBvYmouYXR0cihcInVybFwiKTtcblx0aWYgKCF1cmwpXG5cdFx0cmV0dXJuIFwiXCI7XG5cblx0aWYgKHVybC5zdWJzdHIoMCwgMSkgPT0gXCIvXCIgJiYgdXJsLnN1YnN0cigwLCA3KSAhPSBcImh0dHA6Ly9cIikge1xuXHRcdHVybCA9IF9fY3R4ICsgdXJsO1xuXHR9XG5cdHJldHVybiB1cmw7XG59XG5cbi8vIOaJp+ihjOS4gOS4quWKqOS9nFxucm93c01hbmFnZXIuc2VuZEFjdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHQkKFwiYm9keVwiKS5kZWxlZ2F0ZShcIltzZW5kQWN0aW9uXVwiLCAnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgbWUgPSAkKHRoaXMpO1xuXHRcdHZhciB1cmwgPSByb3dzTWFuYWdlci5nZXRVcmwobWUpO1xuXHRcdGlmKCF1cmwpYWxlcnQoXCJ1cmzkuI3og73kuLrnqbrvvIFcIik7XG5cdFx0XG5cdFx0dmFyIHRleHQgPSBtZS5hdHRyKFwic2VuZEFjdGlvblwiKSB8fCBtZS50ZXh0KCk7XG5cdFx0JC5EaWFsb2cuY29uZmlybShcIuWvueivneahhlwiLCAn56Gu6K6kJyArIHRleHQgKyAn5ZCX77yfJywgZnVuY3Rpb24ocikge1xuXHRcdFx0aWYgKCFyKVxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHQkLnBvc3QodXJsLCBmdW5jdGlvbihyZXNwb25zZVRleHQpIHtcblx0XHRcdFx0dmFyIHJlc3VsdFx0PSBldmFsKCcoJyArIHJlc3BvbnNlVGV4dCArICcpJyk7XG5cdFx0XHRcdGlmIChyZXN1bHQuaXNPaykge1xuXHRcdFx0XHRcdCQuVG9hc3Quc3VjY2Vzcyh0ZXh0ICsgJ+aIkOWKn++8gScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0cmVsb2FkR3JpZCgpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdCQuVG9hc3QuZXJyb3IocmVzdWx0Lm1zZyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0fSk7XG5cblx0fSk7XG59O1xuXG5cbi8v5bi455So55qE5qC85byP5YyWXG53aW5kb3cuZGF0ZVRpbWVGb3JtYXR0ZXI9ZnVuY3Rpb24odmFsdWUsIHJvdywgaW5kZXgpIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PSBcIlwiKXtyZXR1cm4gXCJcIjt9XG4gICAgLy9JRSDkuI3mlK/mjIEgIG5ldyBkYXRlKOKAnDIwMTgtMTEtOeKAnSk7XG4gICAgaWYodmFsdWUuaW5kZXhPZihcIi1cIikhPS0xKXtcbiAgICBcdHZhbHVlID0gdmFsdWUucmVwbGFjZUFsbChcIi1cIiwnLycpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbmV3IERhdGUodmFsdWUpLmZvcm1hdChcInl5eXktTU0tZGQgSEg6bW06c3NcIik7XG59O1xuXG53aW5kb3cuZGF0ZUZvcm1hdHRlcj1mdW5jdGlvbih2YWx1ZSwgcm93LCBpbmRleCkge1xuXHRpZiAodmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PSBcIlwiKXtyZXR1cm4gXCJcIjt9XG4gICAgaWYodmFsdWUuaW5kZXhPZihcIi1cIikhPS0xKXtcbiAgICBcdHZhbHVlID0gdmFsdWUucmVwbGFjZUFsbChcIi1cIiwnLycpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IERhdGUodmFsdWUpLmZvcm1hdChcInl5eXktTU0tZGRcIik7XG59XG4vKipcbiAqIOWcqGFiLWdyaWQg55qEY29sb23phY3nva7kuK1cbiAqIEBlZzogZGF0YS1mb3JtYXR0ZXI9XCJsYWJlbEZvcm1hdHRlclwiIGRhdGEtdmFsLXRleHQ9XCJ7JzAnOifnpoHnlKgnLCcxJzon5ZCv55SoJ31cIiBkYXRhLXZhbC1zdHlsZT1cInsnMCc6J3ByaW1hcnknLCcxJzonaW5mbyd9XCJcbiAqIEB2YWxTdHlsZSA6IGRlZmF1bHQgcHJpbWFyeSBzdWNjZXNzIGluZm8gd2FybmluZyBkYW5nZXJcbiAqIEB2YWxUZXh0IGtleeWvueW6lOeahHRleHTlgLznmoTphY3nva5cbiAqIEBlZzog5YW25LuW5b2i5byPIGRhdGEtdmFsdWUtc3R5bGU9XCJrZXlfdmFsX3N0eWxlLGtleTJfdmFsMl9zdHlsZTIsXCJcbiAqL1xud2luZG93LmxhYmVsRm9ybWF0dGVyID0gZnVuY3Rpb24odmFsdWUsIHJvdywgaW5kZXgpe1xuXHRpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IFwiXCIpICByZXR1cm4gXCJcIjtcblx0dmFyIGxhYmxlU3R5bGUgPSAncHJpbWFyeSc7XG5cdFxuXHQvKirlpoLmnpzmmK9kYXRhLXZhbC10ZXh056ys5LiA56eN5b2i5byPKi9cblx0aWYodGhpcy52YWxUZXh0KXtcblx0XHR0cnl7XG5cdFx0XHR2YXIgdmFsVGV4dCA9IGV2YWwoXCIoXCIrdGhpcy52YWxUZXh0K1wiKVwiKTtcblx0XHRcdHZhciBsYWJlbFRleHQgPSB2YWxUZXh0W3ZhbHVlXTtcblx0XHRcdGlmKGxhYmVsVGV4dCA9PSB1bmRlZmluZWQpIGxhYmVsVGV4dCA9ICcnO1xuXHRcdFx0XG5cdFx0XHRpZih0aGlzLnZhbFN0eWxlKXtcblx0XHRcdFx0dmFyIHZhbFN0eWxlID0gZXZhbChcIihcIit0aGlzLnZhbFN0eWxlK1wiKVwiKTtcblx0XHRcdFx0aWYodmFsU3R5bGVbdmFsdWVdKXtcblx0XHRcdFx0XHRsYWJsZVN0eWxlID0gdmFsU3R5bGVbdmFsdWVdO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gJzxzcGFuIGNsYXNzPVwibGFiZWwgbGFiZWwtJytsYWJsZVN0eWxlKydcIj4nK2xhYmVsVGV4dCsnPC9zcGFuPic7XG5cdFx0fWNhdGNoKGUpe1xuXHRcdFx0Y29uc29sZS5lcnJvcihlK1wi5qC85byP5YyW5byC5bi477yBXCIrcm93KTtcblx0XHRcdGlmKGxhYmVsVGV4dCl7XG5cdFx0XHRcdHJldHVybiBsYWJlbFRleHQ7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdC8qKiDnrKzkuoznp43lrp7njrAgZGF0YS12YWx1ZS1zdHlsZT1cImtleS12YWwtc3R5bGUsa2V5Mi12YWwyLXN0eWxlMixcIiovXG5cdGlmKHRoaXMudmFsdWVTdHlsZSl7XG5cdFx0dmFyIHBhdHQgPSBuZXcgUmVnRXhwKFwiKD89XCIrdmFsdWUrXCItKS4qPyg/PSwpXCIsXCJnXCIpO1xuXHRcdHRyeXtcblx0XHR2YXIgcmVzdWx0ID0gcGF0dC5leGVjKHRoaXMudmFsdWVTdHlsZSk7XG5cdFx0aWYocmVzdWx0ICYmIHJlc3VsdFswXSl7XG5cdFx0XHR2YXIgdnMgPSByZXN1bHRbMF0uc3BsaXQoXCItXCIpO1xuXHRcdFx0aWYodnMubGVuZ3RoPT0zKXtcblx0XHRcdFx0bGFibGVTdHlsZSA9dnNbMl07XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gJzxzcGFuIGNsYXNzPVwibGFiZWwgbGFiZWwtJytsYWJsZVN0eWxlKydcIj4nK3ZzWzFdKyc8L3NwYW4+Jztcblx0XHR9XG5cdFx0fWNhdGNoKGUpe1xuXHRcdFx0Y29uc29sZS5lcnJvcihyb3cpO1xuXHRcdFx0Y29uc29sZS5lcnJvcihcImxhYmVsRm9ybWF0dGVy5qC85byP5YyW5byC5bi4OlwiK3ZhbHVlU3R5bGUsZSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRyZXR1cm4gdmFsdWU7XG5cdFxufVxuXG4vKipcbiAqIOWPr+S7peWvuWJvb3RzdHJhcFRhYmxlIOeahOWGheWuuei/m+ihjEhUTUzlvaLlvI/nmoTmoLzlvI/ljJbvvIzmraTml7bkvb/nlKhkYXRhLXRpdGxl5L2c5Li6dGl0bGXvvIxpbm5lckh0bWzliJnov5vooYzlj4LmlbDmoLzlvI/ljJY8YnI+XG4gKiBA5o+Q56S6IOS9v+eUqGlubmVySHRtbEZvcm1hdHRlciDlv4Xpobvmt7vliqAgZGF0YS10aXRsZeWxnuaAp1xuICogQHBhcmFtIHJvd1xuICogZWc6PHRoIGRhdGEtZmllbGQ9XCJ2YWx1ZVwiIGRhdGEtZm9ybWF0dGVyPVwiaW5uZXJIdG1sRm9ybWF0dGVyXCIgZGF0YS10aXRsZT1cIueuoeeQhlwiPlxuICogICBcdDxhIGNsYXNzPSdidG4gYnRuLW91dGxpbmUgYnRuLXByaW1hcnkgZmEgZmEtZWRpdCcgb3BlbkRpYWxvZz0n57yW6L6RJ3F0aXA9J+e8lui+kScgdXJsPScuL3N5c1Byb3BlcnRpZXNFZGl0Lmh0bWw/aWQ9e2lkfSc+PC9hPlxuICpcdFx0PGEgY2xhc3M9J2J0biBidG4tb3V0bGluZSBidG4tcHJpbWFyeSBmYSBmYS1kZXRhaWwnIG9wZW5EaWFsb2c9J+aYjue7hicgcXRpcD0n5piO57uGJyB1cmw9Jy4vc3lzUHJvcGVydGllc0dldC5odG1sP2lkPXtpZH0nPjwvYT5cbiAqXHRcdDxhIGNsYXNzPScgYnRuIGJ0bi1vdXRsaW5lIGJ0bi1wcmltYXJ5IGZhICBmYS10cmFzaCcgc2VuZEFjdGlvbj0n5Yig6ZmkJyBxdGlwPSfliKDpmaQnIHVybD0nL3N5cy9zeXNQcm9wZXJ0aWVzL3JlbW92ZT9pZD17aWR9Jz48L2E+XG4gKiAgICA8L3RoPlxuICog5qGI5L6L5Lit5Lya5a+5aW5uZXJIVE1M55qEe2lkfei/m+ihjOWPluWAvO+8jOaVsOaNrnNjb3Bl5Li6cm9377yMZWc6cm93LmlkIOWPr+S7peeUqHtpZH3lj5blgLxcbiAqL1xud2luZG93LmlubmVySHRtbEZvcm1hdHRlciA9IGZ1bmN0aW9uKHZhbHVlLCByb3csIGluZGV4KXtcblx0cm93Ll9fY3R4PV9fY3R4O1xuXHRpZihyb3cgJiYgdGhpcy5odG1sKXtcblx0XHR2YXIgaHRtbFN0ciA9IHRoaXMuaHRtbC5mb3JtYXQocm93KTtcblx0XHRcblx0XHR2YXIganFIdG1sID0gJChcIjxkaXY+XCIraHRtbFN0citcIjwvZGl2PlwiKTtcblx0XHR2YXIgaWZFbCA9ICQoXCJbaWZdXCIsanFIdG1sKTtcblx0XHR2YXIgYnRuUmlnaHRFbCA9ICQoXCJbYWItYnRuLXJpZ2h0c11cIixqcUh0bWwpO1xuXHRcdFxuXHRcdC8vIOadg+mZkOagh+etvlxuXHRcdGZvcih2YXIgal89MCxidG5fO2J0bl89YnRuUmlnaHRFbFtqXysrXTspe1xuXHRcdFx0aGFuZGVsUGVybWlzc2lvbihidG5fKTtcblx0XHR9XG5cdFx0Ly8gaWYg5qCH562+XG5cdFx0dHJ5e1xuXHRcdFx0Zm9yKHZhciBpXz0wLGl0ZW1fO2l0ZW1fPWlmRWxbaV8rK107KXtcblx0XHRcdFx0dmFyIGZuU3RyID0gJChpdGVtXykuYXR0cihcImlmXCIpO1xuXHRcdFx0XHRpZighZXZhbChmblN0cikpe1xuXHRcdFx0XHRcdCQoaXRlbV8pLnJlbW92ZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fWNhdGNoIChlKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKHJvdyk7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiaW5uZXJIdG1sRm9ybWF0dGVyIGlmIOagh+etvuino+aekOW8guW4uDpcIitmblN0cixlKTtcblx0XHR9XG5cdFx0XG5cdFx0cmV0dXJuIGpxSHRtbFswXS5pbm5lckhUTUw7XG5cdH1cblx0cmV0dXJuIFwiXCI7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2Fzc2V0cy9qcy9jb21tb24vZ3JpZC5qc1xuLy8gbW9kdWxlIGlkID0gNTBcbi8vIG1vZHVsZSBjaHVua3MgPSA0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///50\n')},51:function(module,exports){eval('/**\n * 调用系统树结构的工具 支持指令式： 1:<div sysTree treeKey="ywbfl" callBack="callback"></div>\n * function callback(event, treeId, treeNode){}\n * \n * 2 <div sysTreeGroup treeKey="ywbfl" ></div> 常用列表分组指令\n * 可选属性\n * nodeKey：树节点\n * groupColumn：分组的字段，默认group_id_\n */\nwindow.SysTree = {};\n$(function() {\n\t// 处理树展示\n\t$("[sysTree]").each(function(index, item) {\n\t\tvar id = $(item).attr("id");\n\t\tvar treeKey = $(item).attr("treeKey");\n\t\tvar nodeKey = $(item).attr("nodeKey");\n\t\tif (!id) {\n\t\t\tid = "tree_" + GetRandomStr(6);\n\t\t\t$(item).attr("id", id);\n\t\t}\n\t\tvar callbackStr = $(item).attr("callBack");\n\t\tvar callbackFun;\n\t\tif (callbackStr) {\n\t\t\tcallbackFun = eval(callbackStr);\n\t\t}\n\t\t$(item).attr("class", "ztree");\n\t\tSysTree.loadTree(id, treeKey, nodeKey, callbackFun);\n\t});\n\n\t$("[sysTreeGroup]").each(function(index, item) {\n\t\t$(item).attr("class", "ztree");\n\t\tvar id = $(item).attr("id");\n\t\tvar treeKey = $(item).attr("treeKey");\n\t\tvar nodeKey = $(item).attr("nodeKey");\n\t\tif (!id) {\n\t\t\tid = "tree_" + GetRandomStr(6);\n\t\t\t$(item).attr("id", id);\n\t\t}\n\t\tvar groupColumn = $(item).attr("groupColumn");\n\t\tif (!groupColumn) {\n\t\t\tgroupColumn = "group_id_";\n\t\t}\n\t\t\n\t\tvar callbackFun = function(event, treeId, treeNode) {\n\t\t\t$("[ab-grid]").bootstrapTable("refreshOptions", {\n\t\t\t\tqueryParams : function(params) {\n\t\t\t\t\tparams[groupColumn + "^VEQ"] = treeNode.id;\n\t\t\t\t\treturn params;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tSysTree.loadTree(id, treeKey, nodeKey, callbackFun);\n\t});\n});\n/**\n * eg: html:<div class="ztree" id="sysTree"></div>\n * js:SysTree.loadTree("sysTree","treeKey",null,function(event,\n * treeId,treeNode)); id:div的id treeKey:树key nodeKey:节点id 可为null callBack:回调函数\n */\nwindow.SysTree.loadTree = function(id, treeKey, nodeKey, callBack) {\n\t// 请求参数\n\tvar params = {\n\t\t// 树id\n\t\ttreeKey : treeKey\n\t};\n\tif (nodeKey) {\n\t\tparams.nodeKey = nodeKey;\n\t}\n\tvar url = __ctx + "/sys/sysTreeNode/getNodes";\n\tvar ztreeCreator = new ZtreeCreator(id, url);\n\tif (callBack) {\n\t\tztreeCreator.setCallback({\n\t\t\tonClick : callBack\n\t\t});\n\t}\n\n\tztreeCreator.initZtree(params);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanMvY29tbW9uL3Rvb2xzL3N5c1RyZWVVdGlsLmpzPzg5MTYiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7QUFDQSxFQUFFO0FBQ0YsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQSIsImZpbGUiOiI1MS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog6LCD55So57O757uf5qCR57uT5p6E55qE5bel5YW3IOaUr+aMgeaMh+S7pOW8j++8miAxOjxkaXYgc3lzVHJlZSB0cmVlS2V5PVwieXdiZmxcIiBjYWxsQmFjaz1cImNhbGxiYWNrXCI+PC9kaXY+XG4gKiBmdW5jdGlvbiBjYWxsYmFjayhldmVudCwgdHJlZUlkLCB0cmVlTm9kZSl7fVxuICogXG4gKiAyIDxkaXYgc3lzVHJlZUdyb3VwIHRyZWVLZXk9XCJ5d2JmbFwiID48L2Rpdj4g5bi455So5YiX6KGo5YiG57uE5oyH5LukXG4gKiDlj6/pgInlsZ7mgKdcbiAqIG5vZGVLZXnvvJrmoJHoioLngrlcbiAqIGdyb3VwQ29sdW1u77ya5YiG57uE55qE5a2X5q6177yM6buY6K6kZ3JvdXBfaWRfXG4gKi9cbndpbmRvdy5TeXNUcmVlID0ge307XG4kKGZ1bmN0aW9uKCkge1xuXHQvLyDlpITnkIbmoJHlsZXnpLpcblx0JChcIltzeXNUcmVlXVwiKS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBpdGVtKSB7XG5cdFx0dmFyIGlkID0gJChpdGVtKS5hdHRyKFwiaWRcIik7XG5cdFx0dmFyIHRyZWVLZXkgPSAkKGl0ZW0pLmF0dHIoXCJ0cmVlS2V5XCIpO1xuXHRcdHZhciBub2RlS2V5ID0gJChpdGVtKS5hdHRyKFwibm9kZUtleVwiKTtcblx0XHRpZiAoIWlkKSB7XG5cdFx0XHRpZCA9IFwidHJlZV9cIiArIEdldFJhbmRvbVN0cig2KTtcblx0XHRcdCQoaXRlbSkuYXR0cihcImlkXCIsIGlkKTtcblx0XHR9XG5cdFx0dmFyIGNhbGxiYWNrU3RyID0gJChpdGVtKS5hdHRyKFwiY2FsbEJhY2tcIik7XG5cdFx0dmFyIGNhbGxiYWNrRnVuO1xuXHRcdGlmIChjYWxsYmFja1N0cikge1xuXHRcdFx0Y2FsbGJhY2tGdW4gPSBldmFsKGNhbGxiYWNrU3RyKTtcblx0XHR9XG5cdFx0JChpdGVtKS5hdHRyKFwiY2xhc3NcIiwgXCJ6dHJlZVwiKTtcblx0XHRTeXNUcmVlLmxvYWRUcmVlKGlkLCB0cmVlS2V5LCBub2RlS2V5LCBjYWxsYmFja0Z1bik7XG5cdH0pO1xuXG5cdCQoXCJbc3lzVHJlZUdyb3VwXVwiKS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBpdGVtKSB7XG5cdFx0JChpdGVtKS5hdHRyKFwiY2xhc3NcIiwgXCJ6dHJlZVwiKTtcblx0XHR2YXIgaWQgPSAkKGl0ZW0pLmF0dHIoXCJpZFwiKTtcblx0XHR2YXIgdHJlZUtleSA9ICQoaXRlbSkuYXR0cihcInRyZWVLZXlcIik7XG5cdFx0dmFyIG5vZGVLZXkgPSAkKGl0ZW0pLmF0dHIoXCJub2RlS2V5XCIpO1xuXHRcdGlmICghaWQpIHtcblx0XHRcdGlkID0gXCJ0cmVlX1wiICsgR2V0UmFuZG9tU3RyKDYpO1xuXHRcdFx0JChpdGVtKS5hdHRyKFwiaWRcIiwgaWQpO1xuXHRcdH1cblx0XHR2YXIgZ3JvdXBDb2x1bW4gPSAkKGl0ZW0pLmF0dHIoXCJncm91cENvbHVtblwiKTtcblx0XHRpZiAoIWdyb3VwQ29sdW1uKSB7XG5cdFx0XHRncm91cENvbHVtbiA9IFwiZ3JvdXBfaWRfXCI7XG5cdFx0fVxuXHRcdFxuXHRcdHZhciBjYWxsYmFja0Z1biA9IGZ1bmN0aW9uKGV2ZW50LCB0cmVlSWQsIHRyZWVOb2RlKSB7XG5cdFx0XHQkKFwiW2FiLWdyaWRdXCIpLmJvb3RzdHJhcFRhYmxlKFwicmVmcmVzaE9wdGlvbnNcIiwge1xuXHRcdFx0XHRxdWVyeVBhcmFtcyA6IGZ1bmN0aW9uKHBhcmFtcykge1xuXHRcdFx0XHRcdHBhcmFtc1tncm91cENvbHVtbiArIFwiXlZFUVwiXSA9IHRyZWVOb2RlLmlkO1xuXHRcdFx0XHRcdHJldHVybiBwYXJhbXM7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdFN5c1RyZWUubG9hZFRyZWUoaWQsIHRyZWVLZXksIG5vZGVLZXksIGNhbGxiYWNrRnVuKTtcblx0fSk7XG59KTtcbi8qKlxuICogZWc6IGh0bWw6PGRpdiBjbGFzcz1cInp0cmVlXCIgaWQ9XCJzeXNUcmVlXCI+PC9kaXY+XG4gKiBqczpTeXNUcmVlLmxvYWRUcmVlKFwic3lzVHJlZVwiLFwidHJlZUtleVwiLG51bGwsZnVuY3Rpb24oZXZlbnQsXG4gKiB0cmVlSWQsdHJlZU5vZGUpKTsgaWQ6ZGl255qEaWQgdHJlZUtleTrmoJFrZXkgbm9kZUtleTroioLngrlpZCDlj6/kuLpudWxsIGNhbGxCYWNrOuWbnuiwg+WHveaVsFxuICovXG53aW5kb3cuU3lzVHJlZS5sb2FkVHJlZSA9IGZ1bmN0aW9uKGlkLCB0cmVlS2V5LCBub2RlS2V5LCBjYWxsQmFjaykge1xuXHQvLyDor7fmsYLlj4LmlbBcblx0dmFyIHBhcmFtcyA9IHtcblx0XHQvLyDmoJFpZFxuXHRcdHRyZWVLZXkgOiB0cmVlS2V5XG5cdH07XG5cdGlmIChub2RlS2V5KSB7XG5cdFx0cGFyYW1zLm5vZGVLZXkgPSBub2RlS2V5O1xuXHR9XG5cdHZhciB1cmwgPSBfX2N0eCArIFwiL3N5cy9zeXNUcmVlTm9kZS9nZXROb2Rlc1wiO1xuXHR2YXIgenRyZWVDcmVhdG9yID0gbmV3IFp0cmVlQ3JlYXRvcihpZCwgdXJsKTtcblx0aWYgKGNhbGxCYWNrKSB7XG5cdFx0enRyZWVDcmVhdG9yLnNldENhbGxiYWNrKHtcblx0XHRcdG9uQ2xpY2sgOiBjYWxsQmFja1xuXHRcdH0pO1xuXHR9XG5cblx0enRyZWVDcmVhdG9yLmluaXRadHJlZShwYXJhbXMpO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vYXNzZXRzL2pzL2NvbW1vbi90b29scy9zeXNUcmVlVXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gNTFcbi8vIG1vZHVsZSBjaHVua3MgPSA0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///51\n')}});